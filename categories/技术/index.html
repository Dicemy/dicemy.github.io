<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="robots" content="noindex"><meta><title>分类: 技术 - TobinMEng 的博客</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Dicemy"><meta name="msapplication-TileImage" content="/img/biaoti.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Dicemy"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="月光照着月光,月光普照"><meta property="og:type" content="blog"><meta property="og:title" content="TobinMEng 的博客"><meta property="og:url" content="https://dicemy.com/"><meta property="og:site_name" content="TobinMEng 的博客"><meta property="og:description" content="月光照着月光,月光普照"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://dicemy.com/img/og_image.png"><meta property="article:author" content="TobinMEng"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://dicemy.com"},"headline":"TobinMEng 的博客","image":["https://dicemy.com/img/og_image.png"],"author":{"@type":"Person","name":"TobinMEng"},"publisher":{"@type":"Organization","name":"TobinMEng 的博客","logo":{"@type":"ImageObject","url":"https://dicemy.com/img/biaoti.png"}},"description":"月光照着月光,月光普照"}</script><link rel="icon" href="/img/biaoti.png"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/font-awesome/5.15.2/css/all.min.css"><link rel="stylesheet" href="https://fonts.loli.net/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/css/justifiedGallery.min.css"><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdnjs.loli.net/ajax/libs/pace/1.2.4/pace.min.js"></script><!--!--><!--!--><script data-ad-client="ca-pub-6426911790858772" src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" async></script><!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.0.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body class="is-3-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/biaoti.png" alt="TobinMEng 的博客" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">首页</a><a class="navbar-item" href="/archives">文章归档</a><a class="navbar-item" href="/categories">分类</a><a class="navbar-item" href="/tags">标签</a><a class="navbar-item" href="/about">个人简介</a><a class="navbar-item" href="/message">留言</a><a class="navbar-item" href="/music">音乐</a><a class="navbar-item" href="/media">媒体</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Github" href="https://github.com/Dicemy"><i class="fab fa-github"></i></a><a class="navbar-item search" title="搜索" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-6-widescreen"><div class="card"><div class="card-content"><nav class="breadcrumb" aria-label="breadcrumbs"><ul><li><a href="/categories">分类</a></li><li class="is-active"><a href="#" aria-current="page">技术</a></li></ul></nav></div></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-08T10:08:35.000Z" title="2022/1/8 下午6:08:35">2022-01-08</time>发表</span><span class="level-item"><time dateTime="2022-01-28T12:57:57.039Z" title="2022/1/28 下午8:57:57">2022-01-28</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">1 小时读完 (大约7673个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/23955">fabric开发入门</a></h1><div class="content"><p>注意：不要在有生产环境的服务器上进行该学习的部署，血的教训（关闭服务的时候服务器上的docker都被杀掉了，青龙平台直接没了。。。）</p>
<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>在gopath中创建</p>
<blockquote>
<p>mkdir src</p>
<p>mkdir bin</p>
<p>mkdir pkg</p>
</blockquote>
<p>在src中创建<code>mkdir github.com</code></p>
<p>在github.com中创建<code>mkdir hyperledger</code></p>
<h2 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h2><p>一行命令，完成安装：（安装之后记得要把docker服务启动起来）</p>
<blockquote>
<p>curl -sSL <a target="_blank" rel="noopener" href="https://get.daocloud.io/docker">https://get.daocloud.io/docker</a> | sh</p>
<p>service docker start </p>
</blockquote>
<p>而且源在国内</p>
<h2 id="docker-compose安装"><a href="#docker-compose安装" class="headerlink" title="docker-compose安装"></a>docker-compose安装</h2><p>通过curl进行安装：</p>
<blockquote>
<p><code>curl -L https://github.com/docker/compose/releases/download/1.7.0/docker-compose-``uname -s ``-``uname -m`` &gt; /usr/local/bin/docker-compose</code></p>
<p><code>chmod +x /usr/local/bin/docker-compose</code></p>
<p><code>docker-compose -v</code></p>
</blockquote>
<h2 id="go安装与配置"><a href="#go安装与配置" class="headerlink" title="go安装与配置"></a>go安装与配置</h2><p>参考：<a href="http://dicemy.com/29920#Go%E8%AF%AD%E8%A8%80%E5%AE%89%E8%A3%85">http://dicemy.com/29920#Go%E8%AF%AD%E8%A8%80%E5%AE%89%E8%A3%85</a></p>
<p>一定要注意环境变量的配置</p>
<h2 id="jdk安装"><a href="#jdk安装" class="headerlink" title="jdk安装"></a>jdk安装</h2><blockquote>
<p>yum list java*</p>
<p>yum install -y java-1.8.0-openjdk-devel.x86_64    </p>
<p>java -version</p>
</blockquote>
<h2 id="下载fabric的docker镜像"><a href="#下载fabric的docker镜像" class="headerlink" title="下载fabric的docker镜像"></a>下载fabric的docker镜像</h2><p>除了baseos下载0.3.1，其余都下1.0.0，然后标记为latest</p>
<blockquote>
<p>tools：docker pull hyperledger/fabric-tools:x86_64-1.0.0</p>
<p>ccenv：docker pull hyperledger/fabric-ccenv:x86_64-1.0.0</p>
<p>ca：docker pull hyperledger/fabric-ca:x86_64-1.0.0</p>
<p>orderer：docker pull hyperledger/fabric-orderer:x86_64-1.0.0</p>
<p>peer：docker pull hyperledger/fabric-peer:x86_64-1.0.0</p>
<p>baseos：docker pull hyperledger/fabric-baseos:x86_64-0.3.1</p>
</blockquote>
<p>纯命令版：</p>
<blockquote>
<p>docker pull hyperledger/fabric-tools:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-ccenv:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-ca:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-orderer:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-peer:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-baseos:x86_64-0.3.1</p>
</blockquote>
<p>注意：记得在所有的安装之后进行tag 编辑成latest状态否则会出现问题</p>
<p><code>docker tag xxxx xxxx:latest</code></p>
<blockquote>
<p>docker tag hyperledger/fabric-tools:x86_64-1.0.0 hyperledger/fabric-tools:latest</p>
<p>docker tag hyperledger/fabric-ccenv:x86_64-1.0.0 hyperledger/fabric-ccenv:latest</p>
<p>docker tag hyperledger/fabric-ca:x86_64-1.0.0 hyperledger/fabric-ca:latest</p>
<p>docker tag hyperledger/fabric-orderer:x86_64-1.0.0 hyperledger/fabric-orderer:latest</p>
<p>docker tag hyperledger/fabric-peer:x86_64-1.0.0 hyperledger/fabric-peer:latest</p>
<p>docker tag hyperledger/fabric-baseos:x86_64-0.3.1 hyperledger/fabric-baseos:latest</p>
</blockquote>
<h2 id="下载fabric源码库"><a href="#下载fabric源码库" class="headerlink" title="下载fabric源码库"></a>下载fabric源码库</h2><p>在hyperledger目录下进行<code>git clone https://github.com/hyperledger/fabric.git</code></p>
<p><code>git checkout release-1.0</code></p>
<p><code>cd /home/gopath/src/github.com/hyperledger/fabric/common/configtx/tool/configtxgen</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108181212.png" alt="image-20220108181210078"></p>
<h3 id="对工具进行编译。"><a href="#对工具进行编译。" class="headerlink" title="对工具进行编译。"></a>对工具进行编译。</h3><p><code>go install --tags=nopkcs11</code></p>
<blockquote>
<p>注意！！！</p>
<p>奇怪的错误请输入：go env -w GO111MODULE=auto</p>
<p>一定要把这个项目文件的src放在go环境设置下的gopath的文件夹中，输入go env可以查看go安装环境中的gopath文件夹。否则会出现找不到包的报错。</p>
</blockquote>
<h3 id="对另一个工具进行编译。"><a href="#对另一个工具进行编译。" class="headerlink" title="对另一个工具进行编译。"></a>对另一个工具进行编译。</h3><p><code>cd /home/gopath/src/github.com/hyperledger/fabric/common/tools/cryptogen</code></p>
<p><code>go install --tags=nopkcs11</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108183050.png" alt="image-20220108183049804"></p>
<h3 id="编译好的工具如下"><a href="#编译好的工具如下" class="headerlink" title="编译好的工具如下:"></a>编译好的工具如下:</h3><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108183258.png" alt="image-20220108183258043"></p>
<h2 id="下载fabric-samples"><a href="#下载fabric-samples" class="headerlink" title="下载fabric-samples"></a>下载fabric-samples</h2><p><code>cd /home/gopath/src/github.com/hyperledger</code></p>
<p><code>git clone https://github.com/hyperledger/fabric-samples.git</code></p>
<p><code>git checkout release-1.0</code></p>
<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><h2 id="1-查看目录"><a href="#1-查看目录" class="headerlink" title="1.查看目录"></a>1.查看目录</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108185207.png" alt="image-20220108185207083"></p>
<p>.env：存储一些环境变量</p>
<p>base：储存docker-compose的一些公共服务</p>
<p>byfn.sh：执行脚本</p>
<p>configtx.yaml和crypto-config.yaml：根据之前生成的2个工具，生成相应的配置文件，用来启动网络，放到当前目录的channel-artifacts和crypto-config里面</p>
<p>docker-compose：用于启动网络</p>
<p>scripts：存放测试脚本，做的事：创建通道，加入通道，安装链码，实例化链码，链码交互</p>
<h2 id="2-生成配置"><a href="#2-生成配置" class="headerlink" title="2.生成配置"></a>2.生成配置</h2><p><code>./byfn.sh -m generate -i 1.0.0</code></p>
<blockquote>
<p>注意！！！！</p>
<p>一定要记得吧gopath中的bin目录添加到环境变量中，否则可能无法调用刚才编译好的configtxgen和cryptogen工具</p>
<p>可以通过 export PATH=$PATH:/home/gopath/bin 来临时添加或者使用vim ~/.bash_profile修改PATH 一行，之后使用source ~/.bash_profile生效。</p>
</blockquote>
<h2 id="3-启动网络，自动运行测试脚本"><a href="#3-启动网络，自动运行测试脚本" class="headerlink" title="3.启动网络，自动运行测试脚本"></a>3.启动网络，自动运行测试脚本</h2><p><code>./byfn.sh -m up -i 1.0.0</code></p>
<h2 id="4-关闭网络，自动清楚配置和docker进程"><a href="#4-关闭网络，自动清楚配置和docker进程" class="headerlink" title="4.关闭网络，自动清楚配置和docker进程"></a>4.关闭网络，自动清楚配置和docker进程</h2><p><code>./byfn.sh -m down -i 1.0.0</code></p>
<h1 id="Hello-World-分析"><a href="#Hello-World-分析" class="headerlink" title="Hello World 分析"></a>Hello World 分析</h1><h2 id="1-查看日志，order和peer分离"><a href="#1-查看日志，order和peer分离" class="headerlink" title="1.查看日志，order和peer分离"></a>1.查看日志，order和peer分离</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108200634.png" alt="image-20220108200633311"></p>
<p>peer是按照组织或主体分离的，每一个组织生成ca（存储证书和私钥），msp（存储管理员证书和中间证书），peers（存储每一个peer相关的证书），users（存储每一个用户的证书）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108200948.png" alt="image-20220108200946765"></p>
<h2 id="2-查看如下配置"><a href="#2-查看如下配置" class="headerlink" title="2.查看如下配置"></a>2.查看如下配置</h2><p>genesis.block：整个网络的创世区块</p>
<p>channel.tx：创建的通道的配置</p>
<p>Org1MSPanchors.tx和Org2MSPanchors.tx：两个主体的锚节点配置</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108201328.png" alt="image-20220108201327506"></p>
<h2 id="3-启动网络，接着分析日志"><a href="#3-启动网络，接着分析日志" class="headerlink" title="3.启动网络，接着分析日志"></a>3.启动网络，接着分析日志</h2><p>fabric网络启动完毕</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203247.png" alt="image-20220108203245854"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203353.png" alt="image-20220108203352910"></p>
<p>指定通道名称，和一些变量，通道创建完成</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203443.png" alt="image-20220108203442675"></p>
<p>4个peer加入通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203605.png" alt="image-20220108203604430"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203646.png" alt="image-20220108203646097"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203654.png" alt="image-20220108203653472"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203700.png" alt="image-20220108203659999"></p>
<p>组织中的锚节点在通道中update成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203742.png" alt="image-20220108203742026"></p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203742.png"/>

<p>链码安装到了peer节点</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203904.png" alt="image-20220108203903845"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203931.png" alt="image-20220108203930729"></p>
<p>链码实例化</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203952.png" alt="image-20220108203951359"></p>
<p>在peer0上进行查询操作，成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204015.png" alt="image-20220108204015033"></p>
<p>圈圈的是查询结果，查询成功，查询结果为100</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204137.png" alt="image-20220108204136547"></p>
<p>进行修改操作，成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204241.png" alt="image-20220108204241010"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204349.png" alt="image-20220108204348218"></p>
<p>再次查询，结果为90</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204508.png" alt="image-20220108204508197"></p>
<p>查看docker进程</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109165719.png" alt="image-20220108204613817"></p>
<p>3个链码会生成3个image</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204746.png" alt="image-20220108204745898"></p>
<p>查看脚本</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205435.png" alt="image-20220108205434573"></p>
<p>可以按脚本中的位置找到链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205512.png" alt="image-20220108205511945"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205325.png" alt="image-20220108205320115"></p>
<p>实现了Init和Invoke接口，就代表是一个fabric智能合约</p>
<p>Init：首先获取参数，不为4个则报错，最终将A和B存到数据库中</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210007.png" alt="image-20220108210006159"></p>
<p>Invoke：设置了3个方法，（invoke，delete，query）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210201.png" alt="image-20220108210200287"></p>
<p>invoke：接受3个参数，（谁给谁转账，赚多少）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210300.png" alt="image-20220108210259542"></p>
<p>A给B转账。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210352.png" alt="image-20220108210352036"></p>
<p>持久化数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210442.png" alt="image-20220108210441191"></p>
<p>接受1个值，从数据库中删除</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211352.png" alt="image-20220108211350759"></p>
<p>查询操作，结果以json形式返回</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211533.png" alt="image-20220108211532979"></p>
<p>main里只start或者进行一些验证，不写其他代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211617.png" alt="image-20220108211616503"></p>
<p>srcipts中：初始化操作，A有100元，B有200元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211813.png" alt="image-20220108211812427"></p>
<p>查询A有多少钱，所以打印了100</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211920.png" alt="image-20220108211919875"></p>
<p>A给B转账10元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108212005.png" alt="image-20220108212004943"></p>
<h1 id="fabric系统架构"><a href="#fabric系统架构" class="headerlink" title="fabric系统架构"></a>fabric系统架构</h1><h2 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109153233.png" alt="image-20220109153232452"></p>
<ul>
<li><p><strong>应用层</strong></p>
</li>
<li><p>API：提供了GRPC，（谷歌）RPC框架</p>
</li>
<li><p>SDK：在API基础上封装的SDK，go，java，python，nodejs</p>
</li>
<li><p>事件：分布式系统中，达成共识需要一定的时间，fabric使用异步通信模式开发，触发回调函数执行。</p>
</li>
<li><p>身份：依托于底层的成员服务，是联盟链的认证功能，例如CA</p>
</li>
<li><p>账本：区块链的查询数据，是账本中查出来的，区块高度+交易ID，不重复</p>
</li>
<li><p>交易：对区块链数据进行修改，先提交交易到背书节点，签名认证之后再执行。</p>
</li>
<li><p>智能合约：做合约的安装，实例化和升级</p>
</li>
<li><p><strong>区块链底层</strong></p>
</li>
<li><p>成员服务：提供证书，用于加密和签名</p>
</li>
<li><p>共识服务：CAP（不能全满足，只能满足2个，一致性，可用性和分区容忍性），实际上区块链是弱化了可用性和分区容忍性，所以需要共识算法保证一致性。fabric的共识大概分为三个阶段：</p>
<ul>
<li>首先客户端向背书节点发送一个背书提案，背书节点进行交易模拟，将背书节点和签名返回客户端。</li>
<li>然后将背书后的交易，交给排序节点进行排序。有排序节点生成区块，向全网广播。网络节点接受到广播后，先验证区块交易的正确性。</li>
<li>验证通过后，存入本地账本。</li>
<li>PS：排序节点与组织的锚节点使用的是GRPC通信，组织内使用的是gossip协议通信</li>
</ul>
</li>
<li><p>链码服务：提供安全的，可隔离的交易环境。所以fabric使用docker，链码直接与docker通信。目前阶段对k8s支持的不好，会出问题。</p>
</li>
<li><p>安全及密码服务：fabric定义了一个BCCSP接口，定义签名，加密解密功能，是默认实现了一套国际通用的密码服务，如sha256等</p>
</li>
</ul>
<h2 id="网络拓扑图"><a href="#网络拓扑图" class="headerlink" title="网络拓扑图"></a>网络拓扑图</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109160034.png" alt="image-20220109160033781"></p>
<ul>
<li><strong>概念：</strong></li>
<li>客户端节点：应用程序和底层的交互媒介，与上层和peer和orderer连接发挥作用，连接peer做交易模拟</li>
<li>peer节点：包含了<strong>锚节点（主节点）</strong>，在一个组织内可以有多个peer，一个组织中锚节点只有一个，锚节点的作用（与orderer进行通信），锚节点需要HA支持，若锚节点挂了，组织内会选举新的节点与orderer节点进行通信，<strong>背书节点（Endorse）</strong>理解为担保，与智能合约绑定的，每一个智能合约安装到区块链中，会有一个专属的背书策略，<strong>记账节点（committer）</strong>所有的peer节点都是记账节点。用于验证从orderer接受的区块，验证交易的有效性，验证通过后，同步到本地账本。</li>
<li>orderer节点：排序节点，接受全网客户端节点的交易信息，按照一定规则进行排序，将排序好的交易，按照固定的时间间隔打包成区块。与其他组织的主节点进行通信，排序可以用solo（整个网络中只有一个排序节点，使用于开发和测试）和kafka（生产环境下使用，分布式消息队列）模式</li>
<li>CA节点：可选的，作用：颁发证书，只用被CA认证的节点才能进行交易，fabric不存在51%攻击问题。</li>
<li><strong>动作和行为：</strong></li>
<li>注册登记：与客户端发起，向CA机构表明自己的身份，获取证书，上图中是第三方的CA，也可以使用官方提供的CA。</li>
<li>交易提案：向组织的<strong>背书节点</strong>提交请求，对应peer节点，组织可以理解为现实中的商业主体，组织是独立的，有两个个数据来源。</li>
<li>提交交易：客户端节点向排序节点发请求，orderer内部进行排序打包成区块，广播给其他组织的锚节点，上图是基于kafka实现的，每个组织会选择一个orderer节点进行通信。</li>
</ul>
<h2 id="交易流程"><a href="#交易流程" class="headerlink" title="交易流程"></a>交易流程</h2><ul>
<li>客户端提交交易，最终到记账节点同步数据。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109163002.png" alt="image-20220109163001787"></p>
<ul>
<li>智能合约按照要指定背书节点，正常情况下，背书节点返回相同的结果，但签名是不一样的。</li>
<li>背书是模拟的过程，不会持久化</li>
<li>1,2,3是交易模拟，4,5,6是交易排序，7,8,9是交易同步和记账。交易模拟对应智能合约，交易排序对应共识机制，同步和记账对应账本存储</li>
</ul>
<h1 id="fabric共识排序"><a href="#fabric共识排序" class="headerlink" title="fabric共识排序"></a>fabric共识排序</h1><h2 id="共识机制"><a href="#共识机制" class="headerlink" title="共识机制"></a>共识机制</h2><ul>
<li>达成公式需要3个阶段，交易背书，交易排序，交易验证。</li>
<li>交易背书：模拟的</li>
<li>交易排序：确定交易顺序，最终将排序好的交易打包区块分发。</li>
<li>交易验证：区块储存前要进行一下交易验证（不是所有的orderer的东西都能存进去）</li>
</ul>
<h2 id="Orderer节点的作用"><a href="#Orderer节点的作用" class="headerlink" title="Orderer节点的作用"></a>Orderer节点的作用</h2><ul>
<li><p>交易排序</p>
<ul>
<li>目的：保证系统的最终一致性（有限状态机）</li>
<li>solo：单节点排序</li>
<li>kafka：外置的分布式消息队列</li>
</ul>
</li>
<li><p>区块分发：</p>
<ul>
<li>orderer中的区块并不是最终持久化的区块，</li>
<li>是一个中间状态的区块</li>
<li>包含了所有交易，不管是有有效还是无效，都会打包传给组织的锚节点。</li>
</ul>
</li>
<li><p>多通道的数据隔离</p>
<ul>
<li>客户端可以使用某个通道，发送交易</li>
<li><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109164753.png" alt="image-20220109164752553"></li>
</ul>
</li>
</ul>
<h2 id="源码目录"><a href="#源码目录" class="headerlink" title="源码目录"></a>源码目录</h2><ul>
<li><p>从goland中阅读</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110134631.png" alt="image-20220110134628351"></p>
</li>
<li><p>源码目录</p>
<ul>
<li>bccsp：与密码学相关的，加密，数字签名，证书，将密码学中的函数抽象成了接口，方便调用和扩展</li>
<li>bddtests：行为驱动开发，从需求直接到开发</li>
<li>common：公共库，错误处理，日志处理，账本存贮，相关工具</li>
<li>core：是fabric核心库，子目录是各个模块的目录<ul>
<li>comm：网络通信相关</li>
</ul>
</li>
<li>devenv：官方提供的开发环境，使用的是Vagrant</li>
<li>docs：文档</li>
<li>events：事件监听机制</li>
<li>gossip：通信协议，组织内部的通信，区块同步</li>
<li>gotools：用于编译</li>
<li>images：docker镜像相关的</li>
<li>msp：成员服务管理，member serivce provider 读取证书做签名</li>
<li>orderer：排序节点</li>
<li>peer：peer节点</li>
<li>proposals：用于扩展，新功能的提案</li>
<li>protos：数据结构的定义</li>
</ul>
</li>
<li><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110135049.png" alt="image-20220110135013312"></p>
</li>
</ul>
<h2 id="共识机制源码"><a href="#共识机制源码" class="headerlink" title="共识机制源码"></a>共识机制源码</h2><blockquote>
<p>如果使用goland查看源码时import全部标红的话，进入这个设置，将第一个Enable Go … 这个框勾掉即可。<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110140311.png" alt="image-20220110140310255"></p>
</blockquote>
<ul>
<li><p>orderer节点的源码</p>
</li>
<li><p>首先看orderer目录下的main.go</p>
</li>
<li><p>main.go里有一个NewServer</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110145806.png" alt="image-20220110145805341"></p>
</li>
<li><p>从sever.go可以具体查看交易收集和广播区块</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110145855.png" alt="image-20220110145853957"></p>
</li>
<li><p>点击Manager，进入Manager.go查看源码（还在sever.go里）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110150014.png" alt="image-20220110150005861"></p>
</li>
<li><p>点击chainsupport，查看（在manager.go中）<br><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110153610.png" alt="image-20220110153609457"></p>
</li>
<li><p>点receiver进去，看区块切割（在chainsupport.go中）<br><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110155258.png" alt="image-20220110155256319"></p>
</li>
</ul>
<h2 id="回顾共识机制源码"><a href="#回顾共识机制源码" class="headerlink" title="回顾共识机制源码"></a>回顾共识机制源码</h2><ul>
<li>main.go是入口，orderer节点的初始化</li>
<li>manager.go是控制中枢，是对链的操作，拿到chainsupport对象</li>
<li>chainsupport.go链对象额代理，与链式对应的关系</li>
<li>Cut（）方法是区块切割</li>
<li>solo和kafka相关的设置</li>
<li>sever.go有两个Handle，是交易收集和区块扩散的方法</li>
<li>将共识简化为了排序，最终一致性</li>
</ul>
<h1 id="fabric账本存储"><a href="#fabric账本存储" class="headerlink" title="fabric账本存储"></a>fabric账本存储</h1><h2 id="账本存储概念"><a href="#账本存储概念" class="headerlink" title="账本存储概念"></a>账本存储概念</h2><ul>
<li><p>peer节点做账本存储</p>
</li>
<li><p>orderer是临时存储区块，peer节点时账本存储的持久化，会改变世界状态。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110163404.png" alt="image-20220110163210283"></p>
</li>
<li><p>文件系统，区块是存储为文件</p>
</li>
<li><p>区块索引，用于查询区块，是用levelDB实现的</p>
</li>
<li><p>状态数据库，一般村存放区块链最新状态，数据不需要HA，可以从文件系统再次获取，couchDB支持模糊查询</p>
</li>
</ul>
<h2 id="交易读写集"><a href="#交易读写集" class="headerlink" title="交易读写集"></a>交易读写集</h2><ul>
<li><p>回忆交易流程</p>
<ul>
<li>交易模拟<ul>
<li>在背书节点执行模拟时，最终返回交易读写集（RWset），告诉区块链在交易中读写了哪些数据</li>
</ul>
</li>
<li>交易排序</li>
<li>交易验证，交易验证后，更新世界状态，更新的就是读写集中的写集</li>
</ul>
</li>
<li><p>交易读写集的3个概念</p>
<ul>
<li>读集：包含键的列表，键的提交版本，读取赌赢的值，返回的是已提交的状态的值（读已提交），不能读取交易过程中写入的数据。</li>
<li>写集：包含键的列表，写入的数据的值，如果多次写入，以最后一次为准。</li>
<li>版本号：用区块高度和交易编号组成的。</li>
</ul>
</li>
<li><p>交易验证阶段是对读写集进行验证（验证读集）</p>
<ul>
<li>验证读集的版本号是和否等于世界状态的版本号</li>
</ul>
</li>
</ul>
<h2 id="账本存储相关概念"><a href="#账本存储相关概念" class="headerlink" title="账本存储相关概念"></a>账本存储相关概念</h2><ul>
<li><p>世界状态</p>
<ul>
<li>交易执行后，所有键的最新值</li>
</ul>
</li>
<li><p>历史数据索引（可选）</p>
</li>
<li><p>区块储存</p>
<ul>
<li>按照文件去存 blockfile_xxxx</li>
<li>文件大小是64M，若修改，需要重新编译peer源码</li>
<li>账本最大容量64M*</li>
</ul>
</li>
<li><p>区块读取</p>
<ul>
<li>区块文件流</li>
<li>区块流</li>
<li>迭代器</li>
</ul>
</li>
<li><p>区块索引</p>
<ul>
<li>键：区块高度，区块哈希，交易哈希</li>
<li>值：区块文件编号，文件内的偏移量，区块数据的长度</li>
</ul>
</li>
<li><p>区块提交</p>
</li>
<li><p>保存到文件</p>
</li>
</ul>
<h2 id="账本存储相关源码"><a href="#账本存储相关源码" class="headerlink" title="账本存储相关源码"></a>账本存储相关源码</h2><ul>
<li>从4方面看，读写集，状态数据， 历史数据，区块文件</li>
<li>可以先从core/ledger 下的 ledger_interface.go 中看大体结构</li>
<li><strong>读写集</strong>，分为交易读写集的生成和交易读写集的验证两个部分去看。<ul>
<li>交易读写集生成<ul>
<li>fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/lockbased_tx_simulator.go</li>
</ul>
</li>
<li>交易读写集验证<ul>
<li>fabric/core/ledger/kvledger/txmgmt/validator/statebasedval/state_based_validator.go</li>
</ul>
</li>
</ul>
</li>
<li><strong>状态数据库</strong>：看levelDB的实现<ul>
<li>fabric/core/ledger/kvledger/txmgmt/statedb/stateleveldb/stateleveldb.go</li>
</ul>
</li>
<li><strong>历史数据库</strong>：看levelDB的实现<ul>
<li>fabric/core/ledger/kvledger/history/historydb/historyleveldb/historyleveldb.go</li>
</ul>
</li>
<li><strong>区块文件读取</strong><ul>
<li>fabric/common/ledger/blkstorage/fsblkstorage/fs_blockstore.go</li>
<li>区块流：fabric/common/ledger/blkstorage/fsblkstorage/block_stream.go</li>
</ul>
</li>
</ul>
<h2 id="账本存储相关源码总结"><a href="#账本存储相关源码总结" class="headerlink" title="账本存储相关源码总结"></a>账本存储相关源码总结</h2><ul>
<li>首先看了账本根存储的根目录的接口，从宏观上把握</li>
<li>交易读写集的生成和验证</li>
<li>数据库增删改查</li>
<li>要有一个没有实现的方法，数据剪裁的接口，可能去解决数据无限增长的处理</li>
</ul>
<h1 id="fabric智能合约"><a href="#fabric智能合约" class="headerlink" title="fabric智能合约"></a>fabric智能合约</h1><h2 id="智能合约"><a href="#智能合约" class="headerlink" title="智能合约"></a>智能合约</h2><p>fabric_asset配置好的文件下载：<a target="_blank" href="/doc/fabric_asset.zip">点击下载fabric_asset.zip</a></p>
<ul>
<li><p>执行环境：以太坊虚拟智能合约执行环境EVM，fabric执行环境是docker</p>
</li>
<li><p>链码</p>
<ul>
<li>是应用层和区块链底层的中间点</li>
<li>每一个链码执行环境是一个独立的docker</li>
<li>使用GRPC协议与背书节点通讯，只有背书节点才能运行智能合约</li>
</ul>
</li>
<li><p>链码的生命周期</p>
<ul>
<li>打包，智能合约的编写和编译</li>
<li>安装，将打包好的文件，上传到背书节点</li>
<li>实例化，实际的安装了，执行Init方法，只执行一次，构造函数</li>
<li>升级，升级和修复链码</li>
<li>交互，自己定义的方法的调用</li>
</ul>
</li>
<li><p>链码的交互流程</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220111130908.png" alt="image-20220111130907628"></p>
</li>
<li><p>系统链码（了解）</p>
<ul>
<li>LSCC：管理链码的生命周期</li>
<li>CSCC：配置管理链码，管理链的配置</li>
<li>QSCC：查询账本存储，是一个区块索引的外部服务</li>
<li>ESCC：交易背书的链码，交易执行后的链码进行封装签名，给客户端返回背书交易结果。</li>
<li>VSCC：交易验证的链码</li>
</ul>
</li>
<li><p>链码编程的接口</p>
<ul>
<li>Init()：链码初始化，只执行一次</li>
<li>Invoke()：链码的业务逻辑的编写</li>
<li>上面2个方法参数一样，参数是SDK的接口</li>
</ul>
</li>
<li><p>链码SDK的接口</p>
<ul>
<li>写代码再看</li>
</ul>
</li>
<li><p>一些注意点</p>
<ul>
<li>分布式多机多节点执行，链码会执行很多次</li>
<li>不写随机函数，交易会无效，多次执行不一样</li>
<li>系统时间不写，多机时间不一定一样</li>
</ul>
</li>
</ul>
<h2 id="网络搭建配置的实现"><a href="#网络搭建配置的实现" class="headerlink" title="网络搭建配置的实现"></a>网络搭建配置的实现</h2><ul>
<li><p><strong>crypto-config.yaml</strong>：用于配置组织节点的个数，参考firstnetwork去编写</p>
</li>
<li><p>编写好后，传到linux对应目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220111220422.png" alt="image-20220111220421700"></p>
</li>
<li><p>进入deploy目录，设置工作目录为当前目录</p>
<p><code>export FABRIC_CFG_PATH=$GOPATH/src/fabric_asset/deploy</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112316260.png" alt="image-20220111231610245"></p>
</li>
<li><p>指定按照yaml文件生成配置</p>
<p><code>cryptogen generate --config=./crypto-config.yaml</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112318839.png" alt="image-20220111231835718"></p>
</li>
<li><p><strong>configtx.yaml</strong>：用于区块联盟中的组织信息，配合名字和证书等的位置，参考firstnetwork去编写</p>
</li>
<li><p>编写好后，传到linux对应目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112323346.png" alt="image-20220111220421700"></p>
</li>
<li><p>创建用于存放配置的目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201121625352.png" alt="image-20220112162508038"></p>
</li>
<li><p><strong>生成系统链的创世区块</strong></p>
</li>
<li><p>-profile 指定联盟配置，-outputBlock 指定存放的位置</p>
<p><code>configtxgen -profile OneOrgsOrdererGenesis -outputBlock ./config/genesis.block</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201121628296.png" alt="image-20220112162808968"></p>
</li>
<li><p><strong>生成通道的创世交易</strong></p>
</li>
<li><p>profile 指定业务联盟，outputCreateChannelTx存放的路径，插件的名字叫做mychannel</p>
<p><code>configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./config/mychannel.tx -channelID mychannel</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131517067.png" alt="image-20220113151701675"></p>
<blockquote>
<p>注意：如果使用虚拟机为平台的话，会出现用ssh连接执行命令执行出错的情况发生，具体原因不详，但是在虚拟机上可以正常执行并生成成功。</p>
</blockquote>
</li>
<li><p><strong>生成两个组织锚节点的交易信息</strong></p>
<p><code>configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./config/Org0MSPanchors.tx -channelID mychannel -asOrg Org0MSP</code></p>
<p><code>configtxgen -profile TwoOrgsChannel -outputAnchorPeersUpdate ./config/Org1MSPanchors.tx -channelID mychannel -asOrg Org1MSP</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131532043.png" alt="image-20220113153247804"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131534780.png" alt="image-20220113153436463"></p>
</li>
<li><p>将docker-compose.yaml拖进deploy目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211329882.png" alt="image-20220114165038705"></p>
</li>
</ul>
<h2 id="启动网络"><a href="#启动网络" class="headerlink" title="启动网络"></a>启动网络</h2><ul>
<li><p><strong>启动docker，后台运行</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201141811282.png" alt="image-20220114181144436"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211036361.png" alt="image-20220121103619727"></p>
</li>
<li><p>查看orderer节点的运行日志</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211036157.png" alt="image-20220121103654831"></p>
</li>
<li><p>与客户端交互操作</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211043457.png" alt="image-20220121104301852"></p>
</li>
<li><p><strong>创建通道</strong></p>
</li>
<li><p>-o 指定与哪个orderer节点进行通信，-c指定创建的通道名称，-f指定使用的文件</p>
<blockquote>
<p>出现的错误一般情况下是docker-compose中书写有误，e.g.映射路径中etc目录写成了ect</p>
</blockquote>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211206681.png" alt="image-20220121120625533"></p>
</li>
<li><p><strong>加入通道</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211210517.png" alt="image-20220121121002769"></p>
</li>
<li><p>查看peer加入的通道列表：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211211163.png" alt="image-20220121121110870"></p>
</li>
<li><p><strong>指定主节点</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211213553.png" alt="image-20220121121336157"></p>
</li>
<li><p><strong>基础网络完成了</strong></p>
</li>
</ul>
<hr>
<ul>
<li><p><strong>安装链码</strong></p>
</li>
<li><p>-n是安装的名字，-v是version，-l是使用的语言</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211220565.png" alt="image-20220121122000349"></p>
</li>
<li><p><strong>克隆一个会话</strong>，交互执行peer0，查看安装的链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211223314.png" alt="image-20220121122348993"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211225618.png" alt="image-20220121122517281"></p>
</li>
<li><p><strong>链码实例化</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211231478.png" alt="image-20220121123124872"></p>
</li>
<li><p>链码交互执行</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211242449.png" alt="image-20220121124213503"></p>
</li>
<li><p>多次执行查询，得到的结果不同，因为invoke（）中使用了随机数，不要这么做。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211245508.png" alt="image-20220121124536471"></p>
</li>
</ul>
<h1 id="fabric链码案例"><a href="#fabric链码案例" class="headerlink" title="fabric链码案例"></a>fabric链码案例</h1><h2 id="链码入门"><a href="#链码入门" class="headerlink" title="链码入门"></a>链码入门</h2><ul>
<li><p>编写hello.go，完成后，拖到linux对应目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211306765.png" alt="image-20220121130639382"></p>
</li>
<li><p><strong>安装链码</strong></p>
</li>
<li><p>-n是安装的名字，-v是version，-l是使用的语言</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211309023.png" alt="image-20220121130951831"></p>
</li>
<li><p>实例化链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211314692.png" alt="image-20220121131431500"></p>
</li>
<li><p>链码调用</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211316775.png" alt="image-20220121131610535"></p>
</li>
</ul>
<h2 id="账户相关链码"><a href="#账户相关链码" class="headerlink" title="账户相关链码"></a>账户相关链码</h2><ul>
<li><p>Init（）方法与例子程序类似</p>
</li>
<li><p>Invoke（）方法包含query，invoke，set，get，</p>
</li>
<li><p>编写完成后拖到linux对应目录</p>
</li>
<li><p>启动容器</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211742920.png" alt="image-20220121174057468"></p>
</li>
<li><p>交互执行</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211742920.png"/>
</li>
<li><p>创建通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211744978.png" alt="image-20220121174426685"></p>
</li>
<li><p>加入通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211745648.png" alt="image-20220121174527349"></p>
</li>
<li><p>设置主节点</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211747968.png" alt="image-20220121174721400"></p>
</li>
<li><p>安装链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211749638.png" alt="image-20220121174953989"></p>
</li>
<li><p>实例化链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211753092.png" alt="image-20220121175309884"></p>
</li>
<li><p>查询user1的余额</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211756382.png" alt="image-20220121175634359"></p>
</li>
<li><p>user1给user2转200元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211758539.png" alt="image-20220121175842114"></p>
</li>
<li><p>向user1存100元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211800126.png" alt="image-20220121180038895"></p>
</li>
<li><p>向user1取200元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201211801284.png" alt="image-20220121180152224"></p>
</li>
</ul>
<h2 id="贷款还款相关链码"><a href="#贷款还款相关链码" class="headerlink" title="贷款还款相关链码"></a>贷款还款相关链码</h2><ul>
<li><p>编写Trace下的代码，编写好后，拖到对应linux目录</p>
</li>
<li><p>保证网络基础OK的情况下，安装链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221455452.png" alt="image-20220122145534672"></p>
</li>
<li><p>实例化链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221458929.png" alt="image-20220122145831365"></p>
</li>
<li><p>运行测试</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221500977.png" alt="image-20220122150047323"></p>
</li>
<li><p>贷款500W</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221503934.png" alt="image-20220122150341567"></p>
</li>
<li><p>还款500</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221505292.png" alt="image-20220122150527823"></p>
</li>
</ul>
<h2 id="公民身份信息相关链码"><a href="#公民身份信息相关链码" class="headerlink" title="公民身份信息相关链码"></a>公民身份信息相关链码</h2><ul>
<li><p>编写citizens下的代码，编写好后，拖到对应linux目录</p>
</li>
<li><p>安装链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221913015.png" alt="image-20220122191304566"></p>
</li>
<li><p>链码实例化</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221931645.png" alt="image-20220122193129390"></p>
</li>
<li><p>身份查询</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221932544.png" alt="image-20220122193243135"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201221933442.png" alt="image-20220122193311699"></p>
</li>
</ul>
<h2 id="合约相关链码"><a href="#合约相关链码" class="headerlink" title="合约相关链码"></a>合约相关链码</h2><ul>
<li><p>编写contract下的代码，编写好后，拖到对应linux目录</p>
</li>
<li><p>安装链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231513268.png" alt="image-20220123151326386"></p>
</li>
<li><p>链码实例化</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231515006.png" alt="image-20220123151524636"></p>
</li>
<li><p>发布合约</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231522057.png" alt="image-20220123152252818"></p>
</li>
<li><p>响应合约</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231535519.png" alt="image-20220123153527155"></p>
</li>
<li><p>合约成交</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231540970.png" alt="image-20220123154053895"></p>
</li>
<li><p>合约关闭</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231541581.png" alt="image-20220123154120913"></p>
</li>
<li><p>查询合约的最新数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231545995.png" alt="image-20220123154555108"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231547838.png" alt="image-20220123154700388"></p>
</li>
<li><p>查询合约所有数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231548214.png" alt="image-20220123154854036"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201231549077.png" alt="image-20220123154951755"></p>
</li>
</ul>
<h1 id="fabric链码案例-1"><a href="#fabric链码案例-1" class="headerlink" title="fabric链码案例"></a>fabric链码案例</h1><h2 id="流程整理"><a href="#流程整理" class="headerlink" title="流程整理"></a>流程整理</h2><ul>
<li>让什么数据上链<ul>
<li>所有节点备份数据耗费空间，视频等不要上链</li>
</ul>
</li>
<li>如何交互<ul>
<li>-c “Args”:[方法名，参数]</li>
</ul>
</li>
<li>编写合约<ul>
<li>Init</li>
<li>Invoke</li>
</ul>
</li>
<li>拖到linux运行，基于配置好的网络去部署运行（安装和实例化）</li>
<li>合约交互</li>
<li>SDK调用（页面点击或输入信息）</li>
</ul>
<h2 id="需求分析"><a href="#需求分析" class="headerlink" title="需求分析"></a>需求分析</h2><ul>
<li>开发转让资产</li>
<li>功能<ul>
<li>用户开户和销户</li>
<li>资产登记，资产上链，与具体的用户绑定</li>
<li>资产转让，资产的所有权变更</li>
<li>查询功能，用户查询，资产查询，资产变更的历史查询</li>
</ul>
</li>
<li>业务实体<ul>
<li>用户<ul>
<li>名字</li>
<li>身份证（表示）</li>
<li>资产列表</li>
</ul>
</li>
<li>资产<ul>
<li>名字</li>
<li>标识</li>
<li>特殊属性列表（车：排量，品牌，座位）</li>
</ul>
</li>
<li>资产的变更记录<ul>
<li>资产标识</li>
<li>资产的原始拥有者</li>
<li>资产变更后的拥有者</li>
</ul>
</li>
</ul>
</li>
<li>交互方法<ul>
<li>用户开户<ul>
<li>参数：名字，标识</li>
</ul>
</li>
<li>用户销户<ul>
<li>标识</li>
</ul>
</li>
<li>资产登记<ul>
<li>名字，标识，特殊属性列表，拥有者</li>
</ul>
</li>
<li>资产转让<ul>
<li>拥有者，资产标识，受让者</li>
</ul>
</li>
<li>用户查询<ul>
<li>参数：标识，返回值：用户实体</li>
</ul>
</li>
<li>资产查询<ul>
<li>参数：标识，返回值：资产实体</li>
</ul>
</li>
<li>资产的变更查询<ul>
<li>参数：资产标识，返回值：资产的变更列表</li>
</ul>
</li>
</ul>
</li>
</ul>
<h2 id="合约编写"><a href="#合约编写" class="headerlink" title="合约编写"></a>合约编写</h2><ul>
<li><p>合约编写完成，传到linux对应目录</p>
</li>
<li><p>创建通道的创世交易（channel名字不能有大写）</p>
</li>
<li><p>configtxgen -profile TwoOrgsChannel -outputCreateChannelTx ./config/assetschannel.tx -channelID assetschannel</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272240598.png" alt="image-20220127224057055"></p>
<blockquote>
<p>如果出现这个提醒</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272252094.png" alt="image-20220127225209757"></p>
<p>很有可能是<strong>FABRIC_CFG_PATH</strong>环境变量没有配置成功，可以直接在deploy目录下设置<code>export FABRIC_CFG_PATH=$PWD</code>再次执行该命令即可</p>
</blockquote>
</li>
<li><p>交互执行</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272257319.png" alt="image-20220127225717142"></p>
</li>
<li><p>创建通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272256365.png" alt="image-20220127225642703"></p>
</li>
<li><p>加入通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272258425.png" alt="image-20220127225818220"></p>
</li>
<li><p>查看通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272259992.png" alt="image-20220127225939825"></p>
</li>
<li><p>安装链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272304218.png" alt="image-20220127230407170"></p>
</li>
<li><p>链码实例化</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272306073.png" alt="image-20220127230612835"></p>
</li>
<li><p>注册</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272312816.png" alt="image-20220127231250260"></p>
</li>
<li><p>用户查询</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272317960.png" alt="image-20220127231727671"></p>
</li>
<li><p>资产登记</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272316518.png" alt="image-20220127231633131"></p>
</li>
<li><p>资产查询，查询用户资产绑定</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272318986.png" alt="image-20220127231840930"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272321822.png" alt="image-20220127232101943"></p>
</li>
<li><p>注册了第二个用户</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272322838.png" alt="image-20220127232251735"></p>
</li>
<li><p>资产转让</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272328868.png" alt="image-20220127232819530"></p>
</li>
<li><p>查询用户二的用户状态</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272330021.png" alt="image-20220127233036799"></p>
</li>
<li><p>查询资产一的状态</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272330798.png" alt="image-20220127233020447"></p>
</li>
<li><p>查询所有资产的变更历史</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201272332821.png" alt="image-20220127233211273"></p>
</li>
<li><p>注销用户2，下面的资产也会随之注销</p>
</li>
</ul>
<h2 id="链码开发者模式"><a href="#链码开发者模式" class="headerlink" title="链码开发者模式"></a>链码开发者模式</h2><ul>
<li><p>将docker-compose关闭</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201281136004.png" alt="image-20220128113616795"></p>
</li>
<li><p>修改docker-compose配置</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201281138835.png" alt="image-20220128113801622"></p>
</li>
<li><p>运行docker</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201281138128.png" alt="image-20220128113841738"></p>
</li>
<li><p>在另一个会话找到编写好的智能合约</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201281142293.png" alt="image-20220128114238923"></p>
</li>
<li><p>运行链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201281154569.png" alt="image-20220128115426486"></p>
</li>
<li><p>在另一个会话进入交互执行</p>
</li>
<li><p>链码安装，实例化，调用之后，修改链码</p>
</li>
<li><p>将第二个，链码运行的对话ctrl+C结束，重新运行链码执行命令</p>
</li>
<li><p>注意：链码开发用这个模式没问题，SDK调用时，可能会出现问题，开发完智能合约关掉开发者模式</p>
</li>
</ul>
<h2 id="外部服务分析"><a href="#外部服务分析" class="headerlink" title="外部服务分析"></a>外部服务分析</h2><ul>
<li>如何提供外部服务<ul>
<li>企业内部各种数据接口，rpc，grpc</li>
<li>网站（web），手机（app），通过http</li>
<li>智能硬件，socket服务</li>
</ul>
</li>
<li>SDK提供外部服务，SDK的语言选择<ul>
<li>node.js（官方推荐，效率 9颗星）</li>
<li>java（实际使用量最大的 9颗星）</li>
<li>python（使用不太多 3颗星）</li>
<li>golang（不稳定，常用方法也没有，1颗星）</li>
</ul>
</li>
<li>SDK的模块<ul>
<li>区块链的管理：例如通道的创建和加入，链码的安装，实例化等</li>
<li>数据查询：区块和交易的查询</li>
<li>区块链交互（链码交互）：发起交易，invoke，query</li>
<li>事件监听：业务事件，系统事件</li>
</ul>
</li>
</ul>
<h2 id="SDK的下载和配置"><a href="#SDK的下载和配置" class="headerlink" title="SDK的下载和配置"></a>SDK的下载和配置</h2></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-07T09:39:21.000Z" title="2022/1/7 下午5:39:21">2022-01-07</time>发表</span><span class="level-item"><time dateTime="2022-01-11T15:41:04.431Z" title="2022/1/11 下午11:41:04">2022-01-11</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">5 分钟读完 (大约779个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/63228">树莓派入门</a></h1><div class="content"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本篇博客基于树莓派4b，系统为Raspberry</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112341284.jpeg"></p>
<h1 id="硬件改装"><a href="#硬件改装" class="headerlink" title="硬件改装"></a>硬件改装</h1><h2 id="添加风扇"><a href="#添加风扇" class="headerlink" title="添加风扇"></a>添加风扇</h2><h2 id="添加外壳"><a href="#添加外壳" class="headerlink" title="添加外壳"></a>添加外壳</h2><h1 id="镜像"><a href="#镜像" class="headerlink" title="镜像"></a>镜像</h1><p>因为树莓派使用的是arm架构的cpu，所以一些x86的系统并不兼容。</p>
<h2 id="Raspbian"><a href="#Raspbian" class="headerlink" title="Raspbian"></a>Raspbian</h2><p>树莓派官方推荐的系统，还算是比较好用，自家的系统据说对于GPIO的支持比较强大。（但是想要把树莓派当做小服务器玩的话就会不太方便。。）</p>
<p>已知的问题有：</p>
<blockquote>
<ol>
<li>不完全支持docker。</li>
</ol>
</blockquote>
<h2 id="Centos"><a href="#Centos" class="headerlink" title="Centos"></a>Centos</h2><p>尝试过刷该系统针对树莓派的版本，但是失败了。</p>
<h1 id="ssh连接"><a href="#ssh连接" class="headerlink" title="ssh连接"></a>ssh连接</h1><p>如果有图像环境（向外有HDMI输出的话）可以通过图形选择打开树莓派的ssh连接，新买的树莓派是默认关闭ssh连接的，如果需要ssh连接，需要先打开。</p>
<p>如果没有图像环境，可以通过以下步骤进行树莓派的ssh连接。</p>
<h2 id="1-开启ssh"><a href="#1-开启ssh" class="headerlink" title="1.开启ssh"></a>1.开启ssh</h2><p>将树莓派的SD卡通过读卡器连接到pc上，打开SD卡盘符在的boot分区下建立<code>ssh</code>文本文档，注意，该文档没有后缀。（一些教程说可以建立一个ssh文件夹，应该原理是相似的）</p>
<h2 id="2-进行连接即可"><a href="#2-进行连接即可" class="headerlink" title="2.进行连接即可"></a>2.进行连接即可</h2><p>通过1将树莓派的ssh打开之后，将sd卡装回树莓派，插一根网线到路由器上，然后重新开机后。找到树莓派对应的内网ip。之后直接通过ssh工具（比如mobaxterm）进行连接即可。或者通过win10的命令窗口也可以进行连接。</p>
<p>win10的ssh命令如下：</p>
<blockquote>
<p>ssh -oPort=22 <a href="mailto:&#x70;&#105;&#64;&#120;&#120;&#x78;&#x2e;&#x78;&#120;&#120;&#46;&#x78;&#x78;&#120;&#x2e;&#120;&#120;&#x78;">&#x70;&#105;&#64;&#120;&#120;&#x78;&#x2e;&#x78;&#120;&#120;&#46;&#x78;&#x78;&#120;&#x2e;&#120;&#120;&#x78;</a></p>
</blockquote>
<blockquote>
<p>默认的ssh端口是22。</p>
<p>默认的用户名是：pi</p>
<p>默认的登录密码是：raspberry</p>
</blockquote>
<h1 id="网络配置"><a href="#网络配置" class="headerlink" title="网络配置"></a>网络配置</h1><h2 id="有线网络配置"><a href="#有线网络配置" class="headerlink" title="有线网络配置"></a>有线网络配置</h2><p>直接将网线插入树莓派的网线插口即可，路由器会自动分配一个内网ip，从路由器的管理网站上找到树莓派分配的ip之后就可以进行ssh连接了。</p>
<h2 id="无线网络配置"><a href="#无线网络配置" class="headerlink" title="无线网络配置"></a>无线网络配置</h2><p>已知的有两种方法进行无线网络的配置，一种是修改刷过镜像的sd卡中的树莓派的文件，一种是ssh连接之后通过命令行进行修改。</p>
<p>这里说一下后一种配置。</p>
<h3 id="1-激活WiFi"><a href="#1-激活WiFi" class="headerlink" title="1.激活WiFi"></a>1.激活WiFi</h3><p>1）启用wifi</p>
<blockquote>
<p> rfkill unblock wifi</p>
</blockquote>
<p>2）激活网卡</p>
<blockquote>
<p>sudo ifconfig wlan0 up</p>
</blockquote>
<h3 id="2-扫描WiFi"><a href="#2-扫描WiFi" class="headerlink" title="2.扫描WiFi"></a>2.扫描WiFi</h3><blockquote>
<p>sudo iwlist wlan0 scan</p>
</blockquote>
<h3 id="3-设置需要连接的wifi名称及密码"><a href="#3-设置需要连接的wifi名称及密码" class="headerlink" title="3.设置需要连接的wifi名称及密码"></a>3.设置需要连接的wifi名称及密码</h3><blockquote>
<p>sudo nano /etc/wpa_supplicant/wpa_supplicant.conf</p>
</blockquote>
<blockquote>
<p>ctrl_interface=DIR=/var/run/wpa_supplicant GROUP=netdev<br>update_config=1<br>country=CN</p>
<p>network={<br>       ssid=”这里填需要连接的wifi的名称（不要连5G那个）”<br>       psk=”这里填需要连接的wifi的密码”<br>       key_mgmt=WPA-PSK<br>}</p>
</blockquote>
<h3 id="4-重启树莓派"><a href="#4-重启树莓派" class="headerlink" title="4.重启树莓派"></a>4.重启树莓派</h3><blockquote>
<p>sudo reboot</p>
</blockquote>
<p>重启之后即可生效，拔掉网线，只需一根电源线就可以保证树莓派能够连接到网络辣。</p>
<h1 id="frp内网穿透"><a href="#frp内网穿透" class="headerlink" title="frp内网穿透"></a>frp内网穿透</h1></div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-07T09:39:07.000Z" title="2022/1/7 下午5:39:07">2022-01-07</time>发表</span><span class="level-item"><time dateTime="2022-02-02T08:43:05.052Z" title="2022/2/2 下午4:43:05">2022-02-02</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">几秒读完 (大约80个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/21062">Python入门</a></h1><div class="content"><p>本文参考《python编程从入门到实践》，在Jupyter上完成各章节的学习和试验</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202202021633958.jpeg" alt="查看源图像" style="zoom:50%;" />

<p>下面是从Jupyter中导出的PDF文件</p>
<h1 id="目录"><a href="#目录" class="headerlink" title="目录"></a>目录</h1><ul>
<li><a target="_blank" href="/doc/《Python编程从入门到实践》(1~3章).pdf">《Python编程从入门到实践》(1~3章)</a></li>
<li><a target="_blank" href="/doc/《Python编程从入门到实践》(4~5章).pdf">《Python编程从入门到实践》(4~5章)</a></li>
<li><a target="_blank" href="/doc/《Python编程从入门到实践》(6~7章).pdf">《Python编程从入门到实践》(6~7章)</a></li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2022-01-07T09:38:50.000Z" title="2022/1/7 下午5:38:50">2022-01-07</time>发表</span><span class="level-item"><time dateTime="2022-01-09T03:07:39.163Z" title="2022/1/9 上午11:07:39">2022-01-09</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">几秒读完 (大约5个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/10811">git入门</a></h1><div class="content"><p>（坑）待填</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-11-11T03:12:51.000Z" title="2021/11/11 上午11:12:51">2021-11-11</time>发表</span><span class="level-item"><time dateTime="2021-11-19T14:20:38.907Z" title="2021/11/19 下午10:20:38">2021-11-19</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">5 分钟读完 (大约707个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/59533">JAVA入门</a></h1><div class="content"><h1 id="《Java编程思想》笔记"><a href="#《Java编程思想》笔记" class="headerlink" title="《Java编程思想》笔记"></a>《Java编程思想》笔记</h1><blockquote>
<p>记录了在阅读《Java编程思想》中感到需要记录下的一些新的东西。</p>
</blockquote>
<h2 id="第一章-对象导论"><a href="#第一章-对象导论" class="headerlink" title="第一章 对象导论"></a>第一章 对象导论</h2><ul>
<li>面向对象语言的五个基本特性之一： java程序是对象的集合，他们通过<strong>发送消息</strong>来<strong>告知彼此</strong>所需要做的。</li>
<li>对象的简洁描述：对象具有<strong>状态，行为和标识</strong>。</li>
<li>在面对对象程序设计中实际上进行的是<strong>创建新的数据类型</strong>。- </li>
<li>不要把多有的功能都塞到一个类中。</li>
<li>java程序开发人员被分为类创造者，和客户端程序员。</li>
<li>类中被隐藏的部分通常代表对象内部<strong>脆弱的部分</strong>。</li>
<li>protected表示继承的类可以访问protected成员。</li>
<li>不要总想着用继承，这会导师制难以使用并过分复杂的设计，应该首先考虑<strong>组合</strong>。</li>
<li>当继承时，新的类型复制了基类的接口。</li>
<li>前期绑定：在编译器产生的函数调用会将这个调用解析到将要被执行的代码的绝对地址。</li>
<li>后期绑定：程序知道运行时才能够确定代码的地址。</li>
<li><strong>虚函数</strong>是后期绑定的体现。（Java中<strong>所有的函数</strong>都是虚函数）。</li>
<li>把导出类看做是它的基类的过程称为向上转型</li>
<li>单根继承结构：终极基类是Objective，单根继承结构使垃圾回收期的实现变得容易很多。</li>
<li>将对象的引用放入容器内中时，它会被被向上转型为基类型，因此它会<strong>丢失身份</strong>。</li>
<li>参数化类型（范型/范式）用来解决容器中保存特定类型的类的问题。</li>
<li>Java完全采用了动态内存分配方式。</li>
<li>Java的异常不会干扰正常的执行代码，异常提供了一种从错误状况进行可靠恢复的途径。</li>
<li>之前的并发编程是通过编写中断服务程序，主进程的挂起是通过硬件的中断来触发的，缺少可移植性。Java的并发编程是内置于语言中的，线程只是一种为单一处理器分配执行时间的手段，如果一个操作系统支持多处理器，那么每个任务都可以被指派给不同的处理器。如果只有一个处理器，那么程序在逻辑上被分为线程。</li>
<li>中间件：将负载分赛在服务器端的其他机器。（中间件也被用来提高可维护性）</li>
</ul>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-08-31T11:27:39.000Z" title="2021/8/31 下午7:27:39">2021-08-31</time>发表</span><span class="level-item"><time dateTime="2021-09-14T08:54:20.853Z" title="2021/9/14 下午4:54:20">2021-09-14</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">15 分钟读完 (大约2199个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/25262">深度学习初探</a></h1><div class="content"><h2 id="二分分类"><a href="#二分分类" class="headerlink" title="二分分类"></a>二分分类</h2><h3 id="什么是Logistic-回归？"><a href="#什么是Logistic-回归？" class="headerlink" title="什么是Logistic 回归？"></a>什么是Logistic 回归？</h3><p>logistic 回归函数：来对一组输入做一个 0 ~ 1 的概率判断。</p>
<p>x为输入的特征向量，得到的回归函数值为 <strong>sigma(w^(T) * x + b)</strong> ，参数为w和b，是一个在0和1中间的一个概率。<strong>sigma(z)</strong> 是  <strong>1 / 1 + e ^ (- z)</strong> 。</p>
<p><strong>损失函数</strong>：lost(y^, y) = <strong>- ( y log y^ + (1 - y) log(1 - y^) )</strong> （其中y^为y的预测值）。越小越好。</p>
<p><strong>成本函数</strong>：J(w, b) = <strong>1 / m * Σ lost(y^, y) = -1 / m * Σ(y log y^ + (1 - y)log(1 - y^))</strong> 。为m组损失函数的平均值，越小越好。</p>
<p><strong>梯度下降法</strong>：<strong>w := w - αd(J(w, b)) / d(w) ，b := b - αd(J(w, b)) / d(b)</strong> 。α是学习率。</p>
<p>梯度就是函数对变量的偏导。</p>
<p>正向传播：用参数计算出函数的值</p>
<p>反向传播：利用函数来计算每一个参数的导数</p>
<p>对Logistic 回归的一组数据进行梯度下降法：</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210901232913.png" style="zoom:150%;" />

<h3 id="Logistic-回归的Python实现"><a href="#Logistic-回归的Python实现" class="headerlink" title="Logistic 回归的Python实现"></a>Logistic 回归的Python实现</h3><p>对Logistic 回归的m组数据进行一次梯度下降法：</p>
<pre class="line-numbers language-python"><code class="language-python">J <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> dw1 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> dw2 <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> db <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> i <span class="token operator">=</span> <span class="token number">1</span> to m
    z<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> wx<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">+</span>b<span class="token punctuation">;</span>
    a<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>z<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    J <span class="token operator">+=</span> <span class="token operator">-</span><span class="token punctuation">[</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>log<span class="token punctuation">(</span>a<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span>）log<span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">-</span>a<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">=</span> a<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token operator">-</span>y<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dw1 <span class="token operator">+=</span> x1<span class="token punctuation">(</span>i<span class="token punctuation">)</span>dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    dw2 <span class="token operator">+=</span> x2<span class="token punctuation">(</span>i<span class="token punctuation">)</span>dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    db <span class="token operator">+=</span> dz<span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">;</span>
J <span class="token operator">/=</span> m<span class="token punctuation">;</span>
dw1 <span class="token operator">/=</span> m<span class="token punctuation">;</span>
dw2 <span class="token operator">/=</span> m<span class="token punctuation">;</span>
db <span class="token operator">/=</span> m<span class="token punctuation">;</span>
w <span class="token operator">=</span> w <span class="token operator">-</span> alpha <span class="token operator">*</span> dw
b <span class="token operator">=</span> b <span class="token operator">-</span> alpha <span class="token operator">*</span> db
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="如何减少循环的次数？"><a href="#如何减少循环的次数？" class="headerlink" title="如何减少循环的次数？"></a>如何减少循环的次数？</h3><p>使用<strong>向量化</strong>来减少显式For循环。</p>
<pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> numpy <span class="token keyword">as</span> np <span class="token comment" spellcheck="true">#导入numpy库</span>
a <span class="token operator">=</span> np<span class="token punctuation">.</span>array<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#创建一个数据a</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>a<span class="token punctuation">)</span>
<span class="token keyword">import</span> time <span class="token comment" spellcheck="true">#导入时间库</span>
a <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> np<span class="token punctuation">.</span>random<span class="token punctuation">.</span>rand<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#通过round随机得到两个一百万维度的数组</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#现在测量一下当前时间</span>
<span class="token comment" spellcheck="true">#向量化的版本</span>
c <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>a<span class="token punctuation">,</span>b<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#对a，b进行矩阵乘法</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>“Vectorized version<span class="token punctuation">:</span>” <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc<span class="token operator">-</span>tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span>”ms”<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">#打印一下向量化的版本的时间</span>
<span class="token comment" spellcheck="true">#继续增加非向量化的版本</span>
c <span class="token operator">=</span> <span class="token number">0</span>
tic <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    c <span class="token operator">+=</span> a<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token operator">*</span>b<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
toc <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>“For loop<span class="token punctuation">:</span>” <span class="token operator">+</span> str<span class="token punctuation">(</span><span class="token number">1000</span><span class="token operator">*</span><span class="token punctuation">(</span>toc<span class="token operator">-</span>tic<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> “ms”<span class="token punctuation">)</span><span class="token comment" spellcheck="true">#打印for循环的版本的时间</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>通过使用<strong>numpy</strong>中的函数来进行向量运算从而减少显式For循环。</p>
<p>可以使用向量化完全消除显式的For循环：</p>
<pre class="line-numbers language-python"><code class="language-python">Z <span class="token operator">=</span> np<span class="token punctuation">.</span>dot<span class="token punctuation">(</span>w<span class="token punctuation">.</span>T<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token operator">+</span>b
A <span class="token operator">=</span> σ<span class="token punctuation">(</span>Z<span class="token punctuation">)</span>
dZ <span class="token operator">=</span> A − Y
dw <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> m ∗ X ∗ dZ<span class="token punctuation">.</span>T
db <span class="token operator">=</span> <span class="token number">1</span> <span class="token operator">/</span> m ∗ np<span class="token punctuation">.</span>sum<span class="token punctuation">(</span>dZ<span class="token punctuation">)</span>
w <span class="token operator">=</span> w − α ∗ dw
b <span class="token operator">=</span> b − α ∗ db
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<blockquote>
<p>现在我们利用前五个公式完成了前向和后向传播，也实现了对所有训练样本进行预测和求导，再利用后两个公式，梯度下降更新参数。我们的目的是不使用for循环，所以我们就通过一次迭代实现一次梯度下降，但如果你希望多次迭代进行梯度下降，那么仍然需要for循环，放在最外层。不过我们还是觉得一次迭代就进行一次梯度下降，避免使用任何循环比较舒服一些。</p>
</blockquote>
<p><strong>学习进度</strong>：吴恩达深度学习课程第一课前两周课（24节）</p>
<h2 id="浅层神经网络"><a href="#浅层神经网络" class="headerlink" title="浅层神经网络"></a>浅层神经网络</h2><h3 id="什么是双层神经网络？"><a href="#什么是双层神经网络？" class="headerlink" title="什么是双层神经网络？"></a>什么是双层神经网络？</h3><p>神经网络的大致组成：<strong>输入层，隐藏层，输出层。</strong></p>
<p>logistic 回归只有输入层和输出层。</p>
<p>双层神经网络的两层是指隐藏层和输出层，输入层不算。（也可以叫单隐层神经网络）</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210902224803.png" alt="img"  />

<p>上图是一个双层神经网络的示意图。</p>
<p>对比一般的Logistic 回归，对于一组输入来说，双层神经网络有多个a在第一层的输出到第二层去。在输出层中，输入是隐藏层中运算得到的a值，输出是经过Logistic 回归得到的最终值。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210902224933.png" alt="在这里插入图片描述"></p>
<p>上图是隐藏层中一个神经元的具体构造。</p>
<p>同时我们也希望可以将这个双层神经网络进行向量化从而来简化我们的运算。</p>
<h3 id="如何将双层神经网络进行向量化？"><a href="#如何将双层神经网络进行向量化？" class="headerlink" title="如何将双层神经网络进行向量化？"></a>如何将双层神经网络进行向量化？</h3><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210908094249.png" alt="img"></p>
<p>该图将一组数据进行了向量化，通过上图的运算，可以更快地得出一组数据经过一次双层神经网络处理的结果。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210908100221.png" alt="img"></p>
<p>如图的操作可以将多组数据进行向量化运算，即，经过一次操作对多组输入进行一次双层神行网络处理。</p>
<h3 id="如何选择激活函数？"><a href="#如何选择激活函数？" class="headerlink" title="如何选择激活函数？"></a>如何选择激活函数？</h3><p>常见的激活分类有：<strong>σ函数，tanh函数，ReUL函数，Leaky Relu函数</strong>。</p>
<p>对于tanh函数，是由σ函数向下平移和伸缩后得到的。相比于σ函数，数据的平均值更接近0，这会使下一层学习简单一点。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210908101454.png" alt="img"></p>
<p>选用适合的激活函数可以加快机器学习的速度，常用的<strong>Relu</strong>函数的优点如下：</p>
<blockquote>
<p>第一，在 z 的区间变动很大的情况下，激活函数的导数或者激活函数的斜率都会远大于0，在程序实现就是一个if-else语句，而sigmoid函数需要进行浮点四则运算，在实践中，使用ReLu激活函数神经网络通常会比使用sigmoid或者tanh激活函数学习的更快。</p>
<p>第二，sigmoid和tanh函数的导数在正负饱和区的梯度都会接近于0，这会造成梯度弥散，而Relu和Leaky ReLu函数大于0部分都为常数，不会产生梯度弥散现象。(同时应该注意到的是，Relu进入负半区的时候，梯度为0，神经元此时不会训练，产生所谓的稀疏性，而Leaky ReLu不会有这问题)</p>
<p> z 在ReLu的梯度一半都是0，但是，有足够的隐藏层使得z值大于0，所以对大多数的训练数据来说学习过程仍然可以很快。</p>
</blockquote>
<p>概括一下不同激活函数的过程和结论：</p>
<blockquote>
<p><strong>sigmoid激活函数</strong>：除了输出层是一个二分类问题基本不会用它。</p>
<p><strong>tanh激活函数</strong>：tanh是非常优秀的，几乎适合所有场合。</p>
<p><strong>ReLu激活函数</strong>：最常用的默认函数，，如果不确定用哪个激活函数，就使用ReLu或者Leaky ReLu。公式 a = max( 0.01 z , z ) <em>为什么常数是0.01？</em>当然，可以为学习算法选择不同的参数。（注意ReLu函数是非线性的）</p>
</blockquote>
<p><strong>注意：</strong>在选择激活函数的时候，要选择非线性函数，因为多层线性函数的组合得到的结果还是线性的，那么神经网络只是把输入线性组合再输出。只有在做机器学习中的回归问题的时候才可能会选择线性函数作为激活函数。</p>
<h3 id="激活函数的导数"><a href="#激活函数的导数" class="headerlink" title="激活函数的导数"></a>激活函数的导数</h3><p>对于常见的几种激活函数的导数：</p>
<blockquote>
<p><strong>sigmoid函数 **σ(x) = a 的导数为 **a (1 - a)</strong></p>
<p><strong>tanh函数</strong> tanh(x) = a 的导数为 <strong>1 - a^2</strong></p>
<p><strong>Relu函数</strong> max(0, x) = a 的导数在 x &lt; 0 的时候为0， 在 x &gt; 0 的时候为1，在 x = 0 的时候没有定义，一般手动定义为 0 或者 1 。</p>
<p><strong>Leaky Relu函数</strong> max(0,01x, x) = a 的导数在 x &lt; 0 的时候为 0,01 ， 在 x &gt; 0 的时候为1，在 x = 0 的时候没有定义，一般手动定义为 0 或者 1 。</p>
</blockquote>
<h3 id="双层神经网络的梯度下降法（反向传播的实现）"><a href="#双层神经网络的梯度下降法（反向传播的实现）" class="headerlink" title="双层神经网络的梯度下降法（反向传播的实现）"></a>双层神经网络的梯度下降法（反向传播的实现）</h3><p>由以上学习可知双层神经网络的正向传播就是按照所给的基本公式进行计算，而反向传播可以在每一轮中对模型中的参数进行调整。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210908112412.png" alt="image-20210908112409534"></p>
<p>反向传播与普通<strong>Logistic</strong>回归不同的地方在于计算第一层的dz时的差别。</p>
<blockquote>
<p>这里np.sum是python的numpy命令，axis=1表示水平相加求和，keepdims是防止python输出那些古怪的秩数 ( n , )，加上这个确保矩阵 db[ 2 ] 这个向量输出的维度为 ( n , 1 ) 这样标准的形式。</p>
</blockquote>
<h3 id="随机初始化"><a href="#随机初始化" class="headerlink" title="随机初始化"></a>随机初始化</h3><p>为什么在<strong>Logistic</strong>回归中不能将W数组的初始化定为0？</p>
<p>因为这样的话在第一层中的神经元就会计算出相同的结果，这样</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-07-24T12:58:48.000Z" title="2021/7/24 下午8:58:48">2021-07-24</time>发表</span><span class="level-item"><time dateTime="2021-09-08T04:20:04.060Z" title="2021/9/8 下午12:20:04">2021-09-08</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">19 分钟读完 (大约2777个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/35840">数学建模入门</a></h1><div class="content"><h1 id="Matlab学习笔记"><a href="#Matlab学习笔记" class="headerlink" title="Matlab学习笔记"></a>Matlab学习笔记</h1><p>语法小知识：</p>
<ul>
<li>同一行中间用逗号分隔，也可以不用逗号，直接用空格 分号可以用来分隔每一行的元素就是说逗号是一行中的数据，分号分割行与行之间。</li>
<li>矩阵E(:)表示矩阵的所有元素，E(:,1)表示第一列，E(1,:)表示第一行。</li>
<li>2:5表示从第2到第5，1:3:10表示从1到10，每次递增3。2:end表示从第二行到最后一行，</li>
<li>~=是不等号</li>
<li>Matlab函数的声明要单独放在一个.m文件中，不能直接放在主函数里面。函数声明格式：function [输出变量] = 函数名称(输入变量）  最后用end结束声明</li>
</ul>
<pre class="line-numbers language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% 常用指令操作</span>
clc <span class="token comment" spellcheck="true">% 清屏</span>
clear all <span class="token comment" spellcheck="true">% 清除工作区的所有变量</span>
hold on 
hold off <span class="token comment" spellcheck="true">% 控制图像是否被刷新</span>
<span class="token comment" spellcheck="true">% 常用字符串函数</span>
<span class="token function">char</span><span class="token punctuation">(</span><span class="token number">65</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% ascii码对应的字符，A</span>
<span class="token function">length</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 字符串长度</span>
<span class="token function">strcmp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 字符串比较函数</span>
<span class="token function">strcat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 将多个字符串合并成一个</span>
<span class="token function">num2str</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 将数字转换为字符串</span>
<span class="token comment" spellcheck="true">% 常用数学函数</span>
<span class="token function">size</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 数组大小，第二个参数也是dim表示矩阵的维度。</span>
<span class="token function">magic</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 生成一个幻方</span>
<span class="token function">abs</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 求s的ascii码</span>
<span class="token function">floor</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">% 取整函数</span>
<span class="token function">sum</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 求和函数，辅助参数dim表示求和的维度，1表示按列，2表示按行，默认dim=1</span>
<span class="token function">repmat</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 复制扩展矩阵</span>
<span class="token function">sort</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 将数组或矩阵排序</span>
<span class="token function">prod</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 计算矩阵每一列的乘积</span>
<span class="token function">eig</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 计算矩阵的特征值</span>
<span class="token function">inv</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 求矩阵的逆矩阵</span>
<span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 产生（0,1）之间均匀分布的伪随机数组成的数组</span>
<span class="token function">randn</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 生成标准正态分布的伪随机数（均值为0，方差为1）</span>
<span class="token function">randperm</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 将一序号随机打乱，序号必须是整数</span>
<span class="token function">normrnd</span><span class="token punctuation">(</span>MU<span class="token punctuation">,</span>SIGMA<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 生成服从正态分布的随机数</span>
<span class="token comment" spellcheck="true">% 常用数据输入输出函数</span>
<span class="token function">disp</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 向命令行输出字符或数字</span>
<span class="token function">input</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 从命令行读取数据</span>
<span class="token function">xlsread</span><span class="token punctuation">(</span><span class="token string">'xls_name_string'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% Excel表格读取</span>
save <span class="token comment" spellcheck="true">% 用来将数据保存为.mat文件</span>
load <span class="token comment" spellcheck="true">% 用来加载之间生成的.mat文件</span>
<span class="token comment" spellcheck="true">% 常用绘图函数</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 创建2维直线图</span>
<span class="token function">stem</span><span class="token punctuation">(</span>Y<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 绘制数据序列Y的茎状图</span>
<span class="token function">meshgrid</span><span class="token punctuation">(</span>a<span class="token punctuation">,</span> b<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 生成二维网格</span>
<span class="token function">contour3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 三维等值线绘图</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'string1'</span><span class="token punctuation">,</span><span class="token string">'string2'</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 标注绘制的图形的名称</span>
<span class="token function">xlabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">ylabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token function">zlabel</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 标注x,y,z轴</span>
<span class="token function">title</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token comment" spellcheck="true">% matlab绘图标题设置</span>
<span class="token function">set</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 设置图像属性</span>
<span class="token function">axis</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment" spellcheck="true">% 对坐标轴进行缩放操作</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<pre class="line-numbers language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% matlab里的一些基本规范</span>
<span class="token comment" spellcheck="true">% 数值</span>
<span class="token comment" spellcheck="true">% 字符串</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
<ul>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/ph101LOVE/article/details/78454907">floor函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xuxinrk/article/details/80961657">randperm函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xuxinrk/article/details/80581303">normrnd函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_38549334/article/details/94645995">repmat函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_40533355/article/details/88426755">size函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/zhmjunjun/article/details/79840305?utm_term=magic%E7%9F%A9%E9%98%B5matlab&utm_medium=distribute.pc_aggpage_search_result.none-task-blog-2~all~sobaiduweb~default-4-79840305&spm=3001.4430">magic函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/sp353846548/article/details/80692256">sum函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u012365383/article/details/16965721/">prod函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013457382/article/details/48270497">eig函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/anzhiwu815/p/5907033.html">find函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/xiaotao_1/article/details/79100163">plot命令详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u013346007/article/details/54581253">meshgrid函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_44044161/article/details/116742144">contour3函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010545732/article/details/26804641">stem函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/smf0504/article/details/51830963/">hold on 和 hold off 语句详解</a></li>
<li><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zerobyzero/articles/5948318.html">legend函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/u010142437/article/details/23740745">xlabel函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_41554884/article/details/79913272">set函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_25018077/article/details/87873702">axis函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_42542669/article/details/112159162">title函数详解+matlab二维画图基本操作</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_41325698/article/details/95251829">xlsread函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/sinat_34165087/article/details/79048423">disp函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/weixin_43914889/article/details/87800145">input函数详解</a></li>
<li><a target="_blank" rel="noopener" href="https://blog.csdn.net/sunzhao1000/article/details/80590333">save 和 load详解</a></li>
</ul>
<p>一、矩阵及数组操作例题：</p>
<pre class="line-numbers language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% 生成一个3x3和15x8的单位矩阵</span>
<span class="token function">eye</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">eye</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">% 生成全1矩阵</span>
<span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">ones</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">% 全0矩阵</span>
<span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token function">zeros</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">% 均匀分布随机矩阵（[-1, 1]之间）</span>
<span class="token number">2</span> <span class="token operator">*</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
<span class="token number">2</span> <span class="token operator">*</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">8</span><span class="token punctuation">)</span> <span class="token operator">-</span> <span class="token number">1</span>
<span class="token comment" spellcheck="true">% 正态分布矩阵（均值为1，方差为4）</span>
<span class="token number">1</span><span class="token operator">+</span><span class="token function">sqrt</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token function">randn</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">% 利用fix及rand函数生成[0,10]上的均匀分布的10x10的整数随机矩阵a，然后统计a中大于等于5的元素的个数。</span>
a <span class="token operator">=</span> <span class="token function">fix</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token operator">*</span><span class="token function">rand</span><span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
b <span class="token operator">=</span> <span class="token punctuation">[</span>a<span class="token operator">>=</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
c <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token function">sum</span><span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">sum</span><span class="token punctuation">(</span>c<span class="token operator">'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">% 在给定的矩阵中删除含有整行内容全为0的行，删除整列内容全为0的列。</span>
a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">0</span> <span class="token number">4</span><span class="token punctuation">;</span><span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token number">5</span> <span class="token number">6</span> <span class="token number">0</span> <span class="token number">8</span><span class="token punctuation">;</span> <span class="token number">9</span> <span class="token number">1</span> <span class="token number">0</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token operator">:</span><span class="token punctuation">,</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">a</span><span class="token punctuation">(</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">sum</span><span class="token punctuation">(</span><span class="token function">abs</span><span class="token punctuation">(</span>a<span class="token operator">'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token operator">:</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment" spellcheck="true">% 没看懂，该写法待确认</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>二、绘图：</p>
<pre class="line-numbers language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% 在同一图形窗口画出下列两条曲线图像，并用legend标注：</span>
x<span class="token operator">=</span><span class="token number">0</span> <span class="token operator">:</span> <span class="token number">1</span> <span class="token operator">:</span> <span class="token number">10</span><span class="token punctuation">;</span>
y1<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token operator">+</span><span class="token number">5</span><span class="token punctuation">;</span>
y2<span class="token operator">=</span>x<span class="token operator">.^</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">3</span><span class="token operator">*</span>x<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token function">plot</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y1<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y2<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">legend</span><span class="token punctuation">(</span><span class="token string">'y1'</span><span class="token punctuation">,</span><span class="token string">'y2'</span><span class="token punctuation">)</span>
<span class="token comment" spellcheck="true">% 画出下列函数的曲面及等高线</span>
<span class="token comment" spellcheck="true">% z = x^2 + y^2 + sin(xy).</span>
<span class="token punctuation">[</span>x<span class="token punctuation">,</span> y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">meshgrid</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token operator">:</span><span class="token number">0.25</span><span class="token operator">:</span><span class="token number">4</span><span class="token operator">*</span><span class="token keyword">pi</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
z<span class="token operator">=</span>x<span class="token operator">.^</span><span class="token number">2</span><span class="token operator">+</span>y<span class="token operator">.^</span><span class="token number">2</span><span class="token operator">+</span><span class="token function">sin</span><span class="token punctuation">(</span>x<span class="token operator">*</span>y<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">contour3</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">meshc</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">,</span> z<span class="token punctuation">)</span>
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>三、简单程序设计</p>
<pre class="line-numbers language-matlab"><code class="language-matlab"><span class="token comment" spellcheck="true">% 求分段函数</span>
x<span class="token operator">=</span><span class="token function">input</span><span class="token punctuation">(</span><span class="token string">'请输入x的值：'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> x<span class="token operator">>=</span><span class="token operator">-</span><span class="token number">3</span> <span class="token operator">&amp;&amp;</span> x <span class="token operator">&lt;</span> <span class="token operator">-</span><span class="token number">1</span>
    y<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">-</span><span class="token number">4</span><span class="token operator">*</span>x<span class="token number">-3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">elseif</span> x<span class="token operator">>=</span><span class="token operator">-</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> x<span class="token operator">&lt;</span><span class="token number">1</span>
    y<span class="token operator">=</span><span class="token operator">-</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">;</span>
<span class="token keyword">elseif</span> x<span class="token operator">>=</span><span class="token number">1</span> <span class="token operator">&amp;&amp;</span> x<span class="token operator">&lt;=</span><span class="token number">3</span>
    y<span class="token operator">=</span><span class="token punctuation">(</span><span class="token operator">-</span>x<span class="token operator">^</span><span class="token number">2</span><span class="token operator">+</span><span class="token number">4</span><span class="token operator">*</span>x<span class="token number">-3</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">2</span><span class="token punctuation">;</span>
<span class="token keyword">else</span>
    y<span class="token operator">=</span><span class="token string">'error'</span>
<span class="token keyword">end</span>
y
<span class="token comment" spellcheck="true">% 分数序列求和</span>
m <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
n <span class="token operator">=</span> <span class="token number">2</span><span class="token punctuation">;</span>
sum <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
<span class="token keyword">for</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token operator">:</span><span class="token number">15</span>
    f<span class="token operator">=</span>n<span class="token operator">/</span>m<span class="token punctuation">;</span>
    sum<span class="token operator">=</span>sum<span class="token operator">+</span>f<span class="token punctuation">;</span>
    t<span class="token operator">=</span>n<span class="token punctuation">;</span>
    n<span class="token operator">=</span>m<span class="token operator">+</span>n<span class="token punctuation">;</span>
    m<span class="token operator">=</span>t<span class="token punctuation">;</span>
<span class="token keyword">end</span>
sum
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p>一些注意事项:</p>
<ul>
<li>在变量定义的时候多写注释，注明每个变量的作用。</li>
<li>好的数学建模matlab的代码部分注释都很详细。</li>
<li>可以将代码分成几个部分，这样更加清晰，e.g. 数据清除，导入数据，数据预处理，相关步骤等….</li>
<li>在很多代码开头会遇到：clear;clc 这两条一起使用，起到“初始化”的作用，防止之前的结果对新脚本文件（后缀名是 .m）产生干扰。</li>
</ul>
<h1 id="数学建模常见算法学习"><a href="#数学建模常见算法学习" class="headerlink" title="数学建模常见算法学习"></a>数学建模常见算法学习</h1><h2 id="层次分析法（AHP）"><a href="#层次分析法（AHP）" class="headerlink" title="层次分析法（AHP）"></a>层次分析法（AHP）</h2><p>一、对于一个问题，先分析系统中各因素之间的关系，建立系统的递阶层次结构（三层图）。</p>
<p>二、然后对于同一层次的各元素关于上一层中某一准则的重要性进行两两比较，构造判断矩阵。</p>
<blockquote>
<p>在准则层需要生成每个准则的权重，在方案层需要生成对于每个准则的得分，使用两两对比的方法生成<strong>判断矩阵</strong>然后就可以计算出每个准则的权重或者方案对不同准则的得分了。</p>
<p>在层次分析法中我们构造的判断矩阵均是<strong>正互反矩阵</strong>(𝑎ij * 𝑎ji = 1)，若正互反矩阵满足𝑎ij  * 𝑎jk = 𝑎ik，则我们称为<strong>一致矩阵</strong>。在判断矩阵计算准则的权重或者方案对不同准则的得分之前，需要对其进行<strong>一致性检验</strong>。</p>
</blockquote>
<p>三、通过计算<strong>一致性指标</strong>和<strong>一致性比例</strong>来评判判断矩阵是否可以接受，计算对于该准则的相对权重。</p>
<blockquote>
<p>进行一致性检验的一致矩阵准则的权重的计算或者方案对不同准则的得分的计算，计算权重或者得分有多种方式：</p>
<ul>
<li><p>算数平均法求权重</p>
</li>
<li><p>集合平均法求权重</p>
</li>
<li><p>特征值法求权重</p>
</li>
</ul>
<p>计算出所有的方案对不同准则的得分和准则的权重之后就可以计算每个方案的加权得分了。</p>
</blockquote>
<p>四、计算各层元素对系统目标的合成权重，并进行排序。</p>
<h2 id="TOPSIS法（优劣解距离法）"><a href="#TOPSIS法（优劣解距离法）" class="headerlink" title="TOPSIS法（优劣解距离法）"></a>TOPSIS法（优劣解距离法）</h2><p>一、将原始矩阵正向化，将所有的指标转化成极大型指标。</p>
<blockquote>
<ul>
<li>极大型指标</li>
<li>极小型指标</li>
<li>中间型指标</li>
<li>区间型指标</li>
</ul>
</blockquote>
<p>二、正向化矩阵标准化。</p>
<blockquote>
<p>消除不同指标量纲的影响，例如名次和分数两个指标导致的量纲不统一的影响。</p>
</blockquote>
<p>三、计算得分并归一化</p>
<blockquote>
<p>通过公式计算每一个评价对象对不同的评价指标离最小值的距离和到最大最小距离的和的比值来得到评价对象在该评价指标上的得分。</p>
</blockquote>
<p>四、带权重的TOPSIS</p>
<blockquote>
<p>通过层次分析法可以得到不同的指标的权值，在进行计算得分的时候乘以相应的权值。</p>
</blockquote>
<h2 id="插值算法"><a href="#插值算法" class="headerlink" title="插值算法"></a>插值算法</h2><blockquote>
<p>理解：感觉该算法就是通过已知的一些点来推测拟合出一个函数，并借此函数计算出需要插值的点所对应的值是多少</p>
<p>常见插值方法：</p>
<ul>
<li>多项式插值</li>
<li>分段插值</li>
<li>三角插值</li>
</ul>
</blockquote>
<p>一、拉格朗日插值法</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210728190550.png" alt="image-20210728190543870" style="zoom:50%;" />

<blockquote>
<p>通过该方法，可以通过n+1个点来找到一个n+1项n次的一个多项式作为插值函数，来估计对应插值点的函数值。</p>
</blockquote>
<p>龙格现象：高次插值会产生龙格现象，即在两端处波动极大，产生明显的震荡。<strong>在不熟悉曲线的运动趋势的前提下，不要轻易使用高次插值</strong></p>
<p>分段线性插值</p>
<blockquote>
<p>分段线性插值法的一种为<strong>分段二次插值法</strong>，在几何上利用分段抛物线来代替原函数，故分段二次插值法又称为分段抛物线插值法。</p>
<p>但是在分段时使用的插值方法本质还是拉格朗日插值法。</p>
</blockquote>
<p>二、牛顿插值法</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210728190644.png" alt="image-20210728190644865" style="zoom:50%;" />

<blockquote>
<p>与拉格朗日插值法相比，牛顿插值法具有<strong>继承性</strong>。（牛顿插值法每次插值只和前n项的值有关，这样每次只要在原来的函数上添加新的项，就能够产生新的函数）但是牛顿插值也存在<strong>龙格现象</strong>的问题。</p>
</blockquote>
<blockquote>
<p>拉格朗日插值法和牛顿插值法两种方法得到的多项式<strong>都不能全面的反映被插值函数的形态</strong>，比如说在一个或者全部节点上的<strong>导数值</strong>，或者高阶导数值，这两种插值法都不能满足。</p>
</blockquote>
<p>三、埃尔米特（Hermite）插值法</p>
<blockquote>
<p>埃尔米特插值法可以保证插值函数在节点处有切线（<strong>光滑</strong>）使插值函数和被插值函数的密合程度比较好。</p>
</blockquote>
<p>分段三次埃尔米特插值法</p>
<blockquote>
<p>直接使用<strong>Hermite</strong>插值得到的多项式的次数也比较高，也会存在龙格现象，因此在实际应用中，往往使用分段三次<strong>Hermite</strong>插值多项式（PCHIP）</p>
</blockquote>
<p>四、三次样条插值法</p>
<blockquote>
<p>该插值法同样是区间插值法，是可以保证二阶连续可微的插值法。</p>
</blockquote>
<p>这些插值法都在Matlab内部提供了封装好的实现方法，体现为内置的函数。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-07-16T02:25:12.000Z" title="2021/7/16 上午10:25:12">2021-07-16</time>发表</span><span class="level-item"><time dateTime="2022-01-11T14:23:14.898Z" title="2022/1/11 下午10:23:14">2022-01-11</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">18 分钟读完 (大约2763个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/29920">Hyperledger-Fabric试验快速搭建</a></h1><div class="content"><h1 id="Hyperledger-Fabric文档阅读"><a href="#Hyperledger-Fabric文档阅读" class="headerlink" title="Hyperledger Fabric文档阅读"></a>Hyperledger Fabric文档阅读</h1><h2 id="介绍（自己总结的）"><a href="#介绍（自己总结的）" class="headerlink" title="介绍（自己总结的）"></a>介绍（自己总结的）</h2><p><strong>区块链：</strong> <em>分布式</em>网络，<em>节点</em>维护，不可篡改的<em>账本</em>，<em>共识协议</em>来验证<em>交易</em>，节点执行交易来维护账本的副本，账本以<em>区块</em>的方式存在，区块通过<em>哈希</em>和之前的区块相连。</p>
<p><strong>区块链的应用</strong>：加密货币：比特币、以太坊：智能合约：为分布式应用创建平台。：公共非许可区块链技术，公共网络，匿名互动。</p>
<p><strong>公共非许可区块链技术的缺点：</strong>性能较差，身份匿名。</p>
<p><strong>企业级应用的需求</strong>：身份识别，性能强，低延迟，隐私性和机密性。</p>
<p><strong>Hyperledger  Fabric的自身定位：</strong>开源企业级许可分布式账本技术平台。高度*<strong>模块化**<em>，</em></strong>可配置*<strong>的架构，支持**<em>通用编程语言编写智能合约</em></strong>，平台是*<strong>许可的**<em>，参与者</em></strong>确实*<strong>存在信任，**<em>可插拔的共识协议</em></strong>，可以利用*<strong>不需要原生加密货币<em>的共识协议**，</em></strong>性能较好*<strong>，**<em>隐私和保密</em></strong>。</p>
<p><strong>特性的一些解释：</strong><br><strong>非许可区块链：</strong>匿名，信任通过工作量证明进行，采用挖矿来抵消工作量证明的成本。<br><strong>许可区块链:**使用共识协议来进行信任，不需要昂贵的挖掘。<br>**智能合约：</strong>“链码”，受信任的分布式应用程序。从区块链中获得信任，在节点中达成共识。共识协议：验证，排序交易，传播到所有节点，各节点按顺序执行交易。<strong>一种新方法</strong>消除了非确定性，标准编程语言。<br><strong>隐私和保密性：</strong>公共非许可区块链网络中，基于Pow的拜占庭容错共识牺牲了合约和数据的保密性。<strong>加密数据</strong>：可能被破解，<strong>零知识证明</strong>：使用其他共识，将机密信息限制于授权节点中。<br><strong>可插拔共识：</strong>模块化的共识<br><strong>性能和可扩展性：</strong></p>
<h2 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h2><p>什么是区块链？：<strong>一个分布式账本</strong>，记录网络上所有的交易。<strong>去中心化</strong>，<strong>协作</strong>维护。信息仅能以附加的方式记录到区块链上，并使用加密技术保证一旦将交易添加到账本就无法修改。简化了信息的溯源。区块链有时被描述为 <strong>证明系统</strong> 。</p>
<p><strong>智能合约</strong>：为了支持以同样的方式更新信息，并实现一整套账本功能（交易，查询等），区块链使用 <strong>智能合约</strong> 来提供对账本的受控访问。智能合约不仅是在网络中<strong>封装和简化信息</strong>的关键机制，它还可以被编写成<strong>自动执行参与者的特定交易</strong>的合约。</p>
<p><strong>共识</strong>：保持账本在整个网络中同步的过程称为 <strong>共识</strong> 。该过程确保账本仅在交易被相应参与者批准时更新，并且当账本更新时，它们以相同的顺序更新相同的交易。</p>
<p><strong>区块链的不同</strong>：一套在网络上建立身份，执行交易和存储数据的标准方法。资产来源可以通过查看交易列表来确定，此列表一旦写入，无法更改，因此可信任。</p>
<p>Hyperledger Fabric 与其他区块链系统不同的地方是 <strong>私有</strong> 和 <strong>许可</strong> 。与允许未知身份参与网络的开放式非许可系统（需要诸如“工作量证明”之类的协议来验证交易并保护网络）不同，Hyperledger Fabric 网络的成员需要从可信赖的 <strong>成员服务提供者（MSP）</strong> 注册。</p>
<p>Hyperledger Fabric 还提供创建 <strong>通道</strong> 的功能，允许一组参与者创建各自的交易账本。对于某些网络而言，这是一个特别重要的选择。这些网络中，一些参与者可能是竞争对手，并且不希望他们做出的每笔交易都被每个参与者知晓，例如，他们只向某些参与者提供的特殊价格，而其他人不是。如果两个参与者组成一个通道，那么只有这两个参与者拥有该通道的账本副本，而其他参与者没有。</p>
<p><strong>智能合约</strong>：Hyperledger Fabric 智能合约用 <strong>链码</strong> 编写，当该应用程序需要与账本交互时，由区块链外部的应用程序调用。在大多数情况下，链码只与账本的数据库、世界状态（例如，查询）交互，而不与交易日志交互。</p>
<p>Hyperledger Fabric 支持私有网络（使用通道）是很重要的，因为<strong>网络是相对开放的。</strong></p>
<p><strong>共识</strong>：交易必须按照发生的顺序写入账本，即使它们可能位于网络中不同的参与者集合之中。为此，必须建立交易的顺序，且必须采用一种方法来拒绝错误（或恶意）插入到账本中的非法交易。</p>
<p>这是一个彻底的计算机科学研究领域，且有很多方法可以实现它，每个方法都有不同的权衡。例如，PBFT（实用拜占庭容错算法）可以为文件副本提供一种机制，使其能够保持各个副本的一致性，即使在发生损坏的情况下也是如此。或者，在比特币中，通过称为挖矿的过程进行排序，其中竞争计算机竞相解决加密难题，该难题定义所有过程随后构建的顺序。</p>
<p>Hyperledger Fabric 被设计为允许网络启动者选择最能代表参与者间存在的关系的共识机制。与隐私一样，有一系列需求；从他们的关系高度结构化的网络，到更加点对点的网络。</p>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://hyperledger-fabric.readthedocs.io/en/latest/whatis.html">项目文档[1]</a></p>
<h1 id="Hyperledger-Fabric平台搭建笔记"><a href="#Hyperledger-Fabric平台搭建笔记" class="headerlink" title="Hyperledger Fabric平台搭建笔记"></a>Hyperledger Fabric平台搭建笔记</h1><h2 id="centos7-9系统的安装和基础配置"><a href="#centos7-9系统的安装和基础配置" class="headerlink" title="centos7.9系统的安装和基础配置"></a>centos7.9系统的安装和基础配置</h2><ol>
<li>记得选择语言，汉语，这是在安装界面可以看到的。ps：选错语言的话酒删了重装吧。</li>
<li>记得选择磁盘位置</li>
<li><strong>记得连接网络</strong>，很重要！！！ps：如果在有图形的安装界面不进行勾选的话 ，之后再更改配置会十分的困难。</li>
<li>记得勾选基本的安装包。ps：如果不勾选的话一些基本的yum或者tar指令都无法使用。但是也不要选择太多的包，不然有可能会和自己安装的服务产生冲突。</li>
<li>然后进行安装即可。ps：这样进行的安装是没有图形界面的。</li>
</ol>
<p>如何更换字体和字号：</p>
<ol>
<li>进入/lib/kbd/consolefonts，选择合适的字体。</li>
<li>输入setfont指令，后面跟上字体的名称。</li>
<li>输入<code>echo &#39;setfont latarcyrheb-sun32&#39; &gt;&gt; /etc/profile</code>指令将字体设置设为开机启动。</li>
</ol>
<p>wget的安装：</p>
<ol>
<li>刚开始安装好的centos系统是没有wget的，需要用yum安装。</li>
<li><strong>yum -y install wget</strong></li>
</ol>
<h2 id="Go语言安装"><a href="#Go语言安装" class="headerlink" title="Go语言安装"></a>Go语言安装</h2><ol start="2">
<li><p>Go语言安装</p>
<p>从官网下载最新的linux-amd64.tar.gz压缩包（这里是go1.15.6.linux-amd64.tar.gz）</p>
<pre><code>wget https://golang.google.cn/dl/go1.15.6.linux-amd64.tar.gz
</code></pre>
<p>将其解压到/usr/local目录下：</p>
<pre><code>sudo tar -C /usr/local -zxf [压缩包名]
</code></pre>
</li>
<li><p>配置环境变量，在/etc/profile文件的末尾加入（在加入之前创建/home/gopath目录）</p>
<pre><code>export GOPATH=/home/gopath
export PATH=$PATH:/usr/local/go/bin
</code></pre>
</li>
<li><p>配置中国的代理</p>
<pre><code>go env -w GO111MODULE=on
go env -w GOPROXY=https://goproxy.cn,direct
</code></pre>
</li>
<li><p>查看是否配置成功</p>
<pre><code>go env
</code></pre>
</li>
</ol>
<h3 id="mwget安装"><a href="#mwget安装" class="headerlink" title="mwget安装"></a>mwget安装</h3><p>wget太慢使用mwget</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">wget</span> http://jaist.dl.sourceforge.net/project/kmphpfm/mwget/0.1/mwget_0.1.0.orig.tar.bz2
yum <span class="token function">install</span> <span class="token function">bzip2</span> gcc-c++ openssl-devel intltool -y
<span class="token function">bzip2</span> -d mwget_0.1.0.orig.tar.bz2
<span class="token function">tar</span> -xvf mwget_0.1.0.orig.tar 
<span class="token function">cd</span> mwget_0.1.0.orig
./configure 
<span class="token function">make</span>
<span class="token function">make</span> <span class="token function">install</span>　　<span class="token keyword">echo</span> <span class="token string">"至此，安装完成"</span>
% 断点续传
<span class="token function">wget</span> -c 要下载的文件，实现断点续传。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h3 id="最后的配置工作"><a href="#最后的配置工作" class="headerlink" title="最后的配置工作"></a>最后的配置工作</h3><p>生成身份材料</p>
<ol>
<li><p>进入BasicNetwork-2.0/artifacts/channel目录，执行</p>
<pre><code>./create-artifacts.sh
</code></pre>
</li>
<li><p>进入BasicNetwork-2.0/artifacts目录执行</p>
<pre><code>./docker-compose up -d
</code></pre>
</li>
<li><p>进入BasicNetwork-2.0</p>
<pre><code>./createChannel.sh
</code></pre>
</li>
</ol>
<p>智能合约部署</p>
<ol>
<li>进入BasicNetwork-2.0/artifacts/src/github.com/fabcar/go/目录下，执行（为智能合约安装依赖）</li>
</ol>
<pre><code>GO111MODULE=on go mod vendor
</code></pre>
<ol start="2">
<li>进入BasicNetwork-2.0/，执行智能合约的部署和测试在执行<code>deployChaincode.sh</code>之前，按以下命令修改文件夹的权限</li>
</ol>
<pre><code>sudo chmod 777 /home/gopath/*
</code></pre>
<ol start="3">
<li>开始部署</li>
</ol>
<pre><code>./deployChaincode.sh
</code></pre>
<p>部署explorer</p>
<ol>
<li><p>启动Explorer, 进入ContainerisingBlockchainExplorer目录下</p>
<pre><code>docker-compose up -d
</code></pre>
</li>
</ol>
<p>服务全部启动成功，可以在windows上查看相关的服务。</p>
<p><strong>注意：</strong>hyperledge Fabric搭建完成后将虚拟机挂起后再重新开启并不能恢复所有的服务，需要重新开启一遍。</p>
<h3 id="平台使用"><a href="#平台使用" class="headerlink" title="平台使用"></a>平台使用</h3><p>查看可视化的区块链信息，访问：</p>
<pre><code>[ip地址]:8080
</code></pre>
<p>查看产的最新状态，访问：</p>
<pre><code>[ip地址]:5984/_utils
</code></pre>
<h3 id="常用操作"><a href="#常用操作" class="headerlink" title="常用操作"></a>常用操作</h3><p>超级账本的下载地址：</p>
<pre class="line-numbers language-bash"><code class="language-bash"><span class="token function">wget</span> -c https://github.com/hyperledger/fabric/releases/download/v2.2.1/hyperledger-fabric-linux-amd64-2.2.1.tar.gz
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>超级账本的解压缩：</p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo tar -C ./ -zxf hyperledger-fabric-linux-amd64-2.2.1.tar.gz
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>超级账本的bin目录内的东西放到/usr/local/bin下</p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo mv ./bin/* /usr/local/bin
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>把BasicNetwork-2.0/artifacts/channel下的crypto-config拷贝到ContainerisingBlockExplorer下</p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo mv BasicNetwork-2.0/artifacts/channel/crypto-config ContainerisingBlockchainExplorer
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>在ContainerisingBlockchainExplorer下创建data和walletstore文件夹</p>
<pre class="line-numbers language-shell"><code class="language-shell">sudo mkdir data
sudo mkdir walletstore
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
<p>查看Centos的ip（看en33那个ip）</p>
<pre class="line-numbers language-shell"><code class="language-shell">ip add
<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>
<p>启动docker服务</p>
<pre><code>systemctl restart docker.service
</code></pre>
<p>关闭所有运行着的docker容器</p>
<pre><code>docker rm -f $(docker ps -a -q)
</code></pre>
<p>tips:</p>
<pre><code>注意go的版本
</code></pre>
<p>参考资料：</p>
<p><a target="_blank" rel="noopener" href="https://detail.yinxiang.com/index.html?guid=1d093d10-a21e-4640-852e-87fc4d68456c&loginName=%E5%8E%BB%E6%9C%88%E7%90%83&token=undefined&at=false&platformType=1&deviceinfo=%7B%22application%22:%22android_miniapp%22,%22applicationVersion%22:%221.1.20%22,%22platform%22:%22microsoft%22,%22platformVersion%22:%22Windows%2010%20x64%22,%22locale%22:%22zh_CN%22%7D&unionId=6e4d7dd0b0996a216344dce0b7edc6d9&userId=33691989&sessionId=003vny0w36jQEW2ofd0w3ju6IV2vny0O&channelId=wx75425a38a3ed6402">实验平台在服务器上的基于脚本的自动化部署[1]</a></p>
<p><a target="_blank" rel="noopener" href="https://detail.yinxiang.com/index.html?guid=91104fed-4f7d-481e-9ac2-8008b8d2fff3&loginName=%E5%8E%BB%E6%9C%88%E7%90%83&token=undefined&at=false&platformType=1&deviceinfo=%7B%22application%22:%22android_miniapp%22,%22applicationVersion%22:%221.1.20%22,%22platform%22:%22microsoft%22,%22platformVersion%22:%22Windows%2010%20x64%22,%22locale%22:%22zh_CN%22%7D&unionId=6e4d7dd0b0996a216344dce0b7edc6d9&userId=33691989&sessionId=043YQkll27EWj74Kggll2454aR2YQkl0&channelId=wx75425a38a3ed6402">区块链实验平台部署[2]</a></p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-06-18T07:40:57.000Z" title="2021/6/18 下午3:40:57">2021-06-18</time>发表</span><span class="level-item"><time dateTime="2021-09-08T04:15:12.971Z" title="2021/9/8 下午12:15:12">2021-09-08</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">34 分钟读完 (大约5120个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/51347">MySql数据库入门</a></h1><div class="content"><h1 id="MySql数据库SQL语言学习"><a href="#MySql数据库SQL语言学习" class="headerlink" title="MySql数据库SQL语言学习"></a>MySql数据库SQL语言学习</h1><h2 id="Create命令"><a href="#Create命令" class="headerlink" title="Create命令"></a>Create命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#创建一个数据库
create database [database_name]; 

#创建一个表
create table [table_name] (
    <列名> <数据类型>[ <列级完整性约束条件> ]
 [，<列名> <数据类型>[ <列级完整性约束条件>] ] …
 [，<表级完整性约束条件> ] 
); 

#创建一个视图
create view <视图名>  [(<列名>  [，<列名>]…)]
as
select [查询内容]
[WITH  CHECK  OPTION]；
/*
子查询不允许含有 order by 和 distinct 语句。
视图只是一个表结构，不储存数据。
使用视图和使用表的语法基本相同。
WITH CHECK OPTION 语句使得插入操作只能插入满足视图的限制条件的元组。
*/

#创建登录用户 
create user [user_name] identified by [user_password]
#创建一个普通用户

#创建数据库角色
create role 'R1';
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20210522162824.png"></p>
<h2 id="Grant-命令"><a href="#Grant-命令" class="headerlink" title="Grant 命令"></a>Grant 命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#授予某个用户权限
Grant <权限>[,<权限>]...
[on <对象类型> <对象名>] #对象可以是一个表或者是一个视图，或者是一个数据库
to <用户>[,<用户>]
with grant option.

#with grant option子句表示该权限可以进行传播，否则不能。
#grant权限时可以用all表示所有的权限，或者也可以是select等具体的权限。
#在进行授权的时候可以具体到某一个列比如说: Grant update(cname) on ...
#to的后面也可是一个角色。

#将某个角色授予某个用户
Grant 'role_name' to [user_name];
#这样可以批量修改一类用户的权限。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Revoke命令"><a href="#Revoke命令" class="headerlink" title="Revoke命令"></a>Revoke命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#收回某个用户的权限
Revoke <权限>[,<权限>]...
[on<对象类型><对象名>]
From <用户>[,<用户>]...

#Revoke权限时可以用all表示收回所有的权限，或者也可以是select等具体的权限。
#From的后面也可是一个角色。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Alter命令"><a href="#Alter命令" class="headerlink" title="Alter命令"></a>Alter命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#Alter命令是在建好表后修改表结构时使用的语句。
alter table [table_name] 
add [column_name] [数据类型] [完整性约束] 
#在表中添加一个新列
alter table [table_name] 
add foreign key([column_name]) references [table_name]([column_name])
#在表中添加一外键
alter table [table_name] 
modify column [column_name] <数据类型> [完整性约束]；
#修改表中的一列
alter table [table_name] drop column [column_name]
#删除表中的一列
alter table [table_name] drop primary key;
#删除表的主键
alter table [table_name] drop foreign key [key_name];
#删除表的一个外键
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Drop命令"><a href="#Drop命令" class="headerlink" title="Drop命令"></a>Drop命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#Drop命令是删除表或者数据库结构时使用的语句。
drop database [database_name]; # 删除一个数据库
drop table [table_name]; # 删除一个数据库中的表
#注意：如果有外键，不能删除表，应该先删除外键或者先删除外键连接的表。

#删除登录用户
drop user [user_name]
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<hr>
<h2 id="Insert命令"><a href="#Insert命令" class="headerlink" title="Insert命令"></a>Insert命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#插入一条元组
insert into [table_name]([column_name1], [column_name2] ...)
values([column_name1_value], [column_name2_value] ...);
#如果table_name后面属性列为空，则默认为定义表时的属性和顺序。
#在table_name后面的属性可以自定义顺序。
#插入的属性值可以是default, null或者具体的值。

#插入子查询的结果
insert into [table_name]([column_name1], [column_name2] ...)
select ...
from ...
where ...

#插入多条元组
insert into [table_name]([column_name1], [column_name2] ...)
values([column_name1_value], [column_name2_value] ...),
([column_name1_value], [column_name2_value] ...),
([column_name1_value], [column_name2_value] ...),
... ;
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Update命令"><a href="#Update命令" class="headerlink" title="Update命令"></a>Update命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#带子查询的修改语句（修改满足条件的元组）
update [table_name] set [column_name1] = [column_name1_value]，[column_name2] = [column_name2_value]，
where [column_name] = [column_name_value]
#在修改值时注意实体完整性和参照完整性。
#主码不允许修改，用户定义的完整性，NOT NULL约束，UNIQUE约束，值域约束
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Select命令"><a href="#Select命令" class="headerlink" title="Select命令"></a>Select命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#一个查询语句的基本结构
select [all/distinct]  
<目标列表达式1>, <目标列表达式2>,  ... 
from <table_name1>, <table_name2>, ...
where <条件表达式>
group by <column_name1>    having <条件表达式>
order by <column_name1> [asc/desc]    limit (num)

/*选择表中的若干列*/
#如果选中所有的属性列那么用*来表示
#DISTINCT关键词消除取值重复的行，如果没有指定，则缺省为ALL 
#如果要将属性列更名的话在需要更名的列后面加上 as 新名字
#在查询语句中还可以自定义表名，方法为 from [table_name] as [new_name]
#在定义别名的时候可以省略 as ，但是不建议。
#目标列表达式可以为：
/*
算术表达式    2016 - Sage
字符串常量    '出生年份：'
函数    year(curdate()) //表示当前的年份
列别名 sno as 学号
*/

/*
常用的查询条件:
比较运算符：=，>，<，>=，<=，!=，<>，!>，!<；
确定范围：
    BETWEEN <..> AND <..>，
    NOT BETWEEN <..> AND <..>
确定集合:
    IN(...)，
    NOT IN(...)
字符匹配：
    LIKE ''，
    NOT LIKE ''
通配符：
    % 任意长度的字符
    _ 一个长度的字符
    / 将后面紧跟的一个符号转义成正常符号
空值：
    IS NULL，
    IS NOT NULL
多重条件（逻辑运算）:
    AND，OR，NOT    
    可以用括号改变优先级
*/

/*ORDER BY子句*/
#可以按照一个或者多个属性进行排序
#升序：ASC；降序：DESC；缺省值为升序
#当排序列含空值时
#ASC：排序列为空值的元组最后显示
#DESC：排序列为空值的元组最先显示 
#e.g.    ORDER BY Grade DESC；
#e.g.    ORDER BY Sdept，Sage DESC； 
#limit后面跟的数字为输出表中的前几行。

/*自然连接*/
SELECT  Student.*，SC.*
FROM    Student，SC
WHERE   Student.Sno = SC.Sno；
#将student和sc表将sno相同的元组自然连接然后输出

/*聚集函数*/
#聚集函数：
/*
计数
    COUNT（[ DISTINCT | ALL ] *）
    COUNT（[ DISTINCT | ALL ] <列名>）//这两个值在all条件下是相等的
计算总和
    SUM（[ DISTINCT | ALL ] <列名>）    
计算平均值
    AVG（[ DISTINCT | ALL ] <列名>）
最大最小值
    MAX（[ DISTINCT | ALL ] <列名>）
    MIN（[ DISTINCT | ALL ] <列名>）
*/

/*GROUP BY子句*/
#细化聚集函数的作用对象
/*
 未对查询结果分组，聚集函数将作用于整个查询结果
 对查询结果分组后，聚集函数将分别作用于每个组 
 作用对象是查询的中间结果表
 按指定的一列或多列值分组，值相等的为一组
*/

/*Having子句*/
#Having短语作用于组，从中选择满足条件的组
#Where子句作用于基表或者视图，从中选择满足条件的元组

/*ORDER BY子句*/
#将结果进行排序之后再输出
/*
ASC 升序（小的在前面）
DESC 降序（大的在前面）
缺省为升序
order by 后面可以跟多个列名，按照顺序进行排序。
*/
#当排序存在空值时
/*
ASC 空值的元组最后显示
DESC 空值的元组最先显示
*/

/*limit子句*/
#只输出排序结果中的前num个元组。
#limit 3 的意思是输出前三行，limit 1,3 的意思是输出2道4行
#表中的元组的序号是从0开始的

/*Percent子句（！该知识点没有细讲，考试不考）*/
/*
select top <n> percent ...
from ...
where ...
表示输出前半分之n的数据，如果结果不够一条的话会向上取整为一条。
*/

/*into子句（！该知识点没有细讲，考试不考）*/
/*
select * into [table_name] 
from ...
where ...
表示将查询结果保存到table_name的表中。
*/
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Select查询进阶"><a href="#Select查询进阶" class="headerlink" title="Select查询进阶"></a>Select查询进阶</h2><pre class="line-numbers language-mysql"><code class="language-mysql">/*连接查询*/
#将两个表进行自然连接
select *
from A, b
where A.a = B.a;
#将三个表进行自然连接
select *
from A, B, C
where A.a = B.a and A.a = C.a;
#将一个表进行自身连接
select A.a, A.pa, B.pa
from table1 as A, table1 as B
where A.pa = B.a;
/*
[例35]查询每一门课的间接先修课（即先修课的先修课），输出：课程号、先修课的课程号、先修课的先修课的课程号。
*/
/*
SELECT  FIRST.Cno, FIRST.Cpno, SECOND.Cpno
FROM  Course As FIRST，Course As SECOND
WHERE FIRST.Cpno = SECOND.Cno；
*/
#两个表用inner join来写自然连接
select *
from A inner join B on (A.a = A.b)
where ...
#两个表用left outer join来写左外连接
select *
from A left outer join B on(A.a = B.a)
where ...
#两个表用right outer join来写右外连接
select *
from A right outer join B on(A.a = B.a)
where ...
#嵌套查询
/*将一个查询块嵌套在另一个查询块的WHERE子句或HAVING短语的条件中的查询称为嵌套查询*/
#不相关子查询
select *
from A 
where a in (
    select a
    from B
    where ...
);
#相关子查询
select *
from A 
where a in (
    select a
    from B
    where A.b = B.b and ... 
);
/*可以进行多层嵌套，当可以确定内层返回为单值的话，in可以用=或者<，>等代替。*/
#带有ANY和ALL谓词的子查询
select *
from A
where a >= ANY(
    select a
    from B
    where ...
);
/*ANY表示查询结果中的某个值，ALL表示查询结果中的所有值*/
#带有EXISTS谓词的子查询
/*存在谓词谓词的查询不返回任何数据，只产生逻辑真值或者逻辑假值，若内层查询为空则返回假，若内层查询为非空则返回为真。
EXISTS内层只要有结果，外层对应的记录就输出。
NOT EXISTS内层只要没有结果，外层就被输出。
*/
select *
from A
where exists (
    select *
    from B
    where ...
)
#集合查询：交并差查询
#Union, Intersect, Except。
/**/
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="Delete命令"><a href="#Delete命令" class="headerlink" title="Delete命令"></a>Delete命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">#带查询的删除（删除满足条件的元组）
delete 
from [table_name]
where ...
#where中的语句格式和select的where一样。
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="其他常用命令"><a href="#其他常用命令" class="headerlink" title="其他常用命令"></a>其他常用命令</h2><pre class="line-numbers language-mysql"><code class="language-mysql">show databases;
select database();
use [database_name];
DESC [table_name];#查看该表的结构
select user();#查看当前用户
select * from mysql.user #查看所有用户
#用户授权
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h2><pre class="line-numbers language-mysql"><code class="language-mysql">int
smallint
char([num])
varchar([num])#变长字符串
date
enum(a, b, ...) #枚举类型，值只能是枚举集合中的一个元素
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="常用约束条件"><a href="#常用约束条件" class="headerlink" title="常用约束条件"></a>常用约束条件</h2><pre class="line-numbers language-mysql"><code class="language-mysql">default [val] # 默认值
unique # 唯一性约束
not null # 非空值约束
primary key([column_name],...) # 主码约束
foreign key([column_name]) references [table_name]([column_name]) # 外键约束
chekc([条件])    # 用户定义
auto_increment # 序号自动加一
constraint [constraint_name] <限制条件> # 为后面的限制条件起一个名字
on delete 
    no action
    cascade
    set null
#在外键被参照的元组的属性进行删除时进行参照的元组的属性值的变化情况
on update 
    no action
    cascade 
    set null
#针对外键被参照的元组的属性进行更新值时进行参照的元组的属性值的变化情况
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="常用列函数"><a href="#常用列函数" class="headerlink" title="常用列函数"></a>常用列函数</h2><pre class="line-numbers language-mysql"><code class="language-mysql">Count()    #统计某一列的元组数量，某一列的Count运算结果和Count(*)的结果是相等的。
Sum()    
Avg()
Max()
Min()
<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h1 id="数据库考试复习笔记"><a href="#数据库考试复习笔记" class="headerlink" title="数据库考试复习笔记"></a>数据库考试复习笔记</h1><h2 id="知识点："><a href="#知识点：" class="headerlink" title="知识点："></a><strong>知识点</strong>：</h2><p>三类经典的数据模型是：1.层次模型，2.网状模型和3.关系模型。</p>
<p>数据库的保护措施有1.安全性控制，2.完整性控制，3.并发控制和4.数据库恢复等。</p>
<p>事务的四个性质是：1.原子性，2.一致性，3.隔离性，4.持久性。</p>
<p>并发控制的主要方法是封锁，封锁有两种类型：即1.排它锁（X锁，写锁），2.共享锁（S锁，读锁）。</p>
<p>故障恢复的基本手段有：1.数据转储，2.登记日志文件。</p>
<p>数据库设计的步骤有：1.需求分析，2.概念结构设计，3.逻辑结构设计，4.物理设计，5.数据库实施，6.数据库的运行和维护。</p>
<p>并发控制带来的三种数据不一致是：1.丢失数据，2.不可重复读，3.读脏数据。</p>
<p>数据模型的三要素：1.数据结构，2.数据操作和3.数据完整性。<br><strong>数据结构</strong>是对数据系统的<strong>静态特性</strong>的描述，<strong>数据操作</strong>是对数据库系统的<strong>动态特性</strong>的描述。</p>
<p>数据库系统的故障：1.系统故障，2.事务故障，3.介质故障，4.计算机病毒。</p>
<p>当局部E-R图合成为全局E-R图时，可能出现冲突：1.属性冲突，2.结构冲突，3.命名冲突。</p>
<p>传统的关系运算：1.交，2.并，3.差，4.笛卡尔积。</p>
<p>专门的关系运算：1.选择，2.投影，3.连接，4.除。</p>
<p>基本运算是：1、并，2、差，3、选择，4、投影，5、乘积（笛卡尔积）</p>
<p>数据库的完整性是指：1.正确性，2.相容性 ， 3.有效性。</p>
<p>一个关系模式的定义主要包括：1、关系名，2、属性名、3、属性类型、4、属性长度、5、关键字。</p>
<p>关系数据库中基于数学上两类运算是1、关系代数、2、关系演算。</p>
<p>数据库是长期存储在计算机内，有1.组织的，2.可共享的数据集合。</p>
<p>数据库管理系统的主要功能有1.数据定义功能，2.数据库的组织存储和管理，3.数据操纵功能，4.数据库的运行管理和5.数据库的建立及维护等。</p>
<p>SQL语言具有1、数据定义、2、数据操纵、3、数据控制的作用。</p>
<p>SQL语言具有两种使用方式，分别为1、交互式SQL和2、嵌入式SQL。</p>
<p><strong>参照完整性</strong>是指在基本表中，外码可以是1、<strong>空值</strong>或者2、<strong>另一个关系主码的有效值</strong>。</p>
<p>数据冗余可能导致的问题有：1、浪费存储空间及修改麻烦，2.潜在的数据不一致性。</p>
<p>安全性控制的一般方法有：1、用户标识鉴定、2、存取控制、3、审计、4、数据加密。</p>
<p>存取权限包括两方面的内容：1、要存取的数据对象，2、对数据对象进行操作的类型。</p>
<p>DBMS存取控制极值主要包括两部分：1、自主存取控制，2、强制存取控制。</p>
<p>在关系数据库规范化理论中，在执行分解时，必须遵守规范化原则：1、保持原有的依赖关系，和2、无损连接性。</p>
<h2 id="易错点："><a href="#易错点：" class="headerlink" title="易错点："></a><strong>易错点：</strong></h2><p>数据库在磁盘上的基本组织形式是<strong>文件</strong>。</p>
<p>数据库的概念模型独立于<strong>具体的机器和DBMS</strong>。</p>
<p><strong>数据库</strong>是存储在计算机内有结构的数据的集合。</p>
<p>在数据库中，产生数据不一致的根本原因是：<strong>数据冗余</strong>。</p>
<p>数据库系统的最大特点是：<strong>数据的三级模式和二级映像</strong>。</p>
<p>实体与之对应的数据库术语为<strong>记录</strong>。</p>
<p>层次模型不能直接表示<strong>多对多的关系</strong>。</p>
<p>数据库奠基人E.F从1970年起发表过多篇论文，主要论述的是<strong>关系数据模型</strong>。</p>
<p>关系运算中花费时间可能最长的运算是：<strong>除</strong></p>
<p>SQL语言是<strong>非过程化语言</strong>。</p>
<p>SQL是<strong>结构化查询语言</strong>。</p>
<p>在SQL sever 中删除触发器用 <strong>DROP</strong>。</p>
<p><strong>关系规范化理论</strong>是设计<strong>逻辑结构</strong>的指南和工具。</p>
<p>对于非规范化的模式，经过<strong>使属性域变为简单域</strong>转变为1NF，将1NF经过<strong>消除非主属性对主关键字的部分依赖</strong>转变为2NF，将2NF经过消除<strong>非主属性对主关键字的传递依赖</strong>转变为3NF。 </p>
<p><strong>数据流程图（DFD）</strong>是用于描述结构化方法中<strong>需求分析阶段</strong>的工具。</p>
<p>在数据库设计中，把数据需求携程文档，他是各类数据描述的集合，包括数据项，数据结构，数据流，数据存储和数据加工过程等的表述，通常称为<strong>数据字典</strong>。</p>
<p>若数据库中质保函成功事务提交的结果，则此数据库就称为处于<strong>一致</strong>状态。</p>
<p>数据库恢复是将数据库从<strong>错误</strong>状态恢复到<strong>某一已知正确的</strong>状态的功能。</p>
<p>数据库系统是利用存储在外村上其他地方的<strong>冗余数据</strong>来重建被破坏的数据库，他主要有两种：1.<strong>后援副本</strong>，2、<strong>日志文件</strong>。</p>
<p>死锁<strong>不是</strong>并发操作带来的<strong>数据不一致性</strong>的问题。</p>
<p>事务是用户定义的一个数据库操作序列。</p>
<h2 id="简答："><a href="#简答：" class="headerlink" title="简答："></a><strong>简答：</strong></h2><p><strong>试述视图的作用？</strong> </p>
<ol>
<li><p>视图能够简化用户的操作。（1 分） </p>
</li>
<li><p>视图使用户能以多种角度看待同一数据。（1 分） </p>
</li>
<li><p>视图对重构数据库提供了一定程度的逻辑独立性。（1 分） </p>
</li>
<li><p>视图能够对机密数据提供安全保护。（1 分） </p>
</li>
</ol>
<p><strong>登记日志文件时必须遵循什么原则？</strong><br>登记日志文件时必须遵循两条原则： </p>
<ol>
<li><p>登记的次序严格按并发事务执行的时间次序。（1 分） </p>
</li>
<li><p>必须先写日志文件，后写数据库。（2 分） </p>
</li>
</ol>
<p><strong>简述系统故障时的数据库恢复策略：</strong></p>
<ol>
<li>正像扫描日志文件，找出在故障发生前已经提交的事务，将其事务标识记入 REDO队列。同时找出故障发生时尚未完成的事务，将其事务标识记入 UNDO队列。</li>
<li>对 UNDO队列中的各个事务进行撤销处理。</li>
<li>对REDO队列中的各个事务进行重做处理。(错一个扣1.5分，全错不得分)</li>
</ol>
<p><strong>简述等值连接与自然连接的区别和联系：</strong></p>
<p>连接运算符是“=”的连接运算称为等值连接。它是从关系 R 与 S 的广 义笛卡尔积中选取 A，B 属性值相等的那些元组。自然连接是一种特殊的等值连接，它要求两个关系中进行比较的分量必须是相同的属性组，并且在结果中把重复的属性列去掉。                                           </p>
<p><strong>说明视图与基本表的区别和联系？</strong> </p>
<p>视图是从一个或几个基本表导出的表，它与基本表不同，是一个虚表，数据库中只存放视图的定义，而不存放视图对应的数据，这些数据存放在原来的基本表中，当基本表中的数据发生变化，从视图中查询出的数据也就随之改变。视图一经定义就可以像基本表一样被查询、删除，也可以在一个视图之上再定义新的视图，但是对视图的更新操作有限制</p>
<p><strong>简述事务的特性。</strong> </p>
<p>事务具有四个特性，即 ACID 特性：</p>
<ol>
<li><p>原子性：事务中包括的所有操作要么都做，要么都不做。 </p>
</li>
<li><p>一致性：事务必须使数据库从一个一致性状态变到另一个一致性状态。 </p>
</li>
<li><p>隔离性：一个事务内部的操作及使用的数据对并发的其他事务是隔离的。 </p>
</li>
<li><p>持续性：事务一旦提交，对数据库的改变是永久的。 </p>
</li>
</ol>
<p><strong>试述数据、数据库、数据库管理系统、数据库系统的概念。</strong> </p>
<p><strong>数据：</strong>描述事物的符号记录。（1 分）<br><strong>数据库：</strong>长期存储在计算机内的、有组织的、可共享的数据集合。（1 分）<br><strong>数据库管理系统：</strong>是位于用户与操作系统之间的具有数据定义、数据操纵、数据库的运行管理、数据库的建立和维护功能的一层数据管理软件。（1 分）<br><strong>数据库系统：</strong>在计算机系统中引入数据库后的系统，一般由数据库、数据库管理系统(及其开发工具)、应用系统、数据库管理员和用户构成。</p>
</div></article></div><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-03-05T03:07:04.000Z" title="2021/3/5 上午11:07:04">2021-03-05</time>发表</span><span class="level-item"><time dateTime="2021-10-17T16:41:22.825Z" title="2021/10/18 上午12:41:22">2021-10-18</time>更新</span><span class="level-item"><a class="link-muted" href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></span><span class="level-item">38 分钟读完 (大约5660个字)</span></div></div><h1 class="title is-3 is-size-4-mobile"><a class="link-muted" href="/11830">Linux系统操作入门</a></h1><div class="content"><h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h3 id="图形模式与文字模式的切换方式"><a href="#图形模式与文字模式的切换方式" class="headerlink" title="图形模式与文字模式的切换方式"></a>图形模式与文字模式的切换方式</h3><p>Linux预设提供了六个命令窗口终端机让我们来登录。</p>
<p>默认我们登录的就是第一个窗口，也就是tty1，这个六个窗口分别为tty1,tty2 … tty6，你可以按下Ctrl + Alt + F1 ~ F6 来切换它们。</p>
<p>如果你安装了图形界面，默认情况下是进入图形界面的，此时你就可以按Ctrl + Alt + F1 ~ F6来进入其中一个命令窗口界面。</p>
<p>当你进入命令窗口界面后再返回图形界面只要按下Ctrl + Alt + F7 就回来了。</p>
<h3 id="Linux-关机"><a href="#Linux-关机" class="headerlink" title="Linux 关机"></a>Linux 关机</h3><p>在linux领域内大多用在服务器上，很少遇到关机的操作。毕竟服务器上跑一个服务是永无止境的，除非特殊情况下，不得已才会关机。</p>
<p>正确的关机流程为：sync &gt; shutdown &gt; reboot &gt; halt</p>
<p>关机指令为：shutdown ，你可以man shutdown 来看一下帮助文档。</p>
<p>例如你可以运行如下命令关机：</p>
<pre><code>sync 将数据由内存同步到硬盘中。

shutdown 关机指令，你可以man shutdown 来看一下帮助文档。例如你可以运行如下命令关机：

shutdown –h 10 ‘This server will shutdown after 10 mins’ 这个命令告诉大家，计算机将在10分钟后关机，并且会显示在登陆用户的当前屏幕中。

shutdown –h now 立马关机

shutdown –h 20:25 系统会在今天20:25关机

shutdown –h +10 十分钟后关机

shutdown –r now 系统立马重启

shutdown –r +10 系统十分钟后重启

reboot 就是重启，等同于 shutdown –r now

halt 关闭系统，等同于shutdown –h now 和 poweroff
</code></pre>
<p>最后总结一下，不管是重启系统还是关闭系统，首先要运行 <strong>sync</strong> 命令，把内存中的数据写到磁盘中。</p>
<p>关机的命令有 <strong>shutdown –h now halt poweroff</strong> 和 <strong>init 0</strong> , 重启系统的命令有 <strong>shutdown –r now reboot init 6</strong>。</p>
<h3 id="处理目录的常用命令"><a href="#处理目录的常用命令" class="headerlink" title="处理目录的常用命令"></a>处理目录的常用命令</h3><p>接下来我们就来看几个常见的处理目录的命令吧：</p>
<ul>
<li>ls（英文全拼：list files）: 列出目录及文件名</li>
<li>cd（英文全拼：change directory）：切换目录</li>
<li>pwd（英文全拼：print work directory）：显示目前的目录</li>
<li>mkdir（英文全拼：make directory）：创建一个新的目录</li>
<li>rmdir（英文全拼：remove directory）：删除一个空的目录</li>
<li>cp（英文全拼：copy file）: 复制文件或目录</li>
<li>rm（英文全拼：remove）: 删除文件或目录</li>
<li>mv（英文全拼：move file）: 移动文件与目录，或修改文件与目录的名称</li>
</ul>
<p>你可以使用 <em>man [命令]</em> 来查看各个命令的使用文档，如 ：man cp。</p>
<h3 id="ls-列出目录"><a href="#ls-列出目录" class="headerlink" title="ls (列出目录)"></a>ls (列出目录)</h3><p>在Linux系统当中， ls 命令可能是最常被运行的。</p>
<p>语法：</p>
<pre><code>[root@www ~]# ls [-aAdfFhilnrRSt] 目录名称
[root@www ~]# ls [--color=&#123;never,auto,always&#125;] 目录名称
[root@www ~]# ls [--full-time] 目录名称
</code></pre>
<p>选项与参数：</p>
<ul>
<li>-a ：全部的文件，连同隐藏文件( 开头为 . 的文件) 一起列出来(常用)</li>
<li>-d ：仅列出目录本身，而不是列出目录内的文件数据(常用)</li>
<li>-l ：长数据串列出，包含文件的属性与权限等等数据；(常用)</li>
</ul>
<p>将家目录下的所有文件列出来(含属性与隐藏档)</p>
<pre><code>[root@www ~]# ls -al ~
</code></pre>
<h3 id="cd-切换目录"><a href="#cd-切换目录" class="headerlink" title="cd (切换目录)"></a>cd (切换目录)</h3><p>cd是Change Directory的缩写，这是用来变换工作目录的命令。</p>
<p>语法：</p>
<pre><code> cd [相对路径或绝对路径]
#使用 mkdir 命令创建 runoob 目录
[root@www ~]# mkdir runoob

#使用绝对路径切换到 runoob 目录
[root@www ~]# cd /root/runoob/

#使用相对路径切换到 runoob 目录
[root@www ~]# cd ./runoob/

# 表示回到自己的家目录，亦即是 /root 这个目录
[root@www runoob]# cd ~

# 表示去到目前的上一级目录，亦即是 /root 的上一级目录的意思；
[root@www ~]# cd ..
</code></pre>
<h3 id="pwd-显示目前所在的目录"><a href="#pwd-显示目前所在的目录" class="headerlink" title="pwd (显示目前所在的目录)"></a>pwd (显示目前所在的目录)</h3><p>pwd 是 <strong>Print Working Directory</strong> 的缩写，也就是显示目前所在目录的命令。</p>
<pre><code>[root@www ~]# pwd [-P]
</code></pre>
<p>选项与参数：</p>
<ul>
<li><strong>-P</strong> ：显示出确实的路径，而非使用连结 (link) 路径。</li>
</ul>
<p>实例：单纯显示出目前的工作目录：</p>
<pre><code>[root@www ~]# pwd
/root   &lt;== 显示出目录啦～
</code></pre>
<p>实例显示出实际的工作目录，而非连结档本身的目录名而已。</p>
<pre><code>[root@www ~]# cd /var/mail   &lt;==注意，/var/mail是一个连结档
[root@www mail]# pwd
/var/mail         &lt;==列出目前的工作目录
[root@www mail]# pwd -P
/var/spool/mail   &lt;==怎么回事？有没有加 -P 差很多～
[root@www mail]# ls -ld /var/mail
lrwxrwxrwx 1 root root 10 Sep  4 17:54 /var/mail -&gt; spool/mail
# 看到这里应该知道为啥了吧？因为 /var/mail 是连结档，连结到 /var/spool/mail 
# 所以，加上 pwd -P 的选项后，会不以连结档的数据显示，而是显示正确的完整路径啊！
</code></pre>
<h3 id="mkdir-创建新目录"><a href="#mkdir-创建新目录" class="headerlink" title="mkdir (创建新目录)"></a>mkdir (创建新目录)</h3><p>如果想要创建新的目录的话，那么就使用mkdir (make directory)吧。</p>
<p>语法：</p>
<pre><code>mkdir [-mp] 目录名称
</code></pre>
<p>选项与参数：</p>
<ul>
<li>-m ：配置文件的权限喔！直接配置，不需要看默认权限 (umask) 的脸色～</li>
<li>-p ：帮助你直接将所需要的目录(包含上一级目录)递归创建起来！</li>
</ul>
<p>实例：请到/tmp底下尝试创建数个新目录看看：</p>
<pre><code>[root@www ~]# cd /tmp
[root@www tmp]# mkdir test    &lt;==创建一名为 test 的新目录
[root@www tmp]# mkdir test1/test2/test3/test4
mkdir: cannot create directory `test1/test2/test3/test4&#39;: 
No such file or directory       &lt;== 没办法直接创建此目录啊！
[root@www tmp]# mkdir -p test1/test2/test3/test4
</code></pre>
<p>加了这个 -p 的选项，可以自行帮你创建多层目录！</p>
<p>实例：创建权限为 <strong>rwx–x–x</strong> 的目录。</p>
<pre><code>[root@www tmp]# mkdir -m 711 test2
[root@www tmp]# ls -l
drwxr-xr-x  3 root  root 4096 Jul 18 12:50 test
drwxr-xr-x  3 root  root 4096 Jul 18 12:53 test1
drwx--x--x  2 root  root 4096 Jul 18 12:54 test2
</code></pre>
<p>上面的权限部分，如果没有加上 -m 来强制配置属性，系统会使用默认属性。</p>
<p>如果我们使用 -m ，如上例我们给予 -m 711 来给予新的目录 drwx–x–x 的权限。</p>
<h3 id="rmdir-删除空的目录"><a href="#rmdir-删除空的目录" class="headerlink" title="rmdir (删除空的目录)"></a>rmdir (删除空的目录)</h3><p>语法：</p>
<pre><code> rmdir [-p] 目录名称
</code></pre>
<p>选项与参数：</p>
<ul>
<li><strong>-p ：</strong>连同上一级『空的』目录也一起删除</li>
</ul>
<p>删除 runoob 目录</p>
<pre><code>[root@www tmp]# rmdir runoob/
</code></pre>
<p>将 mkdir 实例中创建的目录(/tmp 底下)删除掉！</p>
<pre><code>[root@www tmp]# ls -l   &lt;==看看有多少目录存在？
drwxr-xr-x  3 root  root 4096 Jul 18 12:50 test
drwxr-xr-x  3 root  root 4096 Jul 18 12:53 test1
drwx--x--x  2 root  root 4096 Jul 18 12:54 test2
[root@www tmp]# rmdir test   &lt;==可直接删除掉，没问题
[root@www tmp]# rmdir test1  &lt;==因为尚有内容，所以无法删除！
rmdir: `test1&#39;: Directory not empty
[root@www tmp]# rmdir -p test1/test2/test3/test4
[root@www tmp]# ls -l        &lt;==您看看，底下的输出中test与test1不见了！
drwx--x--x  2 root  root 4096 Jul 18 12:54 test2
</code></pre>
<p>利用 -p 这个选项，立刻就可以将 test1/test2/test3/test4 一次删除。</p>
<p>不过要注意的是，这个 rmdir 仅能删除空的目录，你可以使用 rm 命令来删除非空目录。</p>
<h3 id="cp-复制文件或目录"><a href="#cp-复制文件或目录" class="headerlink" title="cp (复制文件或目录)"></a>cp (复制文件或目录)</h3><p>cp 即拷贝文件和目录。</p>
<p>语法:</p>
<pre><code>[root@www ~]# cp [-adfilprsu] 来源档(source) 目标档(destination)
[root@www ~]# cp [options] source1 source2 source3 .... directory
</code></pre>
<p>选项与参数：</p>
<ul>
<li><strong>-a：</strong>相当於 -pdr 的意思，至於 pdr 请参考下列说明；(常用)</li>
<li><strong>-d：</strong>若来源档为连结档的属性(link file)，则复制连结档属性而非文件本身；</li>
<li><strong>-f：</strong>为强制(force)的意思，若目标文件已经存在且无法开启，则移除后再尝试一次；</li>
<li><strong>-i：</strong>若目标档(destination)已经存在时，在覆盖时会先询问动作的进行(常用)</li>
<li><strong>-l：</strong>进行硬式连结(hard link)的连结档创建，而非复制文件本身；</li>
<li><strong>-p：</strong>连同文件的属性一起复制过去，而非使用默认属性(备份常用)；</li>
<li><strong>-r：</strong>递归持续复制，用於目录的复制行为；(常用)</li>
<li><strong>-s：</strong>复制成为符号连结档 (symbolic link)，亦即『捷径』文件；</li>
<li><strong>-u：</strong>若 destination 比 source 旧才升级 destination ！</li>
</ul>
<p>用 root 身份，将 root 目录下的 .bashrc 复制到 /tmp 下，并命名为 bashrc</p>
<pre><code>[root@www ~]# cp ~/.bashrc /tmp/bashrc
[root@www ~]# cp -i ~/.bashrc /tmp/bashrc
cp: overwrite `/tmp/bashrc&#39;? n  &lt;==n不覆盖，y为覆盖
</code></pre>
<h2 id="鸟哥的Linux私房菜"><a href="#鸟哥的Linux私房菜" class="headerlink" title="鸟哥的Linux私房菜"></a>鸟哥的Linux私房菜</h2><h3 id="第四章"><a href="#第四章" class="headerlink" title="第四章"></a>第四章</h3><p><a target="_blank" rel="noopener" href="http://linux.vbird.org/linux_basic/0160startlinux.php">文章链接</a></p>
<p><code>Ctrl + Shift + F1 ~ F6</code> 切换6个终端</p>
<p><code>date</code> 显示当前时间</p>
<p><code>locale</code> 显示当前支持的语系</p>
<p><code>cal</code> 显示日历</p>
<p>​    cal + 年份 显示该年份的日历</p>
<p><code>bc</code> 简单的计算器小程序</p>
<p>​    bc仅支持<code>+ - * / ^ %</code>运算</p>
<p><code>nano</code> 一个很简单的文本编辑程序，后面加上文件名即可进行编辑。</p>
<p><code>Ctrl + C</code> 强制退出</p>
<p><code>Ctrl + D</code> 表示EOF或者exit</p>
<p><code>Tab</code> 按两下自动补全</p>
<p><code>sync</code> 将内存中的内容转存在硬盘中</p>
<p>​    在关机之前记得多使用几次这个命令，防止内容的丢失</p>
<p><code>shutdown</code> 为关机指令</p>
<p><code>reboot</code> 为重启指令</p>
<h3 id="第五章"><a href="#第五章" class="headerlink" title="第五章"></a>第五章</h3><p><a target="_blank" rel="noopener" href="http://linux.vbird.org/linux_basic/0210filepermission.php">文章链接</a></p>
<p>用户分为自己，自己所在群组，其他人三种。</p>
<p><code>su -</code> 切换为root账户，密码为安装系统时创建的账户的密码</p>
<p><code>ls -al</code> 显示当前文件夹下的所有文件</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211015212423.gif" alt="文件的类型和权限" style="zoom: 150%;" />

<p>第一个字符可能为d，-，l，b，c。分别表示文件夹，文件，连接档（类似windows里面的快捷方式），周边设备（随机存储设备），键盘鼠标（一次性存储设备）</p>
<p>后面三个字母一组表示每类用户的权限，r表示可读，w表示可写，x表示可执行。三组分别为：拥有者，群组内成员，非本人且没有加入本群组之外的账户。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211015213139.png" alt="image-20211015213137627"></p>
<p>一串字母之后的一个数字是连接数，后面的两个分别是拥有者和拥有者所加入的群组。最后名字前面的是最后修改的时间，在前面一个数字是该文件的大小bytes。</p>
<p>如果一个目录d的权限没有x的话就不能进入该目录。</p>
<p>root无视所有的规则。</p>
<p><code>ls - l</code> 查看最近修改的记录</p>
<p><code>chgrp</code> 更改指定文件的群组。<code>e.g.  chgrp users test.txt</code></p>
<p><code>chown</code> 更改指定文件的拥有者，<code>e.g.  chown bin test.txt</code> <code>e.g.  chown root:root test.txt</code></p>
<p><code>cp</code> 对指定文件进行拷贝。<code>e.g.  cp test.txt test2.txt</code></p>
<p><code>chmod</code> 更改文件的权限，r的权限对应的值是4，w是2，x是1，对于每个类型的用户的权限就是这些权值相加。<code>e.g.  chmod 777 test.txt</code></p>
<p>​    很巧妙的是，这个值唯一对应一种权限的组合。</p>
<p><code>chmod</code> 的另一种方法<code>e.g.  chmod u=rwx,go=rx test.txt</code> u表示拥有者，g表示群组，o表示其他人，a表示所有类型。</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211015215930.png" alt="image-20211015215928404" style="zoom:80%;" />

<p>文件是否能执行和后缀名无关，和是否有x的权限有关。文件的w权限是指可以修改文件的内容，但是<strong>不包括删除该文件</strong>。</p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211016110358.png" alt="image-20211016110356855" style="zoom:80%;" />

<p>在有w权限的文件夹下是可以删除没有w权限的文件。</p>
<p>常见的后缀名有：<code>*.sh</code>表示为脚本或者批处理文件，<code>*Z *.tar *.tar.gz *.zip *.tgz</code>表示压缩包文件 <code>*.html *.php</code>表示网络相关的文件。文件是否可以执行和后缀名没有关系，只和这个文件的x权限有关。</p>
<p>Linux的文件系统依据：FHS</p>
<p>网页中有一些关于Linux根目录下目录的主要含义的解释。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211016115124.jpeg" alt="目錄樹架構示意圖"></p>
<p>目录树的简单示意图。</p>
<p>绝对路径和相对路径：以根目录/开头的路径都是绝对路径，反之则为相对路径，相对路径是指当前所在路径的相对位置来定义的。</p>
<p><code>. ./</code>都表示当前目录 <code>.. ../</code>都表示上一级目录</p>
<p>使用 <code>uname -r</code> 查看核心版本</p>
<p>使用 <code>uname -a</code>  查看操作系统的版本</p>
<h3 id="第六章"><a href="#第六章" class="headerlink" title="第六章"></a>第六章</h3><p><a target="_blank" rel="noopener" href="http://linux.vbird.org/linux_basic/0220filemanager.php#umask">文章链接</a></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211016204945.png" alt="image-20211016204944202"></p>
<p>Linux中根目录中也有./和../目录，并且 ./ 目录和 ../目录是同一个目录。</p>
<p><code>cd</code> 表示切换目录。几个比较特殊的目录在上面的图片上都可以看出。</p>
<p><code>pwd</code>表示显示当前的目录。<code>pwd -P</code>表示显示文档的实际地址，对于一些快捷方式的地址会发生区别。</p>
<p><code>mkdir</code>表示建立一个新目录。<code>e.g. mkdir -p test1/test2/test3/test4</code>会依次建立目录 <code>e.g. mkdir -m711 test2</code>会建立一个test2目录并且权限为711。</p>
<p>​    一般情况下建立目录需要一层一层建立，加上-p选项可以将所有的目录都按照顺序依次建立起来，而且如果本来目录存在的情况下，系统不会提示错误信息。（不建议，如果出错很麻烦）。</p>
<p><code>rmdir</code>删除空目录。<code>e.g. rmdir -p test1/test2/test3/test4</code>该命令只能一层一层删除目录，加上-p可以一次性全部删除，该命令删除的目录中必须不能有别的文档或者目录，如果想要带里面的文件一起删除的话可以使用<code>rm -r test</code>命令来删除，（不过比较危险）。</p>
<p>输入<code>exit</code>或者按<code>Ctrl + D</code>可以退出已经登录的root账户</p>
<p><code>echo $PATH</code>可以显示当前用户的PATH路径都有哪些。在使用指令的时候会优先在PATH的路径下寻找可执行文件，如果有多个重名文件的话会优先使用先搜索到的文件。</p>
<p><code>PATH=&quot;$&#123;PATH&#125;:/root&quot;</code>可以将/root加入到PATH路径中。</p>
<p>​    为了安全起见不要将 <code>.</code> 加入PATH中。</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211016235321.png" alt="image-20211016235319366"></p>
<p>在Bash Shell中<code>ls -l</code> 可以简写为<code>ll</code></p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017010303.png" alt="image-20211017002404054"></p>
<p><code>cp</code>表示copy，即对文件进行复制和粘贴。</p>
<p>​    其中<code>-i</code>选项表示如果出现覆盖先进行询问。<code>-a</code>表示复制的文件的群组和时间都和原文件一样。<code>-l</code>表示创建一个实体链接。<code>-s</code>表示创建一个符号链接，即产生了源文件的一个捷径。<code>-d</code>表示如果复制的文件为一个捷径文件的话复制该捷径，因为cp直接复制一个捷径的话会复制源文件。cp指令可以将多个资料一次复制到一个目录中去，但是最前面一定是目录。</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017004952.png" alt="image-20211017004951502"></p>
<p><code>rm</code>表示remove，即移除目录或者文档。</p>
<p>​    其中大部分的发行版Linux都默认rm带上了<code>-i</code>参数，<code>-r</code>很危险，同时不要将文件起名为<code>-aaa-</code>这种类型，因为如果这时想要删除这个文件的时候，就会报错，因为会优先检测出-a这个选项，所以文件起名一般不要用-开头。</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017010309.png" alt="image-20211017005614342"></p>
<p><code>mv</code>表示move，即移动文件或者目录。</p>
<p>​    可以使用mv来对一个文件进行更名的操作。</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017103831.png" alt="image-20211017103829397"></p>
<p><code>cat</code>用来显示文档内的内容。<code>-n</code>选项用来带行号输出，<code>-A</code>用来显示所有的特殊字符和正常字符。</p>
<p><code>tac</code>是<code>cat</code>命令的反着输出的版本，从最后一行到第一行输出。</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017105325.png" alt="image-20211017105321632"></p>
<p><code>nl</code>命令用来带行号输出文件的内容。<code>-b a</code>选项用来将空白行也带上行号。<code>-b a -n rz</code>用来将空白行带上行号之后再前面补零。<code>-b a -n rz -w 3</code>用来将空白行带上行号之后再前面补零,并且规定零加上数字一共宽度为三。</p>
<hr>
<p><code>more</code>命令用来可以翻页的查看一个文档。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017105910.png" alt="image-20211017105909332"></p>
<p>进入more一个文档之后的一些操作如上图。对文档内的字符串进行/查找之后按n查看下一个查找到的字符串。</p>
<hr>
<p><code>less</code>命令也是可以翻页查看一个文档，功能比<code>more</code>更加的强大。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017110549.png" alt="image-20211017110548332"></p>
<hr>
<p><code>head</code>命令用来取出前面的几行。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017110913.png" alt="image-20211017110912050"></p>
<p>在不加上<code>-n</code>选项的时候默认输出一个文件的前10行，加上<code>-n</code>选项可以自定义输出文件的前几行，值得注意的是，如果<code>-n</code>后面跟的是一个负数，表示的是这些行不输出，比如<code>-n -100</code>表示前100行不输出，从100行之后的所有行全部输出。</p>
<hr>
<p><code>tail</code>命令用来取出文件的后面几行。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017111633.png" alt="image-20211017111631255"></p>
<p><code>-n</code>的使用和head大致相同，一个比较好玩的是 <code>-n +100</code>表示100行之后的所有行都输出。<code>-f</code>选项用来持续检测这个文件，如果一个文件一直在进行写入操作，那么会持续的输出这个文件新加入的行，直到按下<code>Ctrl + C</code>后结束检测。</p>
<p><code>head</code>和<code>tail</code>的组合使用可以输出11 ~ 20 行：<code>head -n 20 /etc/man_db.conf | tail -n 10</code> |表示将前面执行的结果交给后面接着执行。</p>
<p>在上面的基础上再加上<code>cat</code>可以输出正确的11~20行的行号：<code>cat -n /etc/man_db.conf | head -n 20 | tail -n 10</code></p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017112449.png" alt="image-20211017112447936"></p>
<p><code>od</code>命令是针对那些非文字文档的一个命令。</p>
<p>对于一些 data file 或者 binary file 可以使用od命令使这些文件以ASCII码的形式输出出来。</p>
<p>我们可以利用这个命令来对已有的字符串输出对应的八进制ASCII码：<code>echo password | od -t oCc</code></p>
<hr>
<p>使用<code>ls</code>的<code>--time</code>选项来查看每个文件的不同类型的时间。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017113821.png" alt="image-20211017113820032"></p>
<hr>
<p>使用<code>touch</code>命令可以：1.建立一个空白的文档。2.将一个文档的时间修改为某一个特定的时间。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017230601.png" alt="image-20211017230559922"></p>
<hr>
<p><code>umask</code>命令可以查看当前用户创建的文档或者目录的预设权限。</p>
<p>输入<code>umask</code>输出的一串数字从第二个到第四个分别表示user，group，other三种用户被拿掉的权限的权值的和。比如4表示读，2表示写，5表示读和执行。</p>
<p>命令<code>umask 002</code>表示将该用户创建文件的预设权限设置为仅为other的用户不能写。</p>
<p>一般root用户将umask设置为022，因为是出于安全的考虑。</p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017231927.png" alt="image-20211017231924941"></p>
<p><code>chattr</code>命令表示设置文件或者目录的隐藏属性</p>
<p><code>chattr +i attrtest</code>表示给attrtest文件加上锁定的隐藏属性，用<code>chattr -i attrtest</code>来取消该隐藏属性。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017232436.png" alt="image-20211017232430627"></p>
<p><code>lsattr</code>命令用来查看一个文件或者目录的隐藏属性。</p>
<hr>
<p><code>SUID</code>（Set UID）是一个特殊的权限，可以让非root用户暂时使用root命令。</p>
<p>SUID是在原本user的x权限的位置上标为s，此时权限表示为SUID。</p>
<p>下图为SUID的限制于功能：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017234510.png" alt="image-20211017234508661"></p>
<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017234118.gif" alt="SUID程式執行的過程示意圖" style="zoom:150%;" />

<p>而且需要注意的是SUID只可以用在binary program上，并不能用于shell script。</p>
<hr>
<p><code>SGID</code>（Set GID）是指在群组的x权限的位置上标为s的一个权限。</p>
<p>SGID对于可执行文件的限制于功能为下图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017234550.png" alt="image-20211017234547632"></p>
<p>SGID对于目录的限制于功能为下图：</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017234901.png" alt="image-20211017234859979"></p>
<hr>
<p><code>SBIT</code> 只能对目录有作用。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017235237.png" alt="image-20211017235236377"></p>
<hr>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211017235342.png" alt="image-20211017235339098"></p>
<p>4，2, 1分别表示这三个隐藏权限的权值。在chmod的第一个值中表示该文件的隐藏权限属性值。使用：<code>chmod 4755 test</code>可以设置test的隐藏权限。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018000052.png" alt="image-20211018000050678"></p>
<p>上图是使用文字的方式添加文件的隐藏属性。</p>
<hr>
<p><code>fail</code>命令来查看改文件的基本资料，是ASCII文件还是date文件或者可执行文件的一些细节。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018000449.png" alt="image-20211018000446377"></p>
<hr>
<p><code>which</code>命令用来寻找命令的完整路径。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018004118.png" alt="image-20211018000810656"></p>
<p>which会根据PATH的路径来依次寻找命令所在的地址。</p>
<hr>
<p><code>whereis</code>命令是用于在一些特定目录中寻找档案名。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018001139.png" alt="image-20211018001136304"></p>
<hr>
<p><code>locate</code>命令用来通过关键字在自建的数据库中搜索带有该关键字的文件。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018001931.png" alt="image-20211018001928696"></p>
<p>locate使用的是由<code>已建立的資料庫 /var/lib/mlocate/</code>里面的资料所搜到的，该数据库默认每天更新一次，所以如果没有更新的话就可能搜索不到，这时就可以进行手动更新。</p>
<p><code>updatedb</code>命令会搜索硬盘中的文档的名称并且更新资料库中的档案。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018002300.png" alt="image-20211018002257338"></p>
<hr>
<p><code>find</code>命令用来查找文件。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018002629.png" alt="image-20211018002626749"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018002649.png" alt="image-20211018002647603"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018002837.png" alt="image-20211018002835439"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018003329.png" alt="image-20211018003328825"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018003431.png" alt="image-20211018003429378"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20211018003715.png" alt="image-20211018003714199"></p>
</div></article></div><nav class="pagination" role="navigation" aria-label="pagination"><div class="pagination-previous is-invisible is-hidden-mobile"><a href="/categories/%E6%8A%80%E6%9C%AF/page/0/">上一页</a></div><div class="pagination-next"><a href="/categories/%E6%8A%80%E6%9C%AF/page/2/">下一页</a></div><ul class="pagination-list is-hidden-mobile"><li><a class="pagination-link is-current" href="/categories/%E6%8A%80%E6%9C%AF/">1</a></li><li><a class="pagination-link" href="/categories/%E6%8A%80%E6%9C%AF/page/2/">2</a></li></ul></nav></div><div class="column column-left is-4-tablet is-4-desktop is-3-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar" src="/img/touxiang.jpg" alt="Dicemy"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Dicemy</p><p class="is-size-6 is-block">一只想要躺平的菜鸡</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>中国 · 开封</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">文章</p><a href="/archives"><p class="title">37</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">分类</p><a href="/categories"><p class="title">4</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">标签</p><a href="/tags"><p class="title">18</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/Dicemy" target="_blank" rel="noopener">关注我</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/Dicemy"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="QQ" href="tencent://message/?uin=1583925267"><i class="fab fa-qq"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Bilibili" href="https://space.bilibili.com/16023197"><i class="fas fa-tv"></i></a></div></div></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">链接</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">归档</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2022/01/"><span class="level-start"><span class="level-item">一月 2022</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/12/"><span class="level-start"><span class="level-item">十二月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/11/"><span class="level-start"><span class="level-item">十一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/08/"><span class="level-start"><span class="level-item">八月 2021</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/07/"><span class="level-start"><span class="level-item">七月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/06/"><span class="level-start"><span class="level-item">六月 2021</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/05/"><span class="level-start"><span class="level-item">五月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/04/"><span class="level-start"><span class="level-item">四月 2021</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/03/"><span class="level-start"><span class="level-item">三月 2021</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/02/"><span class="level-start"><span class="level-item">二月 2021</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2021/01/"><span class="level-start"><span class="level-item">一月 2021</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/12/"><span class="level-start"><span class="level-item">十二月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/archives/2020/10/"><span class="level-start"><span class="level-item">十月 2020</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">标签</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/DP/"><span class="tag">DP</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Hyperledger/"><span class="tag">Hyperledger</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/JAVA/"><span class="tag">JAVA</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Linux/"><span class="tag">Linux</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/fabric/"><span class="tag">fabric</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/"><span class="tag">乘法逆元</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/"><span class="tag">博弈论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%8F%8C%E7%AB%AF%E9%98%9F%E5%88%97/"><span class="tag">双端队列</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/"><span class="tag">学习笔记</span><span class="tag">3</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%80%9D%E8%80%83%E9%A2%98/"><span class="tag">思考题</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%90%9C%E7%B4%A2/"><span class="tag">搜索</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/"><span class="tag">数据库</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%95%B0%E8%AE%BA/"><span class="tag">数论</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB/"><span class="tag">文档阅读</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/"><span class="tag">方法总结</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/"><span class="tag">最小生成树</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/"><span class="tag">组合数学</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/"><span class="tag">赛后总结</span><span class="tag">9</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">订阅更新</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="订阅"></div></div></form></div></div></div><div class="column-right-shadow is-hidden-widescreen"></div></div><div class="column column-right is-4-tablet is-4-desktop is-3-widescreen is-hidden-touch is-hidden-desktop-only order-3"><!--!--><div class="card widget" data-type="categories"><div class="card-content"><div class="menu"><h3 class="menu-label">分类</h3><ul class="menu-list"><li><a class="level is-mobile" href="/categories/%E6%8A%80%E6%9C%AF/"><span class="level-start"><span class="level-item">技术</span></span><span class="level-end"><span class="level-item tag">12</span></span></a></li><li><a class="level is-mobile" href="/categories/%E6%96%87%E5%8C%96%E8%AF%BE/"><span class="level-start"><span class="level-item">文化课</span></span><span class="level-end"><span class="level-item tag">5</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%94%9F%E6%B4%BB/"><span class="level-start"><span class="level-item">生活</span></span><span class="level-end"><span class="level-item tag">1</span></span></a></li><li><a class="level is-mobile" href="/categories/%E7%AB%9E%E8%B5%9B/"><span class="level-start"><span class="level-item">竞赛</span></span><span class="level-end"><span class="level-item tag">17</span></span></a></li></ul></div></div></div><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">最新文章</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-08T10:08:35.000Z">2022-01-08</time></p><p class="title"><a href="/23955">fabric开发入门</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-07T09:39:21.000Z">2022-01-07</time></p><p class="title"><a href="/63228">树莓派入门</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-07T09:39:07.000Z">2022-01-07</time></p><p class="title"><a href="/21062">Python入门</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-07T09:38:50.000Z">2022-01-07</time></p><p class="title"><a href="/10811">git入门</a></p><p class="categories"><a href="/categories/%E6%8A%80%E6%9C%AF/">技术</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2022-01-04T08:01:41.000Z">2022-01-04</time></p><p class="title"><a href="/12732">离散数学复习</a></p><p class="categories"><a href="/categories/%E6%96%87%E5%8C%96%E8%AF%BE/">文化课</a></p></div></article></div></div><div class="card widget" data-type="adsense"><div class="card-content"><div class="menu"><h3 class="menu-label">广告</h3><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script><ins class="adsbygoogle" style="display:block" data-ad-client="ca-pub-6426911790858772" data-ad-slot="1877755546" data-ad-format="auto" data-full-width-responsive="true"></ins><script>(adsbygoogle = window.adsbygoogle || []).push({});</script></div></div></div></div></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/biaoti.png" alt="TobinMEng 的博客" height="28"></a><p class="is-size-7"><span>&copy; 2022 TobinMEng</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="知识共享" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="CC BY-NC 4.0" href="https://creativecommons.org/licenses/by-nc/4.0/deed.zh"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/Dicemy"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdnjs.loli.net/ajax/libs/jquery/3.3.1/jquery.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/moment.js/2.22.2/moment-with-locales.min.js"></script><script src="https://cdnjs.loli.net/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="回到顶端" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdnjs.loli.net/ajax/libs/cookieconsent/3.1.1/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "此网站使用Cookie来改善您的体验。",
          dismiss: "知道了！",
          allow: "允许使用Cookie",
          deny: "拒绝",
          link: "了解更多",
          policy: "Cookie政策",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdnjs.loli.net/ajax/libs/lightgallery/1.10.0/js/lightgallery.min.js" defer></script><script src="https://cdnjs.loli.net/ajax/libs/justifiedGallery/3.8.1/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="想要查找什么..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"想要查找什么...","untitled":"(无标题)","posts":"文章","pages":"页面","categories":"分类","tags":"标签"});
        });</script></body></html>