<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta 
    name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta 
    http-equiv="X-UA-Compatible" 
    content="ie=edge">
  <meta 
    name="theme-color" 
    content="#fff" 
    id="theme-color">
  <meta 
    name="description" 
    content="月光照着月光,月光普照">
  <link 
    rel="icon" 
    href="/img/biaoti.png">
  <title>fabric开发入门</title>
  
    
      <meta 
        property="og:title" 
        content="fabric开发入门">
    
    
      <meta 
        property="og:url" 
        content="https://dicemy.com/23955.html">
    
    
      <meta 
        property="og:img" 
        content="/img/touxiang.jpg">
    
    
      <meta 
        property="og:img" 
        content="月光照着月光,月光普照">
    
    
      <meta 
        property="og:type" 
        content="article">
      <meta 
        property="og:article:published_time" 
        content="2022-01-08">
      <meta 
        property="og:article:modified_time" 
        content="2022-01-18">
      <meta 
        property="og:article:author" 
        content="Dicemy">
      
        
          <meta 
            property="og:article:tag" 
            content="Hyperledger">
        
          <meta 
            property="og:article:tag" 
            content="fabric">
        
      
    
  
  <script>
    function loadScript(url, cb) {
      var script = document.createElement('script');
      script.src = url;
      if (cb) script.onload = cb;
      script.async = true;
      document.body.appendChild(script);
    }
    function loadCSS(href, data, attr) {
      var sheet = document.createElement('link');
      sheet.ref = 'stylesheet';
      sheet.href = href;
      sheet.dataset[data] = attr;
      document.head.appendChild(sheet);
    }
    function changeCSS(cssFile, data, attr) {
      var oldlink = document.querySelector(data);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("href", cssFile);
      newlink.dataset.prism = attr;
      document.head.replaceChild(newlink, oldlink);
    }
  </script>
  
    
  
  <script>
    // control reverse button
    var reverseDarkList = {
      dark: 'light',
      light: 'dark'
    };
    var themeColor = {
      dark: '#1c1c1e',
      light: '#fff'
    }
    // get the data of css prefers-color-scheme
    var getCssMediaQuery = function() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };
    // reverse current darkmode setting function
    var reverseDarkModeSetting = function() {
      var setting = localStorage.getItem('user-color-scheme');
      if(reverseDarkList[setting]) {
        setting = reverseDarkList[setting];
      } else if(setting === null) {
        setting = reverseDarkList[getCssMediaQuery()];
      } else {
        return;
      }
      localStorage.setItem('user-color-scheme', setting);
      return setting;
    };
    // apply current darkmode setting
  </script>
  
    <script>
      var setDarkmode = function(mode) {
      var setting = mode || localStorage.getItem('user-color-scheme');
      if(setting === getCssMediaQuery()) {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
      } else if(reverseDarkList[setting]) {
        document.documentElement.setAttribute('data-user-color-scheme', setting);
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
      } else {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[getCssMediaQuery()];
        document.getElementById('theme-color').dataset.mode = getCssMediaQuery();
      }
    };
    setDarkmode();
    </script>
  
  
  <link rel="preload" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" as="style" >
  <link rel="preload" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.js" as="script">
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lozad.min.js" as="script">
  
  
  
  
    
    <link rel="prefetch" href="//cdn.jsdelivr.net/npm/mathjax@3.0.5/es5/tex-svg.js" as="script">
  
  
    
    <link rel="prefetch" href="//unpkg.com/valine/dist/Valine.min.js" as="script">
  
  
  
  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css">
  
    <link rel="stylesheet" href="/js/lib/lightbox/baguetteBox.min.css">
  
<!-- hexo injector head_end start -->
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css">

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css">
<!-- hexo injector head_end end --><meta name="generator" content="Hexo 5.4.0"><link rel="stylesheet" href="/css/prism.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

  <body>
    <div class="wrapper">
       
      <nav class="navbar">
  <div class="navbar-logo">
    <span class="navbar-logo-main">
      
        <img 
          class="navbar-logo-img"
          width="32"
          height="32"
          src="/img/biaoti.png" 
          alt="blog logo">
      
      <span class="navbar-logo-dsc">Dicemy 的博客</span>
    </span>
  </div>
  <div class="navbar-menu">
    
      <a 
        href="/" 
        class="navbar-menu-item">
        
          首页
        
      </a>
    
      <a 
        href="/archives" 
        class="navbar-menu-item">
        
          归档
        
      </a>
    
      <a 
        href="/tags" 
        class="navbar-menu-item">
        
          标签
        
      </a>
    
      <a 
        href="/categories" 
        class="navbar-menu-item">
        
          分类
        
      </a>
    
      <a 
        href="/about" 
        class="navbar-menu-item">
        
          关于
        
      </a>
    
      <a 
        href="/links" 
        class="navbar-menu-item">
        
          友链
        
      </a>
    
    <a 
      class="navbar-menu-item darknavbar" 
      id="dark">
      <i class="iconfont icon-weather"></i>
    </a>
    <a 
      class="navbar-menu-item searchnavbar" 
      id="search">
      <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i>
    </a>
  </div>
</nav> 
      
      <div 
        id="local-search" 
        style="display: none">
        <input
          class="navbar-menu-item"
          id="search-input"
          placeholder="请输入搜索内容..." />
        <div id="search-content"></div>
      </div>
      
      <div class="section-wrap">
        <div class="container">
          <div class="columns">
            <main class="main-column">
<article class="card card-content">
  <header>
    <h1 class="post-title">
      fabric开发入门
    </h1>
  </header>
  <div class="post-meta post-show-meta">
    <time datetime="2022-01-08T10:08:35.000Z">
      <i 
        class="iconfont icon-calendar" 
        style="margin-right: 2px;">
      </i>
      <span>2022-01-08</span>
    </time>
    
      <span class="dot"></span>
      
        <a 
          href="/categories/%E6%8A%80%E6%9C%AF/" 
          class="post-meta-link">
          技术
        </a>
      
    
    
      <span class="dot"></span>
      <span>4.5k 字</span>
    
  </div>
  
    <div 
      class="post-meta post-show-meta" 
      style="margin-top: -10px;">
      <div style="display: flex; align-items: center;">
        <i 
          class="iconfont icon-biaoqian" 
          style="margin-right: 2px; font-size: 1.15rem;">
        </i>
        
          
          <a 
            href="/tags/Hyperledger/" 
            class="post-meta-link">
            Hyperledger
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/fabric/" 
            class="post-meta-link">
            fabric
          </a>
        
      </div>
    </div>
  
  </header>
  <div 
    id="section" 
    class="post-content">
    <p>注意：不要在有生产环境的服务器上进行该学习的部署，血的教训（关闭服务的时候服务器上的docker都被杀掉了，青龙平台直接没了。。。）</p>
<h1 id="环境配置"><a href="#环境配置" class="headerlink" title="环境配置"></a>环境配置</h1><h2 id="目录结构"><a href="#目录结构" class="headerlink" title="目录结构"></a>目录结构</h2><p>在gopath中创建</p>
<blockquote>
<p>mkdir src</p>
<p>mkdir bin</p>
<p>mkdir pkg</p>
</blockquote>
<p>在src中创建<code>mkdir github.com</code></p>
<p>在github.com中创建<code>mkdir hyperledger</code></p>
<h2 id="docker安装"><a href="#docker安装" class="headerlink" title="docker安装"></a>docker安装</h2><p>一行命令，完成安装：（安装之后记得要把docker服务启动起来）</p>
<blockquote>
<p>curl -sSL <a target="_blank" rel="noopener" href="https://get.daocloud.io/docker">https://get.daocloud.io/docker</a> | sh</p>
<p>service docker start </p>
</blockquote>
<p>而且源在国内</p>
<h2 id="docker-compose安装"><a href="#docker-compose安装" class="headerlink" title="docker-compose安装"></a>docker-compose安装</h2><p>通过curl进行安装：</p>
<blockquote>
<p><code>curl -L https://github.com/docker/compose/releases/download/1.7.0/docker-compose-``uname -s ``-``uname -m`` &gt; /usr/local/bin/docker-compose</code></p>
<p><code>chmod +x /usr/local/bin/docker-compose</code></p>
<p><code>docker-compose -v</code></p>
</blockquote>
<h2 id="go安装与配置"><a href="#go安装与配置" class="headerlink" title="go安装与配置"></a>go安装与配置</h2><p>参考：<a href="http://dicemy.com/29920#Go%E8%AF%AD%E8%A8%80%E5%AE%89%E8%A3%85">http://dicemy.com/29920#Go%E8%AF%AD%E8%A8%80%E5%AE%89%E8%A3%85</a></p>
<p>一定要注意环境变量的配置</p>
<h2 id="jdk安装"><a href="#jdk安装" class="headerlink" title="jdk安装"></a>jdk安装</h2><blockquote>
<p>yum list java*</p>
<p>yum install -y java-1.8.0-openjdk-devel.x86_64    </p>
<p>java -version</p>
</blockquote>
<h2 id="下载fabric的docker镜像"><a href="#下载fabric的docker镜像" class="headerlink" title="下载fabric的docker镜像"></a>下载fabric的docker镜像</h2><p>除了baseos下载0.3.1，其余都下1.0.0，然后标记为latest</p>
<blockquote>
<p>tools：docker pull hyperledger/fabric-tools:x86_64-1.0.0</p>
<p>ccenv：docker pull hyperledger/fabric-ccenv:x86_64-1.0.0</p>
<p>ca：docker pull hyperledger/fabric-ca:x86_64-1.0.0</p>
<p>orderer：docker pull hyperledger/fabric-orderer:x86_64-1.0.0</p>
<p>peer：docker pull hyperledger/fabric-peer:x86_64-1.0.0</p>
<p>baseos：docker pull hyperledger/fabric-baseos:x86_64-0.3.1</p>
</blockquote>
<p>纯命令版：</p>
<blockquote>
<p>docker pull hyperledger/fabric-tools:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-ccenv:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-ca:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-orderer:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-peer:x86_64-1.0.0</p>
<p>docker pull hyperledger/fabric-baseos:x86_64-0.3.1</p>
</blockquote>
<p>注意：记得在所有的安装之后进行tag 编辑成latest状态否则会出现问题</p>
<p><code>docker tag xxxx xxxx:latest</code></p>
<blockquote>
<p>docker tag hyperledger/fabric-tools:x86_64-1.0.0 hyperledger/fabric-tools:latest</p>
<p>docker tag hyperledger/fabric-ccenv:x86_64-1.0.0 hyperledger/fabric-ccenv:latest</p>
<p>docker tag hyperledger/fabric-ca:x86_64-1.0.0 hyperledger/fabric-ca:latest</p>
<p>docker tag hyperledger/fabric-orderer:x86_64-1.0.0 hyperledger/fabric-orderer:latest</p>
<p>docker tag hyperledger/fabric-peer:x86_64-1.0.0 hyperledger/fabric-peer:latest</p>
<p>docker tag hyperledger/fabric-baseos:x86_64-0.3.1 hyperledger/fabric-baseos:latest</p>
</blockquote>
<h2 id="下载fabric源码库"><a href="#下载fabric源码库" class="headerlink" title="下载fabric源码库"></a>下载fabric源码库</h2><p>在hyperledger目录下进行<code>git clone https://github.com/hyperledger/fabric.git</code></p>
<p><code>git checkout release-1.0</code></p>
<p><code>cd /home/gopath/src/github.com/hyperledger/fabric/common/configtx/tool/configtxgen</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108181212.png" alt="image-20220108181210078" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108181212.png" class="lozad post-image"></p>
<h3 id="对工具进行编译。"><a href="#对工具进行编译。" class="headerlink" title="对工具进行编译。"></a>对工具进行编译。</h3><p><code>go install --tags=nopkcs11</code></p>
<blockquote>
<p>注意！！！</p>
<p>奇怪的错误请输入：go env -w GO111MODULE=auto</p>
<p>一定要把这个项目文件的src放在go环境设置下的gopath的文件夹中，输入go env可以查看go安装环境中的gopath文件夹。否则会出现找不到包的报错。</p>
</blockquote>
<h3 id="对另一个工具进行编译。"><a href="#对另一个工具进行编译。" class="headerlink" title="对另一个工具进行编译。"></a>对另一个工具进行编译。</h3><p><code>cd /home/gopath/src/github.com/hyperledger/fabric/common/tools/cryptogen</code></p>
<p><code>go install --tags=nopkcs11</code></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108183050.png" alt="image-20220108183049804" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108183050.png" class="lozad post-image"></p>
<h3 id="编译好的工具如下"><a href="#编译好的工具如下" class="headerlink" title="编译好的工具如下:"></a>编译好的工具如下:</h3><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108183258.png" alt="image-20220108183258043" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108183258.png" class="lozad post-image"></p>
<h2 id="下载fabric-samples"><a href="#下载fabric-samples" class="headerlink" title="下载fabric-samples"></a>下载fabric-samples</h2><p><code>cd /home/gopath/src/github.com/hyperledger</code></p>
<p><code>git clone https://github.com/hyperledger/fabric-samples.git</code></p>
<p><code>git checkout release-1.0</code></p>
<h1 id="Hello-World"><a href="#Hello-World" class="headerlink" title="Hello World"></a>Hello World</h1><h2 id="1-查看目录"><a href="#1-查看目录" class="headerlink" title="1.查看目录"></a>1.查看目录</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108185207.png" alt="image-20220108185207083" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108185207.png" class="lozad post-image"></p>
<p>.env：存储一些环境变量</p>
<p>base：储存docker-compose的一些公共服务</p>
<p>byfn.sh：执行脚本</p>
<p>configtx.yaml和crypto-config.yaml：根据之前生成的2个工具，生成相应的配置文件，用来启动网络，放到当前目录的channel-artifacts和crypto-config里面</p>
<p>docker-compose：用于启动网络</p>
<p>scripts：存放测试脚本，做的事：创建通道，加入通道，安装链码，实例化链码，链码交互</p>
<h2 id="2-生成配置"><a href="#2-生成配置" class="headerlink" title="2.生成配置"></a>2.生成配置</h2><p><code>./byfn.sh -m generate -i 1.0.0</code></p>
<blockquote>
<p>注意！！！！</p>
<p>一定要记得吧gopath中的bin目录添加到环境变量中，否则可能无法调用刚才编译好的configtxgen和cryptogen工具</p>
<p>可以通过 export PATH=$PATH:/home/gopath/bin 来临时添加或者使用vim ~/.bash_profile修改PATH 一行，之后使用source ~/.bash_profile生效。</p>
</blockquote>
<h2 id="3-启动网络，自动运行测试脚本"><a href="#3-启动网络，自动运行测试脚本" class="headerlink" title="3.启动网络，自动运行测试脚本"></a>3.启动网络，自动运行测试脚本</h2><p><code>./byfn.sh -m up -i 1.0.0</code></p>
<h2 id="4-关闭网络，自动清楚配置和docker进程"><a href="#4-关闭网络，自动清楚配置和docker进程" class="headerlink" title="4.关闭网络，自动清楚配置和docker进程"></a>4.关闭网络，自动清楚配置和docker进程</h2><p><code>./byfn.sh -m down -i 1.0.0</code></p>
<h1 id="Hello-World-分析"><a href="#Hello-World-分析" class="headerlink" title="Hello World 分析"></a>Hello World 分析</h1><h2 id="1-查看日志，order和peer分离"><a href="#1-查看日志，order和peer分离" class="headerlink" title="1.查看日志，order和peer分离"></a>1.查看日志，order和peer分离</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108200634.png" alt="image-20220108200633311" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108200634.png" class="lozad post-image"></p>
<p>peer是按照组织或主体分离的，每一个组织生成ca（存储证书和私钥），msp（存储管理员证书和中间证书），peers（存储每一个peer相关的证书），users（存储每一个用户的证书）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108200948.png" alt="image-20220108200946765" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108200948.png" class="lozad post-image"></p>
<h2 id="2-查看如下配置"><a href="#2-查看如下配置" class="headerlink" title="2.查看如下配置"></a>2.查看如下配置</h2><p>genesis.block：整个网络的创世区块</p>
<p>channel.tx：创建的通道的配置</p>
<p>Org1MSPanchors.tx和Org2MSPanchors.tx：两个主体的锚节点配置</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108201328.png" alt="image-20220108201327506" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108201328.png" class="lozad post-image"></p>
<h2 id="3-启动网络，接着分析日志"><a href="#3-启动网络，接着分析日志" class="headerlink" title="3.启动网络，接着分析日志"></a>3.启动网络，接着分析日志</h2><p>fabric网络启动完毕</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203247.png" alt="image-20220108203245854" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203247.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203353.png" alt="image-20220108203352910" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203353.png" class="lozad post-image"></p>
<p>指定通道名称，和一些变量，通道创建完成</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203443.png" alt="image-20220108203442675" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203443.png" class="lozad post-image"></p>
<p>4个peer加入通道</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203605.png" alt="image-20220108203604430" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203605.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203646.png" alt="image-20220108203646097" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203646.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203654.png" alt="image-20220108203653472" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203654.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203700.png" alt="image-20220108203659999" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203700.png" class="lozad post-image"></p>
<p>组织中的锚节点在通道中update成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203742.png" alt="image-20220108203742026" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203742.png" class="lozad post-image"></p>
<img src="https:/ srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203742.png" class="lozad post-image"/cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203742.png"/>

<p>链码安装到了peer节点</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203904.png" alt="image-20220108203903845" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203904.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203931.png" alt="image-20220108203930729" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203931.png" class="lozad post-image"></p>
<p>链码实例化</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203952.png" alt="image-20220108203951359" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108203952.png" class="lozad post-image"></p>
<p>在peer0上进行查询操作，成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204015.png" alt="image-20220108204015033" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204015.png" class="lozad post-image"></p>
<p>圈圈的是查询结果，查询成功，查询结果为100</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204137.png" alt="image-20220108204136547" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204137.png" class="lozad post-image"></p>
<p>进行修改操作，成功</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204241.png" alt="image-20220108204241010" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204241.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204349.png" alt="image-20220108204348218" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204349.png" class="lozad post-image"></p>
<p>再次查询，结果为90</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204508.png" alt="image-20220108204508197" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204508.png" class="lozad post-image"></p>
<p>查看docker进程</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109165719.png" alt="image-20220108204613817" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109165719.png" class="lozad post-image"></p>
<p>3个链码会生成3个image</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204746.png" alt="image-20220108204745898" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108204746.png" class="lozad post-image"></p>
<p>查看脚本</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205435.png" alt="image-20220108205434573" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205435.png" class="lozad post-image"></p>
<p>可以按脚本中的位置找到链码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205512.png" alt="image-20220108205511945" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205512.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205325.png" alt="image-20220108205320115" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108205325.png" class="lozad post-image"></p>
<p>实现了Init和Invoke接口，就代表是一个fabric智能合约</p>
<p>Init：首先获取参数，不为4个则报错，最终将A和B存到数据库中</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210007.png" alt="image-20220108210006159" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210007.png" class="lozad post-image"></p>
<p>Invoke：设置了3个方法，（invoke，delete，query）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210201.png" alt="image-20220108210200287" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210201.png" class="lozad post-image"></p>
<p>invoke：接受3个参数，（谁给谁转账，赚多少）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210300.png" alt="image-20220108210259542" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210300.png" class="lozad post-image"></p>
<p>A给B转账。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210352.png" alt="image-20220108210352036" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210352.png" class="lozad post-image"></p>
<p>持久化数据</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210442.png" alt="image-20220108210441191" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108210442.png" class="lozad post-image"></p>
<p>接受1个值，从数据库中删除</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211352.png" alt="image-20220108211350759" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211352.png" class="lozad post-image"></p>
<p>查询操作，结果以json形式返回</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211533.png" alt="image-20220108211532979" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211533.png" class="lozad post-image"></p>
<p>main里只start或者进行一些验证，不写其他代码</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211617.png" alt="image-20220108211616503" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211617.png" class="lozad post-image"></p>
<p>srcipts中：初始化操作，A有100元，B有200元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211813.png" alt="image-20220108211812427" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211813.png" class="lozad post-image"></p>
<p>查询A有多少钱，所以打印了100</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211920.png" alt="image-20220108211919875" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108211920.png" class="lozad post-image"></p>
<p>A给B转账10元</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108212005.png" alt="image-20220108212004943" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220108212005.png" class="lozad post-image"></p>
<h1 id="fabric系统架构"><a href="#fabric系统架构" class="headerlink" title="fabric系统架构"></a>fabric系统架构</h1><h2 id="架构图"><a href="#架构图" class="headerlink" title="架构图"></a>架构图</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109153233.png" alt="image-20220109153232452" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109153233.png" class="lozad post-image"></p>
<ul>
<li><p><strong>应用层</strong></p>
</li>
<li><p>API：提供了GRPC，（谷歌）RPC框架</p>
</li>
<li><p>SDK：在API基础上封装的SDK，go，java，python，nodejs</p>
</li>
<li><p>事件：分布式系统中，达成共识需要一定的时间，fabric使用异步通信模式开发，触发回调函数执行。</p>
</li>
<li><p>身份：依托于底层的成员服务，是联盟链的认证功能，例如CA</p>
</li>
<li><p>账本：区块链的查询数据，是账本中查出来的，区块高度+交易ID，不重复</p>
</li>
<li><p>交易：对区块链数据进行修改，先提交交易到背书节点，签名认证之后再执行。</p>
</li>
<li><p>智能合约：做合约的安装，实例化和升级</p>
</li>
<li><p><strong>区块链底层</strong></p>
</li>
<li><p>成员服务：提供证书，用于加密和签名</p>
</li>
<li><p>共识服务：CAP（不能全满足，只能满足2个，一致性，可用性和分区容忍性），实际上区块链是弱化了可用性和分区容忍性，所以需要共识算法保证一致性。fabric的共识大概分为三个阶段：</p>
<ul>
<li>首先客户端向背书节点发送一个背书提案，背书节点进行交易模拟，将背书节点和签名返回客户端。</li>
<li>然后将背书后的交易，交给排序节点进行排序。有排序节点生成区块，向全网广播。网络节点接受到广播后，先验证区块交易的正确性。</li>
<li>验证通过后，存入本地账本。</li>
<li>PS：排序节点与组织的锚节点使用的是GRPC通信，组织内使用的是gossip协议通信</li>
</ul>
</li>
<li><p>链码服务：提供安全的，可隔离的交易环境。所以fabric使用docker，链码直接与docker通信。目前阶段对k8s支持的不好，会出问题。</p>
</li>
<li><p>安全及密码服务：fabric定义了一个BCCSP接口，定义签名，加密解密功能，是默认实现了一套国际通用的密码服务，如sha256等</p>
</li>
</ul>
<h2 id="网络拓扑图"><a href="#网络拓扑图" class="headerlink" title="网络拓扑图"></a>网络拓扑图</h2><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109160034.png" alt="image-20220109160033781" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109160034.png" class="lozad post-image"></p>
<ul>
<li><strong>概念：</strong></li>
<li>客户端节点：应用程序和底层的交互媒介，与上层和peer和orderer连接发挥作用，连接peer做交易模拟</li>
<li>peer节点：包含了<strong>锚节点（主节点）</strong>，在一个组织内可以有多个peer，一个组织中锚节点只有一个，锚节点的作用（与orderer进行通信），锚节点需要HA支持，若锚节点挂了，组织内会选举新的节点与orderer节点进行通信，<strong>背书节点（Endorse）</strong>理解为担保，与智能合约绑定的，每一个智能合约安装到区块链中，会有一个专属的背书策略，<strong>记账节点（committer）</strong>所有的peer节点都是记账节点。用于验证从orderer接受的区块，验证交易的有效性，验证通过后，同步到本地账本。</li>
<li>orderer节点：排序节点，接受全网客户端节点的交易信息，按照一定规则进行排序，将排序好的交易，按照固定的时间间隔打包成区块。与其他组织的主节点进行通信，排序可以用solo（整个网络中只有一个排序节点，使用于开发和测试）和kafka（生产环境下使用，分布式消息队列）模式</li>
<li>CA节点：可选的，作用：颁发证书，只用被CA认证的节点才能进行交易，fabric不存在51%攻击问题。</li>
<li><strong>动作和行为：</strong></li>
<li>注册登记：与客户端发起，向CA机构表明自己的身份，获取证书，上图中是第三方的CA，也可以使用官方提供的CA。</li>
<li>交易提案：向组织的<strong>背书节点</strong>提交请求，对应peer节点，组织可以理解为现实中的商业主体，组织是独立的，有两个个数据来源。</li>
<li>提交交易：客户端节点向排序节点发请求，orderer内部进行排序打包成区块，广播给其他组织的锚节点，上图是基于kafka实现的，每个组织会选择一个orderer节点进行通信。</li>
</ul>
<h2 id="交易流程"><a href="#交易流程" class="headerlink" title="交易流程"></a>交易流程</h2><ul>
<li>客户端提交交易，最终到记账节点同步数据。</li>
</ul>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109163002.png" alt="image-20220109163001787" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109163002.png" class="lozad post-image"></p>
<ul>
<li>智能合约按照要指定背书节点，正常情况下，背书节点返回相同的结果，但签名是不一样的。</li>
<li>背书是模拟的过程，不会持久化</li>
<li>1,2,3是交易模拟，4,5,6是交易排序，7,8,9是交易同步和记账。交易模拟对应智能合约，交易排序对应共识机制，同步和记账对应账本存储</li>
</ul>
<h1 id="fabric共识排序"><a href="#fabric共识排序" class="headerlink" title="fabric共识排序"></a>fabric共识排序</h1><h2 id="共识机制"><a href="#共识机制" class="headerlink" title="共识机制"></a>共识机制</h2><ul>
<li>达成公式需要3个阶段，交易背书，交易排序，交易验证。</li>
<li>交易背书：模拟的</li>
<li>交易排序：确定交易顺序，最终将排序好的交易打包区块分发。</li>
<li>交易验证：区块储存前要进行一下交易验证（不是所有的orderer的东西都能存进去）</li>
</ul>
<h2 id="Orderer节点的作用"><a href="#Orderer节点的作用" class="headerlink" title="Orderer节点的作用"></a>Orderer节点的作用</h2><ul>
<li><p>交易排序</p>
<ul>
<li>目的：保证系统的最终一致性（有限状态机）</li>
<li>solo：单节点排序</li>
<li>kafka：外置的分布式消息队列</li>
</ul>
</li>
<li><p>区块分发：</p>
<ul>
<li>orderer中的区块并不是最终持久化的区块，</li>
<li>是一个中间状态的区块</li>
<li>包含了所有交易，不管是有有效还是无效，都会打包传给组织的锚节点。</li>
</ul>
</li>
<li><p>多通道的数据隔离</p>
<ul>
<li>客户端可以使用某个通道，发送交易</li>
<li><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109164753.png" alt="image-20220109164752553" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220109164753.png" class="lozad post-image"></li>
</ul>
</li>
</ul>
<h2 id="源码目录"><a href="#源码目录" class="headerlink" title="源码目录"></a>源码目录</h2><ul>
<li><p>从goland中阅读</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110134631.png" alt="image-20220110134628351" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110134631.png" class="lozad post-image"></p>
</li>
<li><p>源码目录</p>
<ul>
<li>bccsp：与密码学相关的，加密，数字签名，证书，将密码学中的函数抽象成了接口，方便调用和扩展</li>
<li>bddtests：行为驱动开发，从需求直接到开发</li>
<li>common：公共库，错误处理，日志处理，账本存贮，相关工具</li>
<li>core：是fabric核心库，子目录是各个模块的目录<ul>
<li>comm：网络通信相关</li>
</ul>
</li>
<li>devenv：官方提供的开发环境，使用的是Vagrant</li>
<li>docs：文档</li>
<li>events：事件监听机制</li>
<li>gossip：通信协议，组织内部的通信，区块同步</li>
<li>gotools：用于编译</li>
<li>images：docker镜像相关的</li>
<li>msp：成员服务管理，member serivce provider 读取证书做签名</li>
<li>orderer：排序节点</li>
<li>peer：peer节点</li>
<li>proposals：用于扩展，新功能的提案</li>
<li>protos：数据结构的定义</li>
</ul>
</li>
<li><p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110135049.png" alt="image-20220110135013312" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110135049.png" class="lozad post-image"></p>
</li>
</ul>
<h2 id="共识机制源码"><a href="#共识机制源码" class="headerlink" title="共识机制源码"></a>共识机制源码</h2><blockquote>
<p>如果使用goland查看源码时import全部标红的话，进入这个设置，将第一个Enable Go … 这个框勾掉即可。<img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110140311.png" alt="image-20220110140310255" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110140311.png" class="lozad post-image"></p>
</blockquote>
<ul>
<li><p>orderer节点的源码</p>
</li>
<li><p>首先看orderer目录下的main.go</p>
</li>
<li><p>main.go里有一个NewServer</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110145806.png" alt="image-20220110145805341" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110145806.png" class="lozad post-image"></p>
</li>
<li><p>从sever.go可以具体查看交易收集和广播区块</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110145855.png" alt="image-20220110145853957" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110145855.png" class="lozad post-image"></p>
</li>
<li><p>点击Manager，进入Manager.go查看源码（还在sever.go里）</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110150014.png" alt="image-20220110150005861" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110150014.png" class="lozad post-image"></p>
</li>
<li><p>点击chainsupport，查看（在manager.go中）<br><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110153610.png" alt="image-20220110153609457" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110153610.png" class="lozad post-image"></p>
</li>
<li><p>点receiver进去，看区块切割（在chainsupport.go中）<br><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110155258.png" alt="image-20220110155256319" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110155258.png" class="lozad post-image"></p>
</li>
</ul>
<h2 id="回顾共识机制源码"><a href="#回顾共识机制源码" class="headerlink" title="回顾共识机制源码"></a>回顾共识机制源码</h2><ul>
<li>main.go是入口，orderer节点的初始化</li>
<li>manager.go是控制中枢，是对链的操作，拿到chainsupport对象</li>
<li>chainsupport.go链对象额代理，与链式对应的关系</li>
<li>Cut（）方法是区块切割</li>
<li>solo和kafka相关的设置</li>
<li>sever.go有两个Handle，是交易收集和区块扩散的方法</li>
<li>将共识简化为了排序，最终一致性</li>
</ul>
<h1 id="fabric账本存储"><a href="#fabric账本存储" class="headerlink" title="fabric账本存储"></a>fabric账本存储</h1><h2 id="账本存储概念"><a href="#账本存储概念" class="headerlink" title="账本存储概念"></a>账本存储概念</h2><ul>
<li><p>peer节点做账本存储</p>
</li>
<li><p>orderer是临时存储区块，peer节点时账本存储的持久化，会改变世界状态。</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110163404.png" alt="image-20220110163210283" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220110163404.png" class="lozad post-image"></p>
</li>
<li><p>文件系统，区块是存储为文件</p>
</li>
<li><p>区块索引，用于查询区块，是用levelDB实现的</p>
</li>
<li><p>状态数据库，一般村存放区块链最新状态，数据不需要HA，可以从文件系统再次获取，couchDB支持模糊查询</p>
</li>
</ul>
<h2 id="交易读写集"><a href="#交易读写集" class="headerlink" title="交易读写集"></a>交易读写集</h2><ul>
<li><p>回忆交易流程</p>
<ul>
<li>交易模拟<ul>
<li>在背书节点执行模拟时，最终返回交易读写集（RWset），告诉区块链在交易中读写了哪些数据</li>
</ul>
</li>
<li>交易排序</li>
<li>交易验证，交易验证后，更新世界状态，更新的就是读写集中的写集</li>
</ul>
</li>
<li><p>交易读写集的3个概念</p>
<ul>
<li>读集：包含键的列表，键的提交版本，读取赌赢的值，返回的是已提交的状态的值（读已提交），不能读取交易过程中写入的数据。</li>
<li>写集：包含键的列表，写入的数据的值，如果多次写入，以最后一次为准。</li>
<li>版本号：用区块高度和交易编号组成的。</li>
</ul>
</li>
<li><p>交易验证阶段是对读写集进行验证（验证读集）</p>
<ul>
<li>验证读集的版本号是和否等于世界状态的版本号</li>
</ul>
</li>
</ul>
<h2 id="账本存储相关概念"><a href="#账本存储相关概念" class="headerlink" title="账本存储相关概念"></a>账本存储相关概念</h2><ul>
<li><p>世界状态</p>
<ul>
<li>交易执行后，所有键的最新值</li>
</ul>
</li>
<li><p>历史数据索引（可选）</p>
</li>
<li><p>区块储存</p>
<ul>
<li>按照文件去存 blockfile_xxxx</li>
<li>文件大小是64M，若修改，需要重新编译peer源码</li>
<li>账本最大容量64M*</li>
</ul>
</li>
<li><p>区块读取</p>
<ul>
<li>区块文件流</li>
<li>区块流</li>
<li>迭代器</li>
</ul>
</li>
<li><p>区块索引</p>
<ul>
<li>键：区块高度，区块哈希，交易哈希</li>
<li>值：区块文件编号，文件内的偏移量，区块数据的长度</li>
</ul>
</li>
<li><p>区块提交</p>
</li>
<li><p>保存到文件</p>
</li>
</ul>
<h2 id="账本存储相关源码"><a href="#账本存储相关源码" class="headerlink" title="账本存储相关源码"></a>账本存储相关源码</h2><ul>
<li>从4方面看，读写集，状态数据， 历史数据，区块文件</li>
<li>可以先从core/ledger 下的 ledger_interface.go 中看大体结构</li>
<li><strong>读写集</strong>，分为交易读写集的生成和交易读写集的验证两个部分去看。<ul>
<li>交易读写集生成<ul>
<li>fabric/core/ledger/kvledger/txmgmt/txmgr/lockbasedtxmgr/lockbased_tx_simulator.go</li>
</ul>
</li>
<li>交易读写集验证<ul>
<li>fabric/core/ledger/kvledger/txmgmt/validator/statebasedval/state_based_validator.go</li>
</ul>
</li>
</ul>
</li>
<li><strong>状态数据库</strong>：看levelDB的实现<ul>
<li>fabric/core/ledger/kvledger/txmgmt/statedb/stateleveldb/stateleveldb.go</li>
</ul>
</li>
<li><strong>历史数据库</strong>：看levelDB的实现<ul>
<li>fabric/core/ledger/kvledger/history/historydb/historyleveldb/historyleveldb.go</li>
</ul>
</li>
<li><strong>区块文件读取</strong><ul>
<li>fabric/common/ledger/blkstorage/fsblkstorage/fs_blockstore.go</li>
<li>区块流：fabric/common/ledger/blkstorage/fsblkstorage/block_stream.go</li>
</ul>
</li>
</ul>
<h2 id="账本存储相关源码总结"><a href="#账本存储相关源码总结" class="headerlink" title="账本存储相关源码总结"></a>账本存储相关源码总结</h2><ul>
<li>首先看了账本根存储的根目录的接口，从宏观上把握</li>
<li>交易读写集的生成和验证</li>
<li>数据库增删改查</li>
<li>要有一个没有实现的方法，数据剪裁的接口，可能去解决数据无限增长的处理</li>
</ul>
<h1 id="fabric智能合约"><a href="#fabric智能合约" class="headerlink" title="fabric智能合约"></a>fabric智能合约</h1><h2 id="智能合约"><a href="#智能合约" class="headerlink" title="智能合约"></a>智能合约</h2><ul>
<li><p>执行环境：以太坊虚拟智能合约执行环境EVM，fabric执行环境是docker</p>
</li>
<li><p>链码</p>
<ul>
<li>是应用层和区块链底层的中间点</li>
<li>每一个链码执行环境是一个独立的docker</li>
<li>使用GRPC协议与背书节点通讯，只有背书节点才能运行智能合约</li>
</ul>
</li>
<li><p>链码的生命周期</p>
<ul>
<li>打包，智能合约的编写和编译</li>
<li>安装，将打包好的文件，上传到背书节点</li>
<li>实例化，实际的安装了，执行Init方法，只执行一次，构造函数</li>
<li>升级，升级和修复链码</li>
<li>交互，自己定义的方法的调用</li>
</ul>
</li>
<li><p>链码的交互流程</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220111130908.png" alt="image-20220111130907628" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220111130908.png" class="lozad post-image"></p>
</li>
<li><p>系统链码（了解）</p>
<ul>
<li>LSCC：管理链码的生命周期</li>
<li>CSCC：配置管理链码，管理链的配置</li>
<li>QSCC：查询账本存储，是一个区块索引的外部服务</li>
<li>ESCC：交易背书的链码，交易执行后的链码进行封装签名，给客户端返回背书交易结果。</li>
<li>VSCC：交易验证的链码</li>
</ul>
</li>
<li><p>链码编程的接口</p>
<ul>
<li>Init()：链码初始化，只执行一次</li>
<li>Invoke()：链码的业务逻辑的编写</li>
<li>上面2个方法参数一样，参数是SDK的接口</li>
</ul>
</li>
<li><p>链码SDK的接口</p>
<ul>
<li>写代码再看</li>
</ul>
</li>
<li><p>一些注意点</p>
<ul>
<li>分布式多机多节点执行，链码会执行很多次</li>
<li>不写随机函数，交易会无效，多次执行不一样</li>
<li>系统时间不写，多机时间不一定一样</li>
</ul>
</li>
</ul>
<h2 id="网络搭建配置的实现"><a href="#网络搭建配置的实现" class="headerlink" title="网络搭建配置的实现"></a>网络搭建配置的实现</h2><ul>
<li><p><strong>crypto-config.yaml</strong>：用于配置组织节点的个数，参考firstnetwork去编写</p>
</li>
<li><p>编写好后，传到linux对应目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220111220422.png" alt="image-20220111220421700" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/20220111220422.png" class="lozad post-image"></p>
</li>
<li><p>进入deploy目录，设置工作目录为当前目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112316260.png" alt="image-20220111231610245" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112316260.png" class="lozad post-image"></p>
</li>
<li><p>指定按照yaml文件生成配置</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112318839.png" alt="image-20220111231835718" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112318839.png" class="lozad post-image"></p>
</li>
<li><p><strong>configtx.yaml</strong>：用于区块联盟中的组织信息，配合名字和证书等的位置，参考firstnetwork去编写</p>
</li>
<li><p>编写好后，传到linux对应目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112323346.png" alt="image-20220111220421700" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201112323346.png" class="lozad post-image"></p>
</li>
<li><p>创建用于存放配置的目录</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201121625352.png" alt="image-20220112162508038" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201121625352.png" class="lozad post-image"></p>
</li>
<li><p><strong>生成系统链的创世区块</strong></p>
</li>
<li><p>-profile 指定联盟配置，-outputBlock 指定存放的位置</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201121628296.png" alt="image-20220112162808968" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201121628296.png" class="lozad post-image"></p>
</li>
<li><p><strong>生成通道的创世交易</strong></p>
</li>
<li><p>profile 指定业务联盟，outputCreateChannelTx存放的路径，插件的名字叫做mychannel</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131517067.png" alt="image-20220113151701675" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131517067.png" class="lozad post-image"></p>
<blockquote>
<p>注意：如果使用虚拟机为平台的话，会出现用ssh连接执行命令执行出错的情况发生，具体原因不详，但是在虚拟机上可以正常执行并生成成功。</p>
</blockquote>
</li>
<li><p><strong>生成两个组织锚节点的交易信息</strong></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131532043.png" alt="image-20220113153247804" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131532043.png" class="lozad post-image"></p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131534780.png" alt="image-20220113153436463" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201131534780.png" class="lozad post-image"></p>
</li>
<li><p>将docker-compose.yaml拖进deploy目录</p>
<p><img src="C:/Users/aa/AppData/Roaming/Typora/typora-user-images/image-20220114165038705.png" alt="image-20220114165038705" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="C:/Users/aa/AppData/Roaming/Typora/typora-user-images/image-20220114165038705.png" class="lozad post-image"></p>
</li>
</ul>
<h2 id="启动网络"><a href="#启动网络" class="headerlink" title="启动网络"></a>启动网络</h2><ul>
<li><p>启动docker，后台运行</p>
<p><img src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201141811282.png" alt="image-20220114181144436" srcset="data:image/svg+xml,%3Csvg%20xmlns='http://www.w3.org/2000/svg'%20viewBox='0%200%20300%20300'%3E%3C/svg%3E" data-src="https://cdn.jsdelivr.net/gh/Dicemy/blog-img/202201141811282.png" class="lozad post-image"></p>
</li>
</ul>

  </div>
  <div>
    
      <div 
        class="post-note note-warning copyright" 
        style="margin-top: 42px">
        <p>
          <span style="font-weight: bold;">作者：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="/about">
            TobinMeng
          </a>
        </p>
        <p>
          <span style="font-weight: bold;">文章链接：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="https://dicemy.com/23955">
            https://dicemy.com/23955
          </a>
        </p>
        <p><span style="font-weight: bold;">版权声明：</span>本博客所有文章除特别声明外，均采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0 协议</a>。转载请注明出处！</p>
      </div>
    
  </div>
</article>
<div class="nav">
  
  
    <div class="nav-item-next">
      <a 
        href="/63228" 
        class="nav-link">
        <div>
          <div class="nav-label">下一篇</div>
          
            <div class="nav-title">树莓派入门 </div>
          
        </div>
        <i class="iconfont icon-right nav-next-icon"></i>
      </a>
    </div>
  
</div>

  <div 
    class="card card-content comment-card" 
    style="margin-top: 16px;">
    <div class="comment-card-title">评论</div>
    
  <div id="vcomments"></div>
  
  <script>
    loadScript("//unpkg.com/valine/dist/Valine.min.js");
    var oldLoadVa = window.onload;
    window.onload = function () {
      oldLoadVa && oldLoadVa();
      new Valine({
        el: '#vcomments',
        appId: 'FE3KQNXvpvsHJmJl9idhXhp1-9Nh9j0Va',
        appKey: 'CLLAhwQhbW5KCgp3CCPkAItO',
        placeholder: 'Just go go',
        path: window.location.pathname,
        avatar: 'mp',
        meta: ["nick","mail","link"],
        pageSize: '10',
        lang: '',
        visitor: 'false',
        highlight: true,
        recordIP: false,
        
        
        
        enableQQ: 'true',
        requiredFields: [],
      });
    };
  </script>

  </div>

<div 
  class="card card-content toc-card" 
  id="mobiletoc">
  <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E5%AE%89%E8%A3%85"><span class="toc-text">docker安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-compose%E5%AE%89%E8%A3%85"><span class="toc-text">docker-compose安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#go%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="toc-text">go安装与配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jdk%E5%AE%89%E8%A3%85"><span class="toc-text">jdk安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric%E7%9A%84docker%E9%95%9C%E5%83%8F"><span class="toc-text">下载fabric的docker镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric%E6%BA%90%E7%A0%81%E5%BA%93"><span class="toc-text">下载fabric源码库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91%E3%80%82"><span class="toc-text">对工具进行编译。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91%E3%80%82"><span class="toc-text">对另一个工具进行编译。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%A5%BD%E7%9A%84%E5%B7%A5%E5%85%B7%E5%A6%82%E4%B8%8B"><span class="toc-text">编译好的工具如下:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric-samples"><span class="toc-text">下载fabric-samples</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-World"><span class="toc-text">Hello World</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95"><span class="toc-text">1.查看目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%94%9F%E6%88%90%E9%85%8D%E7%BD%AE"><span class="toc-text">2.生成配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%8C%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC"><span class="toc-text">3.启动网络，自动运行测试脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%85%B3%E9%97%AD%E7%BD%91%E7%BB%9C%EF%BC%8C%E8%87%AA%E5%8A%A8%E6%B8%85%E6%A5%9A%E9%85%8D%E7%BD%AE%E5%92%8Cdocker%E8%BF%9B%E7%A8%8B"><span class="toc-text">4.关闭网络，自动清楚配置和docker进程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-World-%E5%88%86%E6%9E%90"><span class="toc-text">Hello World 分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%EF%BC%8Corder%E5%92%8Cpeer%E5%88%86%E7%A6%BB"><span class="toc-text">1.查看日志，order和peer分离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%A6%82%E4%B8%8B%E9%85%8D%E7%BD%AE"><span class="toc-text">2.查看如下配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%8C%E6%8E%A5%E7%9D%80%E5%88%86%E6%9E%90%E6%97%A5%E5%BF%97"><span class="toc-text">3.启动网络，接着分析日志</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-text">fabric系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-text">架构图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%E5%9B%BE"><span class="toc-text">网络拓扑图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E6%B5%81%E7%A8%8B"><span class="toc-text">交易流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E5%85%B1%E8%AF%86%E6%8E%92%E5%BA%8F"><span class="toc-text">fabric共识排序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6"><span class="toc-text">共识机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Orderer%E8%8A%82%E7%82%B9%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">Orderer节点的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E7%9B%AE%E5%BD%95"><span class="toc-text">源码目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81"><span class="toc-text">共识机制源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81"><span class="toc-text">回顾共识机制源码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8"><span class="toc-text">fabric账本存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E6%A6%82%E5%BF%B5"><span class="toc-text">账本存储概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E8%AF%BB%E5%86%99%E9%9B%86"><span class="toc-text">交易读写集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-text">账本存储相关概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%BA%90%E7%A0%81"><span class="toc-text">账本存储相关源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%BA%90%E7%A0%81%E6%80%BB%E7%BB%93"><span class="toc-text">账本存储相关源码总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">fabric智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">智能合约</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA%E9%85%8D%E7%BD%AE%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">网络搭建配置的实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C"><span class="toc-text">启动网络</span></a></li></ol></li></ol>
</div></main>
            <aside class="left-column">
              
              <div class="card card-author">
                
  <img 
    src="/img/touxiang.jpg" 
    class="author-img"
    width="88"
    height="88"
    alt="author avatar">

<p class="author-name">Dicemy</p>
<p class="author-description">软件工程在读大学生</p>
<div class="author-message">
  <a 
    class="author-posts-count" 
    href="/archives">
    <span>38</span>
    <span>文章</span>
  </a>
  <a 
    class="author-categories-count" 
    href="/categories">
    <span>4</span>
    <span>分类</span>
  </a>
  <a 
    class="author-tags-count" 
    href="/tags">
    <span>18</span>
    <span>标签</span>
  </a>
</div>

  <div class="author-card-society">
    
      <div class="author-card-society-icon">
        <a target="_blank" rel="noopener" href="https://space.bilibili.com/16023197">
          <i class="iconfont icon-bilibili society-icon"></i>
        </a>
      </div>
    
      <div class="author-card-society-icon">
        <a href="tencent://message/?uin=1583925267">
          <i class="iconfont icon-wechat society-icon"></i>
        </a>
      </div>
    
      <div class="author-card-society-icon">
        <a target="_blank" rel="noopener" href="https://github.com/Dicemy">
          <i class="iconfont icon-github society-icon"></i>
        </a>
      </div>
    
  </div>

              </div>
               <div class="sticky-tablet">
  
  
    <article class="display-when-two-columns spacer">
      <div class="card card-content toc-card">
        <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E5%AE%89%E8%A3%85"><span class="toc-text">docker安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-compose%E5%AE%89%E8%A3%85"><span class="toc-text">docker-compose安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#go%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="toc-text">go安装与配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jdk%E5%AE%89%E8%A3%85"><span class="toc-text">jdk安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric%E7%9A%84docker%E9%95%9C%E5%83%8F"><span class="toc-text">下载fabric的docker镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric%E6%BA%90%E7%A0%81%E5%BA%93"><span class="toc-text">下载fabric源码库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91%E3%80%82"><span class="toc-text">对工具进行编译。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91%E3%80%82"><span class="toc-text">对另一个工具进行编译。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%A5%BD%E7%9A%84%E5%B7%A5%E5%85%B7%E5%A6%82%E4%B8%8B"><span class="toc-text">编译好的工具如下:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric-samples"><span class="toc-text">下载fabric-samples</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-World"><span class="toc-text">Hello World</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95"><span class="toc-text">1.查看目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%94%9F%E6%88%90%E9%85%8D%E7%BD%AE"><span class="toc-text">2.生成配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%8C%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC"><span class="toc-text">3.启动网络，自动运行测试脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%85%B3%E9%97%AD%E7%BD%91%E7%BB%9C%EF%BC%8C%E8%87%AA%E5%8A%A8%E6%B8%85%E6%A5%9A%E9%85%8D%E7%BD%AE%E5%92%8Cdocker%E8%BF%9B%E7%A8%8B"><span class="toc-text">4.关闭网络，自动清楚配置和docker进程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-World-%E5%88%86%E6%9E%90"><span class="toc-text">Hello World 分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%EF%BC%8Corder%E5%92%8Cpeer%E5%88%86%E7%A6%BB"><span class="toc-text">1.查看日志，order和peer分离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%A6%82%E4%B8%8B%E9%85%8D%E7%BD%AE"><span class="toc-text">2.查看如下配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%8C%E6%8E%A5%E7%9D%80%E5%88%86%E6%9E%90%E6%97%A5%E5%BF%97"><span class="toc-text">3.启动网络，接着分析日志</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-text">fabric系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-text">架构图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%E5%9B%BE"><span class="toc-text">网络拓扑图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E6%B5%81%E7%A8%8B"><span class="toc-text">交易流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E5%85%B1%E8%AF%86%E6%8E%92%E5%BA%8F"><span class="toc-text">fabric共识排序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6"><span class="toc-text">共识机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Orderer%E8%8A%82%E7%82%B9%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">Orderer节点的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E7%9B%AE%E5%BD%95"><span class="toc-text">源码目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81"><span class="toc-text">共识机制源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81"><span class="toc-text">回顾共识机制源码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8"><span class="toc-text">fabric账本存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E6%A6%82%E5%BF%B5"><span class="toc-text">账本存储概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E8%AF%BB%E5%86%99%E9%9B%86"><span class="toc-text">交易读写集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-text">账本存储相关概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%BA%90%E7%A0%81"><span class="toc-text">账本存储相关源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%BA%90%E7%A0%81%E6%80%BB%E7%BB%93"><span class="toc-text">账本存储相关源码总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">fabric智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">智能合约</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA%E9%85%8D%E7%BD%AE%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">网络搭建配置的实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C"><span class="toc-text">启动网络</span></a></li></ol></li></ol>
      </div>
    </article>
  
  
  <article class="card card-content categories-widget">
    <div class="categories-card">
  <div class="categories-header">
    <i 
      class="iconfont icon-fenlei" 
      style="padding-right: 2px;">
    </i>分类
  </div>
  <div class="categories-list">
    
      <a href="/categories/%E7%AB%9E%E8%B5%9B/">
        <div class="categories-list-item">
          竞赛
          <span class="categories-list-item-badge">17</span>
        </div>
      </a>
    
      <a href="/categories/%E6%8A%80%E6%9C%AF/">
        <div class="categories-list-item">
          技术
          <span class="categories-list-item-badge">12</span>
        </div>
      </a>
    
      <a href="/categories/%E6%96%87%E5%8C%96%E8%AF%BE/">
        <div class="categories-list-item">
          文化课
          <span class="categories-list-item-badge">5</span>
        </div>
      </a>
    
      <a href="/categories/%E7%94%9F%E6%B4%BB/">
        <div class="categories-list-item">
          生活
          <span class="categories-list-item-badge">1</span>
        </div>
      </a>
    
  </div>
</div>
  </article>
  
  <article class="card card-content tags-widget">
    <div class="tags-card">
  <div class="tags-header">
    <i 
      class="iconfont icon-biaoqian" 
      style="padding-right: 2px;">
    </i>热门标签
  </div>
  <div class="tags-list">
    
      <a 
        href="/tags/%E8%B5%9B%E5%90%8E%E6%80%BB%E7%BB%93/" 
        title="赛后总结">
        <div class="tags-list-item">赛后总结</div>
      </a>
    
      <a 
        href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" 
        title="学习笔记">
        <div class="tags-list-item">学习笔记</div>
      </a>
    
      <a 
        href="/tags/%E6%90%9C%E7%B4%A2/" 
        title="搜索">
        <div class="tags-list-item">搜索</div>
      </a>
    
      <a 
        href="/tags/fabric/" 
        title="fabric">
        <div class="tags-list-item">fabric</div>
      </a>
    
      <a 
        href="/tags/Hyperledger/" 
        title="Hyperledger">
        <div class="tags-list-item">Hyperledger</div>
      </a>
    
      <a 
        href="/tags/%E7%BB%84%E5%90%88%E6%95%B0%E5%AD%A6/" 
        title="组合数学">
        <div class="tags-list-item">组合数学</div>
      </a>
    
      <a 
        href="/tags/DP/" 
        title="DP">
        <div class="tags-list-item">DP</div>
      </a>
    
      <a 
        href="/tags/%E6%95%B0%E6%8D%AE%E5%BA%93/" 
        title="数据库">
        <div class="tags-list-item">数据库</div>
      </a>
    
      <a 
        href="/tags/Linux/" 
        title="Linux">
        <div class="tags-list-item">Linux</div>
      </a>
    
      <a 
        href="/tags/%E6%96%B9%E6%B3%95%E6%80%BB%E7%BB%93/" 
        title="方法总结">
        <div class="tags-list-item">方法总结</div>
      </a>
    
      <a 
        href="/tags/%E5%8D%9A%E5%BC%88%E8%AE%BA/" 
        title="博弈论">
        <div class="tags-list-item">博弈论</div>
      </a>
    
      <a 
        href="/tags/%E6%96%87%E6%A1%A3%E9%98%85%E8%AF%BB/" 
        title="文档阅读">
        <div class="tags-list-item">文档阅读</div>
      </a>
    
      <a 
        href="/tags/JAVA/" 
        title="JAVA">
        <div class="tags-list-item">JAVA</div>
      </a>
    
      <a 
        href="/tags/%E6%9C%80%E5%B0%8F%E7%94%9F%E6%88%90%E6%A0%91/" 
        title="最小生成树">
        <div class="tags-list-item">最小生成树</div>
      </a>
    
      <a 
        href="/tags/%E6%80%9D%E8%80%83%E9%A2%98/" 
        title="思考题">
        <div class="tags-list-item">思考题</div>
      </a>
    
      <a 
        href="/tags/%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83/" 
        title="乘法逆元">
        <div class="tags-list-item">乘法逆元</div>
      </a>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
            <aside class="right-column">
              <div class="sticky-widescreen">
  
  
    <article class="card card-content toc-card">
      <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-text">环境配置</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">目录结构</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker%E5%AE%89%E8%A3%85"><span class="toc-text">docker安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#docker-compose%E5%AE%89%E8%A3%85"><span class="toc-text">docker-compose安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#go%E5%AE%89%E8%A3%85%E4%B8%8E%E9%85%8D%E7%BD%AE"><span class="toc-text">go安装与配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jdk%E5%AE%89%E8%A3%85"><span class="toc-text">jdk安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric%E7%9A%84docker%E9%95%9C%E5%83%8F"><span class="toc-text">下载fabric的docker镜像</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric%E6%BA%90%E7%A0%81%E5%BA%93"><span class="toc-text">下载fabric源码库</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91%E3%80%82"><span class="toc-text">对工具进行编译。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%B7%A5%E5%85%B7%E8%BF%9B%E8%A1%8C%E7%BC%96%E8%AF%91%E3%80%82"><span class="toc-text">对另一个工具进行编译。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BC%96%E8%AF%91%E5%A5%BD%E7%9A%84%E5%B7%A5%E5%85%B7%E5%A6%82%E4%B8%8B"><span class="toc-text">编译好的工具如下:</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BDfabric-samples"><span class="toc-text">下载fabric-samples</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-World"><span class="toc-text">Hello World</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E7%9B%AE%E5%BD%95"><span class="toc-text">1.查看目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E7%94%9F%E6%88%90%E9%85%8D%E7%BD%AE"><span class="toc-text">2.生成配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%8C%E8%87%AA%E5%8A%A8%E8%BF%90%E8%A1%8C%E6%B5%8B%E8%AF%95%E8%84%9A%E6%9C%AC"><span class="toc-text">3.启动网络，自动运行测试脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%85%B3%E9%97%AD%E7%BD%91%E7%BB%9C%EF%BC%8C%E8%87%AA%E5%8A%A8%E6%B8%85%E6%A5%9A%E9%85%8D%E7%BD%AE%E5%92%8Cdocker%E8%BF%9B%E7%A8%8B"><span class="toc-text">4.关闭网络，自动清楚配置和docker进程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Hello-World-%E5%88%86%E6%9E%90"><span class="toc-text">Hello World 分析</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E6%9F%A5%E7%9C%8B%E6%97%A5%E5%BF%97%EF%BC%8Corder%E5%92%8Cpeer%E5%88%86%E7%A6%BB"><span class="toc-text">1.查看日志，order和peer分离</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%A6%82%E4%B8%8B%E9%85%8D%E7%BD%AE"><span class="toc-text">2.查看如下配置</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C%EF%BC%8C%E6%8E%A5%E7%9D%80%E5%88%86%E6%9E%90%E6%97%A5%E5%BF%97"><span class="toc-text">3.启动网络，接着分析日志</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84"><span class="toc-text">fabric系统架构</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%9E%B6%E6%9E%84%E5%9B%BE"><span class="toc-text">架构图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%8B%93%E6%89%91%E5%9B%BE"><span class="toc-text">网络拓扑图</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E6%B5%81%E7%A8%8B"><span class="toc-text">交易流程</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E5%85%B1%E8%AF%86%E6%8E%92%E5%BA%8F"><span class="toc-text">fabric共识排序</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6"><span class="toc-text">共识机制</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Orderer%E8%8A%82%E7%82%B9%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-text">Orderer节点的作用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%BA%90%E7%A0%81%E7%9B%AE%E5%BD%95"><span class="toc-text">源码目录</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81"><span class="toc-text">共识机制源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9E%E9%A1%BE%E5%85%B1%E8%AF%86%E6%9C%BA%E5%88%B6%E6%BA%90%E7%A0%81"><span class="toc-text">回顾共识机制源码</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8"><span class="toc-text">fabric账本存储</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E6%A6%82%E5%BF%B5"><span class="toc-text">账本存储概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%A4%E6%98%93%E8%AF%BB%E5%86%99%E9%9B%86"><span class="toc-text">交易读写集</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="toc-text">账本存储相关概念</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%BA%90%E7%A0%81"><span class="toc-text">账本存储相关源码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A6%E6%9C%AC%E5%AD%98%E5%82%A8%E7%9B%B8%E5%85%B3%E6%BA%90%E7%A0%81%E6%80%BB%E7%BB%93"><span class="toc-text">账本存储相关源码总结</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#fabric%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">fabric智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%99%BA%E8%83%BD%E5%90%88%E7%BA%A6"><span class="toc-text">智能合约</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E7%BB%9C%E6%90%AD%E5%BB%BA%E9%85%8D%E7%BD%AE%E7%9A%84%E5%AE%9E%E7%8E%B0"><span class="toc-text">网络搭建配置的实现</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%AF%E5%8A%A8%E7%BD%91%E7%BB%9C"><span class="toc-text">启动网络</span></a></li></ol></li></ol>
    </article>
  
  
  <article class="card card-content">
    <div class="recent-posts-card">
  <div class="recent-posts-header">
    <i 
      class="iconfont icon-wenzhang_huaban" 
      style="padding-right: 2px;">
    </i>最近文章
  </div>
  <div class="recent-posts-list">
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-01-08</div>
        <a href="/23955"><div class="recent-posts-item-content">fabric开发入门</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-01-07</div>
        <a href="/63228"><div class="recent-posts-item-content">树莓派入门</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-01-07</div>
        <a href="/21062"><div class="recent-posts-item-content">Python入门</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-01-07</div>
        <a href="/10811"><div class="recent-posts-item-content">git入门</div></a>
      </div>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
          </div>
        </div>
      </div>
    </div>
     
    <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright ©
          
            2020 -
          
          2022
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          Dicemy 的博客
        </a>
      </div>
    </div>

    
    
    
    
      <div class="footer-dsc">
        
          本站总访问量<span id="busuanzi_value_site_pv"></span>次
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          本站总访客数<span id="busuanzi_value_site_uv"></span>次
        
      </div>
      
    
</footer> 
    
  <a 
    role="button" 
    id="scrollbutton" 
    class="basebutton" 
    aria-label="回到顶部">
    <i class="iconfont icon-arrowleft button-icon"></i>
  </a>

<a 
  role="button" 
  id="menubutton"
  aria-label="menu button"
  class="basebutton">
  <i class="iconfont icon-menu button-icon"></i>
</a>
<a 
  role="button" 
  id="popbutton" 
  class="basebutton" 
  aria-label="控制中心">
  <i class="iconfont icon-expand button-icon"></i>
</a>
<a 
  role="button" 
  id="darkbutton" 
  class="basebutton darkwidget" 
  aria-label="夜色模式">
  <i class="iconfont icon-weather button-icon"></i>
</a>
<a 
  role="button" 
  id="searchbutton" 
  class="basebutton searchwidget" 
  aria-label="搜索">
  <i class="iconfont icon-search button-icon"></i>
</a> 
     
     
      
 
     
     
      <script>
  var addImgLayout = function () {
    var img = document.querySelectorAll('.post-content img')
    var i
    for (i = 0; i < img.length; i++) {
      var wrapper = document.createElement('a')
      wrapper.setAttribute('href', img[i].getAttribute('data-src'))
      wrapper.setAttribute('aria-label', 'illustration')
      wrapper.style.cssText =
        'width: 100%; display: flex; justify-content: center;'
      if (img[i].alt) wrapper.dataset.caption = img[i].alt
      wrapper.dataset.nolink = true
      img[i].before(wrapper)
      wrapper.append(img[i])
      var divWrap = document.createElement('div')
      divWrap.classList.add('gallery')
      wrapper.before(divWrap)
      divWrap.append(wrapper)
    }
    baguetteBox.run('.gallery')
  }
</script>
<script>
  loadScript(
    "/js/lib/lightbox/baguetteBox.min.js",
    addImgLayout
  )
</script>
 
     
     
    <script src="/js/main.js"></script> 
    
      <script> 
        loadScript('/js/lib/busuanzi.min.js') 
      </script>
     
    
      <script>
        var addLazyload = function () {
          var observer = lozad('.lozad', {
            load: function (el) {
              el.srcset = el.getAttribute('data-src')
            },
            loaded: function (el) {
              el.classList.add('loaded')
            },
          })
          observer.observe()
        }
      </script>
      <script>
        loadScript('/js/lib/lozad.min.js', addLazyload)
      </script>
     
    
      <script>
        var googleAnalytics = function () {
          window.dataLayer = window.dataLayer || []
          function gtag() {
            dataLayer.push(arguments)
          }
          gtag('js', new Date())
          gtag('config', 'G-3BC8TV17YR')
        }
    </script>
      <script>
        loadScript(
          'https://www.googletagmanager.com/gtag/js?id=' +
            'G-3BC8TV17YR',
          googleAnalytics
        )
      </script>
    
    
      <script>
        setTimeout(() => {localSearch("search.json")}, 0)
      </script>
    
  </body>
</html>
